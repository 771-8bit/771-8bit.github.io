<!doctype html><html lang=ja dir=ltr><head prefix="og: http://ogp.me/ns#"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Kibo-RPC参加記 – @771-8bit</title><script defer src=/js/fuse.min.32195737929df2c8096e855a5789cbb3f1331224d9169e8705493e7008f47df8.js></script><script src=/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js></script><script defer src=/js/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js></script><script defer src=/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js></script><script defer src=/js/helper/fadeinout.min.efa35f4c090622130b3f4cfae6971448b5ffb61c5f0a8f21cdfd157fa712abc4.js></script><script defer src=/js/helper/closest.min.js></script><script>"use strict";if(window.NodeList&&!NodeList.prototype.forEach){NodeList.prototype.forEach=Array.prototype.forEach;}
if(!String.prototype.includes){String.prototype.includes=function(search,start){'use strict';if(search instanceof RegExp){throw TypeError('first argument must not be a RegExp');}
if(start===undefined){start=0;}
return this.indexOf(search,start)!==-1;};}
Document.prototype.append=Element.prototype.append=function append(){this.appendChild(_mutation(arguments));};function _mutation(nodes){if(!nodes.length){throw new Error('DOM Exception 8');}else if(nodes.length===1){return typeof nodes[0]==='string'?document.createTextNode(nodes[0]):nodes[0];}else{var
fragment=document.createDocumentFragment(),length=nodes.length,index=-1,node;while(++index<length){node=nodes[index];fragment.appendChild(typeof node==='string'?document.createTextNode(node):node);}
return fragment;}}
if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return this.indexOf(searchString,position)===position;};}
document.addEventListener('DOMContentLoaded',function(){var navCollapseBtn=document.querySelector('.navbar__burger');navCollapseBtn?navCollapseBtn.addEventListener('click',function(e){var navCollapse=document.querySelector('.navbarm__collapse');if(navCollapse){var dataOpen=navCollapse.getAttribute('data-open');if(dataOpen==='true'){navCollapse.setAttribute('data-open','false');navCollapse.style.maxHeight=0;navCollapseBtn.classList.remove('is-active');}else{navCollapse.setAttribute('data-open','true');navCollapse.style.maxHeight=navCollapse.scrollHeight+"px";navCollapseBtn.classList.add('is-active');}}}):null;var tables=document.querySelectorAll('.single__contents > table');for(let i=0;i<tables.length;i++){var table=tables[i];var wrapper=document.createElement('div');wrapper.className='table-wrapper';table.parentElement.replaceChild(wrapper,table);wrapper.appendChild(table);}
var footNoteRefs=document.querySelectorAll('.footnote-ref');var footNoteBackRefs=document.querySelectorAll('.footnote-backref');footNoteRefs?footNoteRefs.forEach(function(elem,idx){elem.onmouseenter=function(){if(navbar.classList.contains('scrolling')){navbar.classList.remove('scrolling');}}
elem.onmouseleave=function(){if(!navbar.classList.contains('scrolling')){setTimeout(function(){navbar.classList.add('scrolling');},100);}}
elem.onclick=function(){if(!navbar.classList.contains('scrolling')){navbar.classList.remove('navbar--show');navbar.classList.remove('navbar--hide');navbar.classList.add('navbar--hide');}}}):null;footNoteBackRefs?footNoteBackRefs.forEach(function(elem,idx){elem.onmouseenter=function(){if(navbar.classList.contains('scrolling')){navbar.classList.remove('scrolling');}}
elem.onmouseleave=function(){if(!navbar.classList.contains('scrolling')){setTimeout(function(){navbar.classList.add('scrolling');},100);}}
elem.onclick=function(){if(!navbar.classList.contains('scrolling')){navbar.classList.remove('navbar--show');navbar.classList.remove('navbar--hide');navbar.classList.add('navbar--hide');}}}):null;var summaryContainer=document.querySelector('.summary__container');var searchResult=document.querySelector('.search-result');var searchResultCloseBtn=document.querySelector('.search-result__close');searchResultCloseBtn?searchResultCloseBtn.addEventListener('click',function(e){searchResult.setAttribute('data-display','none');summaryContainer.setAttribute('data-display','block');}):null;document.querySelectorAll('.tab')?document.querySelectorAll('.tab').forEach(function(elem,idx){var containerId=elem.getAttribute('id');var containerElem=elem;var tabLinks=elem.querySelectorAll('.tab__link');var tabContents=elem.querySelectorAll('.tab__content');var ids=[];tabLinks&&tabLinks.length>0?tabLinks.forEach(function(link,index,self){link.onclick=function(e){for(var i=0;i<self.length;i++){if(index===parseInt(i,10)){if(!self[i].classList.contains('active')){self[i].classList.add('active');tabContents[i].style.display='block';}}else{self[i].classList.remove('active');tabContents[i].style.display='none';}}}}):null;}):null;document.querySelectorAll('.codetab')?document.querySelectorAll('.codetab').forEach(function(elem,idx){var containerId=elem.getAttribute('id');var containerElem=elem;var codetabLinks=elem.querySelectorAll('.codetab__link');var codetabContents=elem.querySelectorAll('.codetab__content');var ids=[];codetabLinks&&codetabLinks.length>0?codetabLinks.forEach(function(link,index,self){link.onclick=function(e){for(var i=0;i<self.length;i++){if(index===parseInt(i,10)){if(!self[i].classList.contains('active')){self[i].classList.add('active');codetabContents[i].style.display='block';}}else{self[i].classList.remove('active');codetabContents[i].style.display='none';}}}}):null;}):null;var gttBtn=document.getElementById("gtt");gttBtn.style.display="none";gttBtn.addEventListener('click',function(){if(window.document.documentMode){document.documentElement.scrollTop=0;}else{scrollToTop(250);}});function scrollToTop(scrollDuration){var scrollStep=-window.scrollY/(scrollDuration/15);var scrollInterval=setInterval(function(){if(window.scrollY!=0){window.scrollBy(0,scrollStep);}
else clearInterval(scrollInterval);},15);}
var scrollFunction=function(){if(document.body.scrollTop>250||document.documentElement.scrollTop>250){gttBtn.style.display="block";}else{gttBtn.style.display="none";}}
var expandBtn=document.querySelectorAll('.expand__button');for(let i=0;i<expandBtn.length;i++){expandBtn[i].addEventListener("click",function(){var content=this.nextElementSibling;if(content.style.maxHeight){content.style.maxHeight=null;this.querySelector('svg').classList.add('expand-icon__right');this.querySelector('svg').classList.remove('expand-icon__down');}else{content.style.maxHeight=content.scrollHeight+"px";this.querySelector('svg').classList.remove('expand-icon__right');this.querySelector('svg').classList.add('expand-icon__down');}});}
var lastScrollTop=window.pageYOffset||document.documentElement.scrollTop;var tocElem=document.querySelector('.toc');var tableOfContentsElem=tocElem?tocElem.querySelector('#TableOfContents'):null;var toggleTocElem=document.getElementById('toggle-toc');var singleContentsElem=document.querySelector('.single__contents');var navbar=document.querySelector('.navbar');var tocFlexbox=document.querySelector('.toc__flexbox');var tocFlexboxOuter=document.querySelector('.toc__flexbox--outer');var expandContents=document.querySelectorAll('.expand__content');var boxContents=document.querySelectorAll('.box');var notAllowedTitleIds=null;var tocFolding=JSON.parse("false");var tocLevels=JSON.parse("[\"h2\",\"h3\",\"h4\"]");if(tocLevels){tocLevels=tocLevels.toString();}else{tocLevels="h1, h2, h3, h4, h5, h6";}
singleContentsElem&&singleContentsElem.querySelectorAll(".tab")?singleContentsElem.querySelectorAll(".tab").forEach(function(elem){elem.querySelectorAll(tocLevels).forEach(function(element){notAllowedTitleIds=Array.isArray(notAllowedTitleIds)?notAllowedTitleIds.concat(element.getAttribute('id')):[element.getAttribute('id')];});}):null;expandContents?expandContents.forEach(function(elem){elem.querySelectorAll(tocLevels).forEach(function(element){notAllowedTitleIds=Array.isArray(notAllowedTitleIds)?notAllowedTitleIds.concat(element.getAttribute('id')):[element.getAttribute('id')];});}):null;boxContents?boxContents.forEach(function(elem){elem.querySelectorAll(tocLevels).forEach(function(element){notAllowedTitleIds=Array.isArray(notAllowedTitleIds)?notAllowedTitleIds.concat(element.getAttribute('id')):[element.getAttribute('id')];});}):null;window.onscroll=function(){scrollFunction();var st=window.pageYOffset||document.documentElement.scrollTop;if(st>lastScrollTop){if(st<250){gttBtn.style.display="none";}else{gttBtn.style.display="block";}
if(st<45){return null;}
if(navbar.classList.contains('scrolling')){if(!navbar.classList.contains('navbar--hide')){navbar.classList.add('navbar--hide');}else if(navbar.classList.contains('navbar--show')){navbar.classList.remove('navbar--show');}}
if(singleContentsElem){if(singleContentsElem.querySelectorAll(tocLevels).length>0){singleContentsElem.querySelectorAll(tocLevels).forEach(function(elem){if(toggleTocElem&&!toggleTocElem.checked){return null;}
if(notAllowedTitleIds&&notAllowedTitleIds.includes(elem.getAttribute('id'))){return null;}
if(document.documentElement.scrollTop>=elem.offsetTop){if(tableOfContentsElem){var id=elem.getAttribute('id');tocElem.querySelectorAll('a').forEach(function(elem){elem.classList.remove('active');});tocElem.querySelector('a[href="#'+id+'"]')?tocElem.querySelector('a[href="#'+id+'"]').classList.add('active'):null;if(false===tocFolding){}else{tableOfContentsElem.querySelectorAll('ul')?tableOfContentsElem.querySelectorAll('ul').forEach(function(rootUl){rootUl.querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});});}):null;}
var curElem=tableOfContentsElem.querySelector("[href='#"+id+"']");if(curElem&&curElem.nextElementSibling){curElem.nextElementSibling.style.display='block';}
getParents(curElem,'ul')?getParents(curElem,'ul').forEach(function(elem){elem.style.display='block';}):null;}}});}else{if(tocFlexbox){tocFlexbox.setAttribute('data-position','');if(!tocFlexbox.classList.contains('hide')){tocFlexbox.classList.add('hide');}}
if(tocFlexboxOuter){tocFlexboxOuter.setAttribute('data-position','');if(!tocFlexboxOuter.classList.contains('hide')){tocFlexboxOuter.classList.add('hide');}}}}}else{if(st<250){gttBtn.style.display="none";}
if(navbar.classList.contains('scrolling')){if(navbar.classList.contains('navbar--hide')){navbar.classList.remove('navbar--hide');}else if(!navbar.classList.contains('navbar--show')){navbar.classList.add('navbar--show');}}
if(singleContentsElem){if(singleContentsElem.querySelectorAll(tocLevels).length>0){singleContentsElem.querySelectorAll(tocLevels).forEach(function(elem){if(toggleTocElem&&!toggleTocElem.checked){return null;}
if(notAllowedTitleIds&&notAllowedTitleIds.includes(elem.getAttribute('id'))){return null;}
if(document.documentElement.scrollTop>=elem.offsetTop){if(tableOfContentsElem){var id=elem.getAttribute('id');tocElem.querySelectorAll('a').forEach(function(elem){elem.classList.remove('active');});tocElem.querySelector('a[href="#'+id+'"]')?tocElem.querySelector('a[href="#'+id+'"]').classList.add('active'):null;if(false===tocFolding){}else{tableOfContentsElem.querySelectorAll('ul')?tableOfContentsElem.querySelectorAll('ul').forEach(function(rootUl){rootUl.querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});});}):null;}
var curElem=tableOfContentsElem.querySelector("[href='#"+id+"']");if(curElem&&curElem.nextElementSibling){curElem.nextElementSibling.style.display='block';}
getParents(curElem,'ul')?getParents(curElem,'ul').forEach(function(elem){elem.style.display='block';}):null;}}});}else{if(tocFlexbox&&!tocFlexbox.classList.contains('hide')){tocFlexbox.classList.add('hide');}
if(tocFlexboxOuter&&!tocFlexboxOuter.classList.contains('hide')){tocFlexboxOuter.classList.add('hide');}}}
if(tableOfContentsElem&&document.documentElement.scrollTop<250){if(false===tocFolding){}else{tableOfContentsElem.querySelector('ul')?tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});}):null;}}}
lastScrollTop=st<=0?0:st;};var localTheme=localStorage.getItem('theme');var rootEleme=document.getElementById('root');var selectThemeElem=document.querySelectorAll('.select-theme');var selectThemeItemElem=document.querySelectorAll('.select-theme__item');var skinDarkCode=JSON.parse("\"dark\"");var skinLightCode=JSON.parse("\"light\"");var skinHackerCode=JSON.parse("\"hacker\"");var skinSolarizedCode=JSON.parse("\"solarized\"");var skinKimbieCode=JSON.parse("\"kimbie\"");var setMetaColor=function(themeColor){var metaMsapplicationTileColor=document.getElementsByName('msapplication-TileColor')[0];var metaThemeColor=document.getElementsByName('theme-color')[0];var metaMsapplicationNavbuttonColor=document.getElementsByName('msapplication-navbutton-color')[0];var metaAppleMobileWebAappStatusBarStyle=document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];if(themeColor.includes('dark')){metaMsapplicationTileColor.setAttribute('content','#fcfcfa');metaThemeColor.setAttribute('content','#403E41');metaMsapplicationNavbuttonColor.setAttribute('content','#403E41');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#403E41');}else if(themeColor.includes('light')){metaMsapplicationTileColor.setAttribute('content','#555');metaThemeColor.setAttribute('content','#eee');metaMsapplicationNavbuttonColor.setAttribute('content','#eee');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#eee');}else if(themeColor.includes('hacker')){metaMsapplicationTileColor.setAttribute('content','#e3cd26');metaThemeColor.setAttribute('content','#252526');metaMsapplicationNavbuttonColor.setAttribute('content','#252526');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#252526');}else if(themeColor.includes('solarized')){metaMsapplicationTileColor.setAttribute('content','#d3af86');metaThemeColor.setAttribute('content','#51412c');metaMsapplicationNavbuttonColor.setAttribute('content','#51412c');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#51412c');}else if(themeColor.includes('kimbie')){metaMsapplicationTileColor.setAttribute('content','#586e75');metaThemeColor.setAttribute('content','#eee8d5');metaMsapplicationNavbuttonColor.setAttribute('content','#eee8d5');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#eee8d5');}}
var parseSkinCode=function(themeText){if(themeText===skinDarkCode){return 'dark';}else if(themeText===skinLightCode){return 'light';}else if(themeText===skinHackerCode){return 'hacker';}else if(themeText===skinSolarizedCode){return 'solarized';}else if(themeText===skinKimbieCode){return 'kimbie';}}
if(localTheme){selectThemeItemElem?selectThemeItemElem.forEach(function(elem){if(elem.text.trim()===localTheme){elem.classList.add('is-active');}else{elem.classList.remove('is-active');}}):null;setMetaColor(localTheme);}else{setMetaColor(rootEleme.className);}
selectThemeItemElem?selectThemeItemElem.forEach(function(v,i){v.addEventListener('click',function(e){var selectedThemeVariant=parseSkinCode(e.target.text.trim());localStorage.setItem('theme',selectedThemeVariant);setMetaColor(selectedThemeVariant);rootEleme.removeAttribute('class');rootEleme.classList.add('theme__'+selectedThemeVariant);selectThemeElem.forEach(function(rootElem){rootElem.querySelectorAll('a').forEach(function(elem){if(elem.classList){if(elem.text.trim()===selectedThemeVariant){if(!elem.classList.contains('is-active')){elem.classList.add('is-active');}}else{if(elem.classList.contains('is-active')){elem.classList.remove('is-active');}}}});});if(window.mermaid){if(selectedThemeVariant==="dark"||selectedThemeVariant==="hacker"){mermaid.initialize({theme:'dark'});location.reload();}else{mermaid.initialize({theme:'default'});location.reload();}}
var utterances=document.getElementById('utterances');if(utterances){utterances.querySelector('iframe').contentWindow.postMessage({type:'set-theme',theme:selectedThemeVariant==="dark"||selectedThemeVariant==="hacker"?'photon-dark':selectedThemeVariant==='kimbie'?'github-dark-orange':'github-light',},'https://utteranc.es');}
var twitterCards=document.querySelectorAll('.twitter-timeline');if(twitterCards){window.postMessage({type:'set-twitter-theme',theme:selectedThemeVariant==='light'||selectedThemeVariant==='solarized'?'light':'dark',});}});}):null;var baseurl=JSON.parse("\"https://771-8bit.com\"");var permalink=JSON.parse("\"https://771-8bit.com/secret/kibo-rpc/\"");var langprefix=JSON.parse("\"\"");var searchResults=null;var searchMenu=null;var searchText=null;var enableSearch=JSON.parse("true");var searchDistance=JSON.parse("100");var searchThreshold=JSON.parse("0.4");var searchContent=JSON.parse("true");var enableSearchHighlight=JSON.parse("true");var searchResultPosition=JSON.parse("\"main\"");var sectionType=JSON.parse("\"secret\"");var kind=JSON.parse("\"page\"");var fuse=null;if(enableSearch){(function initFuse(){var xhr=new XMLHttpRequest();if(sectionType==="publication"&&kind!=="page"){xhr.open('GET',permalink+"index.json");}else{xhr.open('GET',baseurl+langprefix+"/index.json");}
xhr.setRequestHeader('Content-Type','application/json; charset=utf-8');xhr.onload=function(){if(xhr.status===200){fuse=new Fuse(JSON.parse(xhr.response.toString('utf-8')),{keys:sectionType.includes('publication')?['title','abstract']:searchContent?['title','description','content']:['title','description'],includeMatches:enableSearchHighlight,shouldSort:true,threshold:searchThreshold?searchThreshold:0.4,location:0,distance:searchDistance?searchDistance:100,maxPatternLength:32,minMatchCharLength:1,isCaseSensitive:false,findAllMatches:false,useExtendedSearch:false,});window.fuse=fuse;}
else{console.error('['+xhr.status+']Error:',xhr.statusText);}};xhr.send();})();}
function makeLi(ulElem,obj){var li=document.createElement('li');li.className='search-result__item';var a=document.createElement('a');a.innerHTML=obj.item.title;a.setAttribute('class','search-result__item--title');a.setAttribute('href',obj.item.uri);var descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');if(obj.item.description){descDiv.innerHTML=obj.item.description;}else if(obj.item.content){descDiv.innerHTML=obj.item.content.substring(0,225);}
li.appendChild(a);li.appendChild(descDiv);ulElem.appendChild(li);}
function makeHighlightLi(ulElem,obj){var li=document.createElement('li');li.className='search-result__item';var descDiv=null;var a=document.createElement('a');a.innerHTML=obj.item.title;a.setAttribute('class','search-result__item--title');a.setAttribute('href',obj.item.uri);if(obj.matches&&obj.matches.length){for(var i=0;i<obj.matches.length;i++){if('title'===obj.matches[i].key){a=document.createElement('a');a.innerHTML=generateHighlightedText(obj.matches[i].value,obj.matches[i].indices);a.setAttribute('class','search-result__item--title');a.setAttribute('href',obj.item.uri);}
if('description'===obj.matches[i].key){descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=generateHighlightedText(obj.item.description,obj.matches[i].indices);}else if('content'===obj.matches[i].key){if(!descDiv){descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=generateHighlightedText(obj.item.content.substring(0,150),obj.matches[i].indices);}}else{if(obj.item.description){descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=obj.item.description;}else{descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=obj.item.content.substring(0,150);}}}
li.appendChild(a);if(descDiv){li.appendChild(descDiv);}
if(li){ulElem.appendChild(li);}}}
function renderSearchResultsSide(searchText,results){searchResults=document.getElementById('search-results');searchMenu=document.getElementById('search-menu');searchResults.setAttribute('class','dropdown is-active');var ul=document.createElement('ul');ul.setAttribute('class','dropdown-content search-content');if(results.length){results.forEach(function(result){var li=document.createElement('li');var a=document.createElement('a');a.setAttribute('href',result.uri);a.setAttribute('class','dropdown-item');a.appendChild(li);var titleDiv=document.createElement('div');titleDiv.innerHTML=result.title;titleDiv.setAttribute('class','menu-item__title');var descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');if(result.description){descDiv.innerHTML=result.description;}else if(result.content){descDiv.innerHTML=result.content.substring(0,150);}
li.appendChild(titleDiv);li.appendChild(descDiv);ul.appendChild(a);});}else{var li=document.createElement('li');li.setAttribute('class','dropdown-item');li.innerText='No results found';ul.appendChild(li);}
while(searchMenu.hasChildNodes()){searchMenu.removeChild(searchMenu.lastChild);}
searchMenu.appendChild(ul);}
function renderSearchHighlightResultsSide(searchText,results){searchResults=document.getElementById('search-results');searchMenu=document.getElementById('search-menu');searchResults.setAttribute('class','dropdown is-active');var ul=document.createElement('ul');ul.setAttribute('class','dropdown-content search-content');if(results.length){results.forEach(function(result){var li=document.createElement('li');var a=document.createElement('a');var descDiv=null;a.setAttribute('href',result.item.uri);a.setAttribute('class','dropdown-item');a.appendChild(li);var titleDiv=document.createElement('div');titleDiv.innerHTML=result.item.title;titleDiv.setAttribute('class','menu-item__title');if(result.matches&&result.matches.length){for(var i=0;i<result.matches.length;i++){if('title'===result.matches[i].key){titleDiv.innerHTML=generateHighlightedText(result.matches[i].value,result.matches[i].indices);}
if('description'===result.matches[i].key){descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=generateHighlightedText(result.item.description,result.matches[i].indices);}else if('content'===result.matches[i].key){if(!descDiv){descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=generateHighlightedText(result.item.content.substring(0,150),result.matches[i].indices);}}else{if(result.item.description){descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=result.item.description;}else{descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=result.item.content.substring(0,150);}}}
li.appendChild(titleDiv);if(descDiv){li.appendChild(descDiv);}
ul.appendChild(a);}});}else{var li=document.createElement('li');li.setAttribute('class','dropdown-item');li.innerText='No results found';ul.appendChild(li);}
while(searchMenu.hasChildNodes()){searchMenu.removeChild(searchMenu.lastChild);}
searchMenu.appendChild(ul);}
function renderSearchResultsMobile(searchText,results){searchResults=document.getElementById('search-mobile-results');var content=document.createElement('div');content.setAttribute('class','mobile-search__content');if(results.length>0){results.forEach(function(result){var item=document.createElement('a');item.setAttribute('href',result.uri);item.innerHTML='<div class="mobile-search__item"><div class="mobile-search__item--title">📄 '+result.title+'</div><div class="mobile-search__item--desc">'+(result.description?result.description:result.content)+'</div></div>';content.appendChild(item);});}else{var item=document.createElement('span');content.appendChild(item);}
let wrap=document.getElementById('search-mobile-results');while(wrap.firstChild){wrap.removeChild(wrap.firstChild)}
searchResults.appendChild(content);}
function renderSearchHighlightResultsMobile(searchText,results){searchResults=document.getElementById('search-mobile-results');var ul=document.createElement('div');ul.setAttribute('class','mobile-search__content');if(results.length){results.forEach(function(result){var li=document.createElement('li');var a=document.createElement('a');var descDiv=null;a.setAttribute('href',result.item.uri);a.appendChild(li);li.setAttribute('class','mobile-search__item');var titleDiv=document.createElement('div');titleDiv.innerHTML=result.item.title;titleDiv.setAttribute('class','mobile-search__item--title');if(result.matches&&result.matches.length){for(var i=0;i<result.matches.length;i++){if('title'===result.matches[i].key){titleDiv.innerHTML=generateHighlightedText(result.matches[i].value,result.matches[i].indices);}
if('description'===result.matches[i].key){descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=generateHighlightedText(result.item.description,result.matches[i].indices);}else if('content'===result.matches[i].key){if(!descDiv){descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=generateHighlightedText(result.item.content.substring(0,150),result.matches[i].indices);}}else{if(result.item.description){descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=result.item.description;}else{descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=result.item.content.substring(0,150);}}}
li.appendChild(titleDiv);if(descDiv){li.appendChild(descDiv);}
ul.appendChild(a);}});}else{var item=document.createElement('span');ul.appendChild(item);}
let wrap=document.getElementById('search-mobile-results');while(wrap.firstChild){wrap.removeChild(wrap.firstChild)}
searchResults.appendChild(ul);}
function generateHighlightedText(text,regions){if(!regions){return text;}
var content='',nextUnhighlightedRegionStartingIndex=0;regions.forEach(function(region){if(region[0]===region[1]){return null;}
content+=''+
text.substring(nextUnhighlightedRegionStartingIndex,region[0])+
'<span class="search__highlight">'+
text.substring(region[0],region[1]+1)+
'</span>'+
'';nextUnhighlightedRegionStartingIndex=region[1]+1;});content+=text.substring(nextUnhighlightedRegionStartingIndex);return content;};var searchElem=document.getElementById('search');var searchMobile=document.getElementById('search-mobile');var searchResultsContainer=document.getElementById('search-results');searchElem?searchElem.addEventListener('input',function(e){if(!e.target.value|window.innerWidth<770){searchResultsContainer?searchResultsContainer.setAttribute('class','dropdown'):null;searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;return null;}
searchText=e.target.value;var results=fuse.search(e.target.value);if(searchResultPosition==="main"){if(enableSearchHighlight){renderSearchHighlightResultsMain(searchText,results);}else{renderSearchResultsMain(searchText,results);}}else{if(enableSearchHighlight){renderSearchHighlightResultsSide(searchText,results);}else{renderSearchResultsSide(searchText,results);}
var dropdownItems=searchResultsContainer.querySelectorAll('.dropdown-item');dropdownItems?dropdownItems.forEach(function(item){item.addEventListener('mousedown',function(e){e.target.click();});}):null;}}):null;searchElem?searchElem.addEventListener('blur',function(){if(window.innerWidth<770){return null;}
searchResultsContainer?searchResultsContainer.setAttribute('class','dropdown'):null;}):null;searchElem?searchElem.addEventListener('click',function(e){if(window.innerWidth<770){return null;}
if(!e.target.value){searchResultsContainer?searchResultsContainer.setAttribute('class','dropdown'):null;return null;}
searchText=e.target.value;var results=fuse.search(e.target.value);if(searchResultPosition==="main"){if(enableSearchHighlight){renderSearchHighlightResultsMain(searchText,results);}else{renderSearchResultsMain(searchText,results);}}else{if(enableSearchHighlight){renderSearchHighlightResultsSide(searchText,results);}else{renderSearchResultsSide(searchText,results);}
var dropdownItems=searchResultsContainer.querySelectorAll('.dropdown-item');dropdownItems?dropdownItems.forEach(function(item){item.addEventListener('mousedown',function(e){e.target.click();});}):null;}}):null;var searchMenuElem=document.getElementById("search-menu");var activeItem=document.querySelector('#search-menu .dropdown-item.is-active');var activeIndex=null;var items=null;var searchContainerMaxHeight=350;searchElem?searchElem.addEventListener('keydown',function(e){if(window.innerWidth<770){return null;}
if(e.key==='Escape'){searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;}
var items=document.querySelectorAll('#search-menu .dropdown-item');var keyCode=e.which||e.keyCode;if(!items||!items.length){return null;}
if(e.key==='ArrowDown'||keyCode===40){if(activeIndex===null){activeIndex=0;items[activeIndex].classList.remove('is-active');}else{items[activeIndex].classList.remove('is-active');activeIndex=activeIndex===items.length-1?0:activeIndex+1;}
items[activeIndex].classList.add('is-active');let overflowedPixel=items[activeIndex].offsetTop+items[activeIndex].clientHeight-searchContainerMaxHeight;if(overflowedPixel>0){document.querySelector(".search-content").scrollTop+=items[activeIndex].getBoundingClientRect().height;}else if(activeIndex===0){document.querySelector(".search-content").scrollTop=0;}}else if(e.key==='ArrowUp'||keyCode===38){if(activeIndex===null){activeIndex=items.length-1;items[activeIndex].classList.remove('is-active');}else{items[activeIndex].classList.remove('is-active');activeIndex=activeIndex===0?items.length-1:activeIndex-1;}
items[activeIndex].classList.add('is-active');let overflowedPixel=items[activeIndex].offsetTop+items[activeIndex].clientHeight-searchContainerMaxHeight;if(overflowedPixel<0){document.querySelector(".search-content").scrollTop-=items[activeIndex].getBoundingClientRect().height;}else{document.querySelector(".search-content").scrollTop=overflowedPixel+items[activeIndex].getBoundingClientRect().height;}}else if(e.key==='Enter'||keyCode===13){if(items[activeIndex]&&items[activeIndex].getAttribute('href')){location.href=items[activeIndex].getAttribute('href');}}else if(e.key==='Escape'||keyCode===27){e.target.value=null;if(searchResults){searchResults.classList.remove('is-active');}}}):null;searchMobile?searchMobile.addEventListener('input',function(e){if(!e.target.value){let wrap=document.getElementById('search-mobile-results');while(wrap.firstChild){wrap.removeChild(wrap.firstChild);}
return null;}
searchText=e.target.value;var results=fuse.search(e.target.value);renderSearchResultsMobile(searchText,results);if(enableSearchHighlight){renderSearchHighlightResultsMobile(searchText,results);}else{renderSearchResultsMobile(searchText,results);}}):null;var mobileSearchInputElem=document.querySelector('#search-mobile');var mobileSearchClassElem=document.querySelector('.mobile-search');var mobileSearchBtnElems=document.querySelectorAll('.navbar-search');var mobileSearchCloseBtnElem=document.querySelector('#search-mobile-close');var mobileSearchContainer=document.querySelector('#search-mobile-container');var mobileSearchResultsElem=document.querySelector('#search-mobile-results');var htmlElem=document.querySelector('html');if(mobileSearchClassElem){mobileSearchClassElem.style.display='none';}
mobileSearchBtnElems?mobileSearchBtnElems.forEach(function(elem,idx){elem.addEventListener('click',function(){if(mobileSearchContainer){mobileSearchContainer.style.display='block';}
if(mobileSearchInputElem){mobileSearchInputElem.focus();}
if(htmlElem){htmlElem.style.overflowY='hidden';}});}):null;mobileSearchCloseBtnElem?mobileSearchCloseBtnElem.addEventListener('click',function(){if(mobileSearchContainer){mobileSearchContainer.style.display='none';}
if(mobileSearchInputElem){mobileSearchInputElem.value='';}
if(mobileSearchResultsElem){while(mobileSearchResultsElem.firstChild){mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);}}
if(htmlElem){htmlElem.style.overflowY='visible';}}):null;mobileSearchInputElem?mobileSearchInputElem.addEventListener('keydown',function(e){var keyCode=e.which||e.keyCode;if(e.key==='Escape'||keyCode===27){if(mobileSearchContainer){mobileSearchContainer.style.display='none';}
if(mobileSearchInputElem){mobileSearchInputElem.value='';}
if(mobileSearchResultsElem){while(mobileSearchResultsElem.firstChild){mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);}}
if(htmlElem){htmlElem.style.overflowY='visible';}}}):null;function renderSearchResultsMain(searchText,results){var searchBody=document.querySelector('.search-result__body');var originUl=searchBody.querySelector('ul');var ul=document.createElement('ul');if(!searchText){searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;}else if(results){if(results&&results.length){results.forEach(function(result){makeLi(ul,result);});searchResult?searchResult.setAttribute('data-display','block'):null;summaryContainer?summaryContainer.setAttribute('data-display','none'):null;}}
originUl.parentNode.replaceChild(ul,originUl);}
function renderSearchHighlightResultsMain(searchText,results){var searchBody=document.querySelector('.search-result__body');var originUl=searchBody.querySelector('ul');var ul=document.createElement('ul');if(!searchText){searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;}else if(results){if(results&&results.length){results.forEach(function(result){makeHighlightLi(ul,result);});searchResult?searchResult.setAttribute('data-display','block'):null;summaryContainer?summaryContainer.setAttribute('data-display','none'):null;}}
originUl.parentNode.replaceChild(ul,originUl);}});</script><link rel=stylesheet href=/css/main.min.css><meta name=description content><meta name=created content="2024-05-16T00:00:00+0000"><meta name=modified content="2024-05-16T00:00:00+0000"><meta property="article:published_time" content="2024-05-16T00:00:00+0000"><meta name=author content="8bitマイコン"><meta property="og:site_name" content="@771-8bit"><meta property="og:title" content="Kibo-RPC参加記"><meta property="og:url" content="https://771-8bit.com/secret/kibo-rpc/"><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:image" content="https://771-8bit.com/images/blog/kibo-rpc/kibo-rpc.png"><meta property="og:image:url" content="https://771-8bit.com/images/blog/kibo-rpc/kibo-rpc.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:app:name:iphone content="@771-8bit"><meta property="twitter:title" content="Kibo-RPC参加記"><meta property="twitter:description" content><meta name=generator content="Hugo 0.78.2"><meta name=msapplication-TileColor content="#fff"><meta name=theme-color content="#fff"><meta name=msapplication-navbutton-color content="#fff"><meta name=apple-mobile-web-app-status-bar-style content="#fff"><link rel=canonical href=https://771-8bit.com/secret/kibo-rpc/><link rel=manifest href=/manifest.json><link rel=apple-touch-icon sizes=57x57 href=/favicon/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/favicon/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/favicon/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/favicon/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/favicon/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/favicon/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/favicon/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/favicon/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-512x512.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","headline":"Kibo-RPC参加記","datePublished":"2024-05-16T00:00:00Z","dateModified":"2024-05-16T00:00:00Z","url":"https://771-8bit.com/secret/kibo-rpc/","description":"\u003cp\u003eJAXAが主催する第5回「きぼう」ロボットプログラミング競技会（Kibo-RPC）の参加記です．日本国内予選で優勝し，日本代表として軌道上決勝大会に参加しました．\u003cbr /\u003e このブログではマネジメントについて，画像認識を中心にプログラム全体についてまとめます．\u003c/p\u003e","image":"https://771-8bit.com/images/blog/kibo-rpc/kibo-rpc.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://771-8bit.com"},"publisher":{"@type":"Organization","name":"@771-8bit","url":"https://771-8bit.com"}}</script></head><body id=root class=theme__light><script>var localTheme=localStorage.getItem('theme');if(localTheme){document.getElementById('root').className='theme__'+localTheme;}</script><div id=container><div class=wrapper data-type=secret data-kind=page><nav class="navbar scrolling" role=navigation aria-label="main navigation" data-dir=ltr><div class=navbar__brand>&nbsp;&nbsp;
<a href=/ title=ホーム rel=home class=navbar__title-link><h6 class=navbar__title>@771-8bit</h6></a></div><div class="theme theme-mobile" data-ani=true><div class=dropdown><button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentcolor" d="M6.34 7.93c-3.12 3.12-3.12 8.19.0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19.0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41.0L6.34 7.93zM12 19.59c-1.6.0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg></button><div class="dropdown-content select-theme"><a href=# class="dropdown-item select-theme__item is-active">light</a>
<a href=# class="dropdown-item select-theme__item">dark</a></div></div></div><div class="mobile-search__btn navbar-search" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49.0s.41-1.08.0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></div><div id=search-mobile-container class="mobile-search hide" data-dir=ltr><div class=mobile-search__top><input id=search-mobile type=text aria-label="Mobile Search" placeholder=検索 class=mobile-search__top--input><div id=search-mobile-close class=mobile-search__top--icon><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path opacity=".87" fill="none" d="M0 0h24v24H0V0z"/><path fill="currentcolor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41.0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"/></svg></div></div><div id=search-mobile-results class=mobile-search__body></div></div><a role=button class=navbar__burger aria-label=menu aria-expanded=false data-ani=true><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><div class=navbarm__collapse data-open=false><ul dir=ltr><li class=navbarm__menu--item><a href=/profile>Profile</a></li><li class=navbarm__menu--item><a href=/archive>Archive</a></li><li class=navbarm__menu--item><a href=/tags class=navbarm__menu--term data-index=0>タグ</a></li></ul></div><div class=navbar__menu><div class=theme data-ani=true><div class=dropdown><button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentcolor" d="M6.34 7.93c-3.12 3.12-3.12 8.19.0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19.0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41.0L6.34 7.93zM12 19.59c-1.6.0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg></button><div class="dropdown-content select-theme"><a href=# class="dropdown-item select-theme__item is-active">light</a>
<a href=# class="dropdown-item select-theme__item">dark</a></div></div></div><a href=/profile class="navbar__menu-item navbar__slide-down" dir=ltr data-ani=true>Profile</a>
<a href=/archive class="navbar__menu-item navbar__slide-down" dir=ltr data-ani=true>Archive</a></div></nav><main class="single__main main-main"><nav class="breadcrumb hide" aria-label=breadcrumbs><script>document.querySelector('.breadcrumb').classList.remove('hide')</script><ol><li><a href=https://771-8bit.com/ class=capitalize>@771-8bit</a></li><li><a href=https://771-8bit.com/secret/ class=capitalize>Secrets</a></li><li class=is-active><span>Kibo-RPC参加記</span></li></ol></nav><div class=single><div class=single__nojs>JavaScriptを有効にしてください</div><script>document.querySelector('.single').classList.remove('hide');document.querySelector('.single__nojs').classList.add('hide');</script><h2 class=single__title data-ani=true>Kibo-RPC参加記</h2><h3 class=single__subtitle></h3><div class=single__meta><div class=single__infos><time class=single__info title=作成日>📅&nbsp;2024/5/16</time>
&nbsp;&#183;&nbsp; <span class=single__info title=読了時間>☕&nbsp;21&nbsp;分で読めます</span>
<span class=single__info></span></div><ul class="single__tags caption"></ul></div><article class=single__contents data-dir=ltr data-ani=true><p>JAXAが主催する第5回「きぼう」ロボットプログラミング競技会（Kibo-RPC）の参加記です．日本国内予選で優勝し，日本代表として軌道上決勝大会に参加しました．<br>このブログではマネジメントについて，画像認識を中心にプログラム全体についてまとめます．</p><hr><p><img src=/images/blog/kibo-rpc/preliminary.jpg alt loading=lazy></p><h2 id=kibo-rpcとは>Kibo-RPCとは</h2><blockquote><p>「きぼう」ロボットプログラミング競技会（Kibo-RPC）は、宇宙飛行士をサポートするために開発された国際宇宙ステーション(ISS)船内ドローンであるInt-Ball(JAXA)とAstrobee(NASA)のプログラミングをすることで、さまざまな課題を解決する教育プログラムです。</p></blockquote><p><a href=https://humans-in-space.jaxa.jp/biz-lab/kuoa/kibo-rpc/>https://humans-in-space.jaxa.jp/biz-lab/kuoa/kibo-rpc/</a></p><h2 id=大会ルール>大会ルール</h2><p>5回大会では、AstoebeeでISS内を巡回して宇宙飛行士が必要とするアイテムを探すミッションを行います。<br>ISSのきぼうモジュールに設置されたアイテムの画像が置いてあるエリアにAstrobeeを移動させ、全ての画像を読み取ります。その後、宇宙飛行士のもとへ移動して各エリアにあったアイテムの種類と数を報告し、宇宙飛行士の持っているターゲットアイテムの画像を読み取ります。ターゲットアイテムと同じ種類のItemがあった場所まで移動し撮影することで場所を伝えたらミッション終了です。制限時間は5分です。<br><img src=/images/blog/kibo-rpc/rule.jpg alt loading=lazy></p><p>予選ではシミュレータでプログラムを実行し、本選ではISSの中でAstrobeeの実機を動かします。<br><img src=/images/blog/kibo-rpc/simulator.jpg alt loading=lazy></p><p><img src=/images/blog/kibo-rpc/astrobee_iss.jpg alt loading=lazy>
<a href=https://jaxa.krpc.jp/ja>https://jaxa.krpc.jp/ja</a></p><h2 id=チーム構成>チーム構成</h2><p>チームメンバーは，ハイブリッドロケットやCanSatなど宇宙系のものづくりサークルのOBの3人です．<a href=https://x.com/nihinihikun_tec>にひにひ</a>と<a href=https://x.com/abema_astro>あべま</a>のブログもご覧ください．</p><h2 id=マネジメント>マネジメント</h2><p>テックブログで先にマネジメントについて書くのは異例な気がしますが，重要だと思うので先に書きます．</p><p>全員がものづくりサークルを経験していてマネジメントの感覚がある程度あり，普段よく話すのでコミュニケーションが取りやすく，お互いの都合やモチベーションを把握できるメンバー構成だったという強みがありました．お互いのことが分かっているとはいえダラダラやるのではなく，必要最低限の最適なマネジメントができたと思います．余計な会議をしたりスケジュール表を作ったりマネジメントで消耗することなく，プロジェクトマネジメントとして必要な判断はちゃんとやっていくという雰囲気です．</p><p>このセクションの内容はKibo-RPC参加チーム用のSlackでいただいた質問の回答をもとに書いています．（↓当時の自チーム内Discordでの反応）<br><img src=/images/blog/kibo-rpc/management.jpg alt loading=lazy></p><h3 id=コミュニケーション>コミュニケーション</h3><p>完全にソフトウェアのコンテストなので基本的にはオンラインで活動していました．対面活動は会ったときについでに話す程度です．</p><p>定例ミーティングもしないという方針でした．サークルや企業など大人数だとどうしても定例として日程を抑える必要がありますが，定例があるとそれに間に合わせるように作業を進めがちになってしまいます．今回は作業をとにかく進め，その中で必要になったら予定をあわせてミーティングをするという形を取りました．1,2日前に調整して行ったミーティングは結果的には1,2週間ごとの頻度で，作業中の不明点を解決するために突発的にボイスチャットが始まることも多々ありました．</p><p>同期/非同期どちらもコミュニケーションツールにはDiscordを使用しました．ミーティングをしないかわりにdiscordの個人ごとの#memoチャンネルで何をしているかをなるべく共有するようにしました．お互い作業していることが分かるのでモチベーションが保てること，作業に詰まったときに気づけること，雑なコミュニケーションを取りやすいことがメリットです．また，ソースコードそのもに関する議論はGitHubのPR上で行い，それをDiscrodに流すWebhookも使用しました．</p><p>それぞれのモチベーションや作業量，RPC以外のタスクを共有することで，つまらない忙しい難しいというのを個人の責任から引き剥がしてマネジメント側でどうにかするという意識を持っていました．</p><h3 id=スケジュール管理>スケジュール管理</h3><p>Kibo-RPCの経験や画像認識プログラムの経験は無かったので，最初から完全なスケジュールを組むのはできませんでした．手を動かして感触をつかみ，随時決め打ちでいいからできる限りマイルストーンを置くことを意識しました．</p><p>4月末から作業を始め，まず最初の1週間は特にスケジュールを考えず手を動かしました．その後は提出期限の2週間前を完成目標と意識したうえで，マイルストーンを適宜おいて進めました．2週間前(6/7)は予め余裕を持った設定で，5月末にはやや遅延があったのとタスクが明確になっていたことからこの余裕を潰して1週間完成目標を遅らせ，予選期間の最後の1週間は最終確認を行いました．決勝では，画像処理のブラッシュアップや経路の変更，冗長ロジックの追加などを適宜行いました．</p><p>スケジュールの決定については，ミーティングで個人の予定(いつどれくらい作業時間取れるか)を確認して調整しました．とくに調整が必要なければ会議はせずDiscordで一方的に連絡することもありました．</p><h3 id=タスク分担>タスク分担</h3><p>タスク分担の方針は責任範囲をはっきり大きく分けることです．メンバーのモチベのため，多少遅延しても他のメンバーに影響を与えないため，コミュニケーションコストを減らすためといった理由があります．</p><p>具体的には，プログラムの統括と画像認識，経路設計は私が担当し，クォータニオンを使った最後のTarget Itemの撮影位置計算を<a href>にひにひ</a>に，マルチスレッド化，シーケンス・例外処理のレビューといったタスクを[あべま]に分担しました．</p><h3 id=ドキュメント>ドキュメント</h3><p>今回は大会期間が短くメンバーも少ないため，ドキュメントは最小限にしています．ドキュメントとして独立しているのは以下のものです．Javadoc形式のコメントも活用し，ソースコードのコメントに書けるものは直接書いています．</p><ul><li>スケジュールなどを雑にまとめるミーティング議事録</li><li>環境構築のメモ</li><li>実機Astrobeeの調査資料</li><li>プログラム全体のフローチャート(最終確認でチーム内レビューのため)</li></ul><h2 id=ソフトウェア>ソフトウェア</h2><h3 id=ルール詳細>ルール詳細</h3><ul><li>アイテムの表示領域(Display Area)とARマーカーの位置関係<br><img src=/images/blog/kibo-rpc/display_area.jpg alt loading=lazy></li><li>アイテム(Lost Item)一覧<br><img src=/images/blog/kibo-rpc/lost_item_list.jpg alt loading=lazy></li><li>アイテム表示例<br><img src=/images/blog/kibo-rpc/item_example.jpg alt loading=lazy></li><li>配点（非公開、シミュレータの結果からの予測）<ul><li>種類と数を正確に判別できないと0<ul><li>Level1 30</li><li>Level2 40</li><li>Level3 50</li><li>Level4 60</li></ul></li><li>Target Itemの撮影 60<ul><li>画角と位置両方が正確でないと0</li></ul></li><li>時間点 30<ul><li>0.125点/秒</li><li>1分で30点、5分で0点</li></ul></li></ul></li></ul><h3 id=シーケンス>シーケンス</h3><p>画像認識や誘導の機能自体には立ち入らず、正常系の機能をいつどのように実行するか、異常時に被害を最小限に抑えるための処理をシーケンスとしてまとめます。</p><h4 id=予選>予選</h4><iframe width=640 height=360 src="https://www.youtube-nocookie.com/embed/xzOLx4zddfo?si=YI1MiiQqtqLCuLNM&start=1426" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><h4 id=決勝>決勝</h4><h3 id=画像認識>画像認識</h3><p>まずは，JAXA公式のチュートリアル動画を参考にしました．ちなみにチャンネル登録していたJAXAのYouTubeチャンネルにこれが流れてきたのが大会参加のきっかけです．</p><p>カメラ固有のパラメータを使った撮影画像の歪み補正，ARマーカーの検出，テンプレートマッチングの基礎について解説されています．撮影画像から紙のエリアを抽出すること，高速にアイテムを検出すること，アイテムの重なりに対処することが主な課題として挙げられています．</p><iframe width=640 height=360 src="https://www.youtube-nocookie.com/embed/OHuWhMKvYrQ?si=L2pIfvKhxB5y8qMI" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><h4 id=エリアの抽出>エリアの抽出</h4><p>ARマーカーの四隅の座標と紙の四隅の座標の関係は既知であり，画像の歪み補正をしてからARマーカーの四隅の座標を使って透視変換を行うことで紙のエリアを抽出できます．原理的にはこれで良いのですが，何も考えずに行うと画像の歪み補正と透視変換の段階でかなり画質が劣化します．一般に無理に画像を拡大すると画像はボヤけ，さらに変形も伴うのでリサンプリングの段階で劣化するのは明らかです．</p><p>まず画像の歪み補正をする前に画像を拡大します．拡大時の画素の補間方法にもバイリニア法，バイキュービック法など様々な手法がありますが，対象が二値のイラストであるためここでは最もシャープネスを保てるランチョス法を採用しました．画像の歪み補正や透視変換の段階でも変形した後に画素をリサンプリングしますが，この補間にもランチョス法を指定することによりシャープネスを保ちました．</p><p>対策の方針として，なるべく入力に近い側で高画質化すること(というより情報量を落とさないこと)，高画質化のためになるべく余計な処理をしないことを意識しました．例えば歪み補正をしてから拡大をしたのでは，歪み補正の段階で情報が落ちてしまうのでその後いくら処理をしても画質が戻りません．</p><p>この工夫により，アイテムの画像がぼやけず画像認識に適した状態になるだけでなく，ARマーカーの座標も正確になり紙の抽出範囲も正確になりました．これらの性能向上により，撮影画像の中で紙の写った範囲が狭くても正確な画像認識を行うことができ，予選でのエリア2,3の同時撮影が可能になりました．</p><p><img src=/images/blog/kibo-rpc/hammer_original.bmp alt loading=lazy>
<center>↑撮影画像</center></p><p><img src=/images/blog/kibo-rpc/hammer_area.png alt loading=lazy>
<center>↑撮影画像をそのまま切り抜いたもの</center></p><p><img src=/images/blog/kibo-rpc/hammer_conventional.png alt loading=lazy>
<center>↑単純に歪み補正・透視変換したものと，その二値化画像</center></p><p><img src=/images/blog/kibo-rpc/hammer_extracted.png alt loading=lazy>
<center>↑実装したアルゴリズムによる抽出画像と，その二値化画像</center></p><h4 id=二値化>二値化</h4><p>アイテム認識がテンプレートマッチング・機械学習のどちらであってもアイテム認識の前に画像の明るさは正規化されるべきであり，対象が白黒のイラストであるため二値化を行いました．</p><p>予選ではシミュレータでのプログラム実行であり，閾値を決め打ちして問題がないことを確認していましたが，決勝では照明環境・カメラ性能がシミュレータと一致する保証がないためロバストな二値化アルゴリズムを設計しました．</p><p>プログラムを作る前に，まずは実機のカメラの特性を調べてみました．Kibo-RPCではAstrobeeの前方のNavCamと後方のDockCamの使用が許可されており，この特性を調査しました．</p><ul><li><blockquote><p>First is the NavCam, a forward-facing monocular RGB imager with 130° field of view (FOV), fixed focus, and 1.2 Figure 2: Exploded view with nozzle geometry megapixel (MP) resolution.</p></blockquote><blockquote><p>DockCam is a clone of NavCam that faces aft, where it can view fiducials on the Astrobee dock during the docking approach.</p></blockquote><p>&ldquo;ASTROBEE: A NEW PLATFORM FOR FREE-FLYING ROBOTICS ON THE INTERNATIONAL SPACE STATION&rdquo; NASA Technical Reports Server<br><a href=https://ntrs.nasa.gov/api/citations/20160007769/downloads/20160007769.pdf>https://ntrs.nasa.gov/api/citations/20160007769/downloads/20160007769.pdf</a></p></li><li><blockquote><p>NavCam and DockCam, 1.2-megapixel 130° FOV RGB cameras. PerchCam and HazCam, Pico Flexx lidars. SciCam, 13-megapixel RGB smartphone camera. SpeedCam, PixHawk PX4Flow integrated sonar/optical flow sensor.</p></blockquote><p>&ldquo;Astrobee&rdquo; robotsguide.com<br><a href=https://robotsguide.com/robots/astrobee>https://robotsguide.com/robots/astrobee</a></p></li><li><blockquote><p>RGB camera - Imaging Source 42BUC03-ML</p></blockquote><p>&ldquo;Astrobee: ROS-based Flight Software for a Free-flying Robot in Microgravity&rdquo; ROSCon 2018<br><a href=https://roscon.ros.org/2018/presentations/ROSCon2018_astrobee.pdf>https://roscon.ros.org/2018/presentations/ROSCon2018_astrobee.pdf</a></p></li><li><blockquote><p>1/3 inch onsemi CMOS AR0134 Sensor</p></blockquote><p>&ldquo;DFM 42BUC03-ML&rdquo; The Imaging Source<br><a href=https://www.theimagingsource.com/en-us/product/board/2u/dfm42buc03ml/>https://www.theimagingsource.com/en-us/product/board/2u/dfm42buc03ml/</a></p></li><li><blockquote><p>ON Semiconductor&rsquo;s 3rd Generation Global Shutter Technology<br>Superior low-light performance</p></blockquote><blockquote><p>Dynamic range 64 dB</p></blockquote><p>&ldquo;1/3-Inch 1.2 Mp CMOS Digital Image Sensor with Global Shutter AR0134 Datasheet, Rev. G&rdquo;<br><a href=https://s1-dl.theimagingsource.com/api/2.5/packages/publication/sensor-onsemi/ar0134/fa857e87-520c-5103-868e-b0f8c3cd76a6/ar0134_1.1.en_US.pdf>https://s1-dl.theimagingsource.com/api/2.5/packages/publication/sensor-onsemi/ar0134/fa857e87-520c-5103-868e-b0f8c3cd76a6/ar0134_1.1.en_US.pdf</a></p></li></ul><p>Aliexpressにこのイメージセンサの評価ボードがありましたが，かなり高価なため購入しませんでした．<br><a href=https://ja.aliexpress.com/i/1005003883995877.html>https://ja.aliexpress.com/i/1005003883995877.html</a></p><p>onsemiのAR0134はグローバルシャッターで歪みはないこと，低ノイズで低照度性能が良いことが特徴とされており．その反面ダイナミックレンジは64dBとやや低めになっています．そのため評価用の画像はXperia 5 ⅡでHDRをOFFにして撮影した画像としました．画素数は異なるため，ニアレストネイバー法で1280:960に縮小しています．</p><p><img src=/images/blog/kibo-rpc/watch_original.png alt loading=lazy>
<center>↑撮影画像</center></p><p>まず，二値化アルゴリズムとしては大津の二値化という手法が一般的です．これは閾値で分けられた2つのクラス内分散が小さくなるように閾値を決定する手法です．ある程度強力な手法ではありますが，1つの閾値で白黒を分ける以上，人為的に閾値を決定したとしても照明により局所的に明るさが変わる場合には以下のように黒い線が白飛びして白い背景が黒つぶれしてしまいます．</p><p><img src=/images/blog/kibo-rpc/watch_single.png alt loading=lazy>
<center>↑1つの閾値で二値化した画像</center></p><p>ちなみに，大津の二値化そのままだとこのような画像になります．</p><p><img src=/images/blog/kibo-rpc/watch_otsu.png alt loading=lazy>
<center>↑大津の二値化で二値化した画像</center></p><p>画像全体で1つの閾値を使うのではなく，部分的に閾値を判断していく適応的二値化という手法があります．これによりアイテム部分は綺麗に二値化できますが，白い背景部分も無理やり白黒に分けようとしてしまい，以下のようになります．</p><p><img src=/images/blog/kibo-rpc/watch_adaptive.png alt loading=lazy>
<center>↑適応的二値化で二値化した画像</center></p><p>ヒストグラムベースの二値化手法では問題を解決できないと考え，画像の形状に着目した二値化手法を考案しました．</p><p>アイテムの輪郭を把握するため，まずキャニー法によりエッジ検出を行います．エッジは途切れることがあるため，線を太くする膨張処理を行います．次にOpenCVのfindContours関数により親子関係含めて輪郭抽出を行い，一番外側の輪郭をもとに独立した領域ごとに分割します．ノイズと推定されたものを除去したのち，各領域を統合して二値化画像が完成です．紙の枠線やノイズの対処については解説を省略しますが，おおまかな流れはこの通りです．</p><p><img src=/images/blog/kibo-rpc/watch_process.png alt loading=lazy>
<center>↑二値化処理の流れ</center></p><p><img src=/images/blog/kibo-rpc/watch_final.png alt loading=lazy>
<center>↑最終的な二値化画像</center></p><p>シミュレータ上で何度もテストして二値化に問題が起きないことは確認しましたが，考案したこの手法は低照度環境下でキャニーエッジ検出が適切に動作しないという弱点があります．しかしISS船内はある程度明るいこと，Astrobeeのイメージセンサの低照度性能が良いとされていることから，この手法を採用しました．</p><p><img src=/images/blog/kibo-rpc/lowlight.png alt loading=lazy>
<center>↑低照度下でノイズがのった画像とその拡大画像</center></p><p><img src=/images/blog/kibo-rpc/lowlight_process.png alt loading=lazy>
<center>↑低照度画像のキャニーエッジ検出</center></p><p><img src=/images/blog/kibo-rpc/lowlight_final.png alt loading=lazy>
<center>↑低照度環境下での最終的な二値化画像</center></p><h4 id=アイテム認識>アイテム認識</h4><p>チュートリアル動画の通りテンプレートマッチングは簡単に実装できましたが，計算時間が膨大であり，アイテムの重なりに対処できないことが課題になっていました．テンプレートマッチングで正確にアイテム数を数える前に，高速にアイテムの種類を絞る手法を用意する必要があります．</p><p>機械学習は環境構築がやや面倒だと感じたため，OpenCVで完結するようにまずはAKAZE特徴量での分類を試しまた．ある程度分類することはできましたが，小さなアイテムや似たアイテムは難しく2週間程度格闘して諦めました．<br><img src=/images/blog/kibo-rpc/akaze.jpg alt loading=lazy>
<center>↑AKAZE特徴量での分類</center></p><p>5月中旬には機械学習に方針を変更し，1週間程度でTensor Flowで3秒以内にほぼ100%の精度で種類を判別できるようになりました．Tensor Flowでは重なったアイテムを正確に数えることができませんでした．偽陽性も偽陰性もあるため閾値の調整では対応できず，モデルや学習データを工夫する必要がありますが複雑なブラックボックスとなっており，Tensor Flowで確実にアイテムの種類を絞り込み，その後古典的なテンプレートマッチングで正確に数えるという手法としました．10種類のうち1つに確定していればテンプレートマッチングにかかる時間は1/10になり，パラメータ調整も異なるアイテムの誤検出を考慮しなくてよくなります．</p><p>その後はテンプレートマッチングの精度を向上させ，5月末には基本的なロジックは完成し，それ以降はシミュレーション画像でテストを繰り返しパラメータの調整を続けました．</p><h5 id=テンプレートマッチング>テンプレートマッチング</h5><p>表示されるアイテムは10種類でエリアごとに1種類，大きさは1,1/2,1/4の3種類，角度は45度刻みです．透明なアイテム(ビーカーやゴーグルなど)は透明に重なり，不透明なアイテム(ハンマーやレンチなど)は不透明に重なります．重なりがある場合は大きさは統一されます．</p><p>ちなみに表示されるアイテムは10種類でエリアごとに1種類ということ以外はルールとしては定義されておらず，シミュレータの動作からの推測になります．「仕様になっておりますが詳細については公開できないもの」ということだそうです．</p><p>OpenCVのテンプレートマッチング関数はテンプレートの大きさや角度を変えて判定する機能はないので，コード上で大きさや角度を変えてテンプレートマッチングを繰り返しました．角度についてはあらかじめ45度ずつ回転させさテンプレートを用意し，その大きさを細かく変えてテンプレートとしていきました．実際に撮影してエリアを抽出するとスケールは1,1/2,1/4からズレてしまうので，24段階の等比数列としました．等差数列でないのはスケールの誤差は絶対誤差ではなく相対誤差が問題になるためです．</p><p>縮小時はランチョス法ではなくバイリニア法を使いました．そこまでシャープネスを保つ必要はなく，バイリニア法の方が処理速度が速いためです．大きさについては実行時に動的に変えたのに対し，角度については事前にテンプレートを用意したのは角度に合わせてアイテム周辺を丁寧に切り抜くことが目的です．<br>＞<br><img src=/images/blog/kibo-rpc/templates.jpg alt loading=lazy>
<center>テンプレート</center></p><p>重なりに対応するため，厳しめの閾値でテンプレートマッチングを行い，検出した領域を消去してからもう一度閾値を下げてテンプレートマッチングを行います．消去後に黒画素の領域が少なければ検出完了と判定しそれ以上のテンプレートマッチングは行いません．このように最大3回のテンプレートマッチングを繰り返すことで重なりに対応しました．</p><p>また，テンプレートマッチングでは<br>そこで非最大抑制制御を行い，検出された領域の中で最もスコアが高いものを残し，その周囲の領域を消去します．この処理を行うことで，重なりがある場合でも最もスコアが高いアイテムのみを検出することができます．</p><ul><li>DisplayAreaの抽出<br><img src=/images/blog/kibo-rpc/b_4_103_A_display_area.jpg alt loading=lazy></li><li>テンプレートマッチング1回目検出<br><img src=/images/blog/kibo-rpc/b_4_103_A_template1.jpg alt loading=lazy></li><li>テンプレートマッチング1回目削除<br><img src=/images/blog/kibo-rpc/b_4_103_A_template1_delete.jpg alt loading=lazy></li><li>テンプレートマッチング2回目検出<br><img src=/images/blog/kibo-rpc/b_4_103_A_template2.jpg alt loading=lazy></li><li>テンプレートマッチング2回目削除<br><img src=/images/blog/kibo-rpc/b_4_103_A_template2_delete.jpg alt loading=lazy></li><li>テンプレートマッチング3回目は無し</li></ul><p>職人芸でかなり過学習したロジックになりますが，テンプレートマッチングの閾値と非最大抑制制御を工夫することでシミュレーション画像での精度はかなり高くなりました．新規データ500枚に対してミス1枚と99.8%の精度を達成しています．</p><details><summary>テンプレートマッチングの閾値</summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=c1>// 透明のうち、beaker・goggle・thermometerは段階的に閾値を下げつつ一つずつ検出していく（重なり部分の誤検出を防ぐため、高い閾値から始めて検出済みを消す）
</span><span class=c1>// 透明のうち、pipetteはアイテム同士が重なったものを別のアイテムとして検出することはなく、検出済みを消す前でもある程度閾値を下げて良いので、領域外の黒線を誤検出しない程度に最初から下げておく
</span><span class=c1>// 不透明のうち、kapton_tapeは重なったとき部分的な要素でテンプレートマッチングを行わないと検出しづらいため、上下左右半分でのテンプレートマッチングを行う
</span><span class=c1>// 不透明のうち、screwdriverは重なったとき部分的な要素だと誤検出が多いため、全体を使ったうえで閾値を0.1下げる
</span><span class=c1>// 不透明のうち、watchは重なったとき部分的な要素だと誤検出が多いため、全体を使ったうえで閾値を0.05下げる
</span><span class=c1>// 不透明のうち、残りのhammer・top・wrenchはこれらの対策を行うと誤検出が多いため、透明と同じように検出済みを消したうえで順番に閾値を下げていく
</span><span class=c1></span>
<span class=kd>final</span> <span class=kt>double</span><span class=o>[][]</span> <span class=n>threshold</span> <span class=o>=</span> <span class=o>{{</span> <span class=c1>// PARAMETER
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>70</span><span class=o>,</span> <span class=c1>// &#34;beaker&#34; // 中途半端に下げると90度回転の誤検出が多い
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>70</span><span class=o>,</span> <span class=c1>// &#34;goggle&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>70</span><span class=o>,</span> <span class=c1>// &#34;hammer&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>63</span><span class=o>,</span> <span class=c1>// &#34;kapton_tape&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>60</span><span class=o>,</span> <span class=c1>// &#34;pipette&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>70</span><span class=o>,</span> <span class=c1>// &#34;screwdriver&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>60</span><span class=o>,</span> <span class=c1>// &#34;thermometer&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>60</span><span class=o>,</span> <span class=c1>// &#34;top&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>60</span><span class=o>,</span> <span class=c1>// &#34;watch&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>60</span>  <span class=c1>// &#34;wrench&#34;
</span><span class=c1></span><span class=o>},</span> <span class=o>{</span>                            <span class=c1>// 不透明で重なるやつは排除後の閾値低め
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>53</span><span class=o>,</span> <span class=c1>// &#34;beaker&#34;       透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>56</span><span class=o>,</span> <span class=c1>// &#34;goggle&#34;       透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>51</span><span class=o>,</span> <span class=c1>// &#34;hammer&#34;       不透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>45</span><span class=o>,</span> <span class=c1>// &#34;kapton_tape&#34;  不透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>60</span><span class=o>,</span> <span class=c1>// &#34;pipette&#34;      透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>56</span><span class=o>,</span> <span class=c1>// &#34;screwdriver&#34;  不透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>50</span><span class=o>,</span> <span class=c1>// &#34;thermometer&#34;  透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>40</span><span class=o>,</span> <span class=c1>// &#34;top&#34;          不透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>51</span><span class=o>,</span> <span class=c1>// &#34;watch&#34;        不透明
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>40</span>  <span class=c1>// &#34;wrench&#34;       不透明
</span><span class=c1></span><span class=o>},</span> <span class=o>{</span>
        <span class=n>0</span><span class=o>.</span><span class=na>34</span><span class=o>,</span> <span class=c1>// &#34;beaker&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>42</span><span class=o>,</span> <span class=c1>// &#34;goggle&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>47</span><span class=o>,</span> <span class=c1>// &#34;hammer&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>35</span><span class=o>,</span> <span class=c1>// &#34;kapton_tape&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>60</span><span class=o>,</span> <span class=c1>// &#34;pipette&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>45</span><span class=o>,</span> <span class=c1>// &#34;screwdriver&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>40</span><span class=o>,</span> <span class=c1>// &#34;thermometer&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>40</span><span class=o>,</span> <span class=c1>// &#34;top&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>40</span><span class=o>,</span> <span class=c1>// &#34;watch&#34;
</span><span class=c1></span>        <span class=n>0</span><span class=o>.</span><span class=na>40</span>  <span class=c1>// &#34;wrench&#34;
</span><span class=c1></span><span class=o>}};</span>
</code></pre></td></tr></table></div></div></details><details><summary>非最大抑制制御のソースコード</summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>TemplateMatch</span><span class=o>&gt;</span> <span class=nf>nonMaxSuppression</span><span class=o>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>TemplateMatch</span><span class=o>&gt;</span> <span class=n>matches</span><span class=o>,</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=kd>final</span> <span class=kt>boolean</span> <span class=n>isOverlapDeleted</span><span class=o>)</span> <span class=o>{</span>
    <span class=k>if</span> <span class=o>(</span><span class=n>matches</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>())</span> <span class=k>return</span> <span class=n>matches</span><span class=o>;</span>
    <span class=kt>int</span> <span class=n>template_index</span> <span class=o>=</span> <span class=n>getTemplateIndex</span><span class=o>(</span><span class=n>name</span><span class=o>);</span>


    <span class=kd>final</span> <span class=kt>double</span> <span class=n>_overlapThreshold</span> <span class=o>=</span> <span class=n>isOverlapDeleted</span> <span class=o>?</span> <span class=n>0</span><span class=o>.</span><span class=na>6</span> <span class=o>:</span> <span class=n>0</span><span class=o>.</span><span class=na>3</span><span class=o>;</span> <span class=c1>// PARAMETER
</span><span class=c1></span>

    <span class=c1>// 信頼度に基づいて降順にソート
</span><span class=c1></span>    <span class=n>Collections</span><span class=o>.</span><span class=na>sort</span><span class=o>(</span><span class=n>matches</span><span class=o>,</span> <span class=k>new</span> <span class=n>Comparator</span><span class=o>&lt;</span><span class=n>TemplateMatch</span><span class=o>&gt;()</span> <span class=o>{</span>
        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=kt>int</span> <span class=nf>compare</span><span class=o>(</span><span class=n>TemplateMatch</span> <span class=n>a</span><span class=o>,</span> <span class=n>TemplateMatch</span> <span class=n>b</span><span class=o>)</span> <span class=o>{</span>
            <span class=k>return</span> <span class=n>Double</span><span class=o>.</span><span class=na>compare</span><span class=o>(</span><span class=n>b</span><span class=o>.</span><span class=na>confidence</span><span class=o>,</span> <span class=n>a</span><span class=o>.</span><span class=na>confidence</span><span class=o>);</span>
        <span class=o>}</span>
    <span class=o>});</span>


    <span class=n>List</span><span class=o>&lt;</span><span class=n>TemplateMatch</span><span class=o>&gt;</span> <span class=n>suppressed</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
    <span class=n>Iterator</span><span class=o>&lt;</span><span class=n>TemplateMatch</span><span class=o>&gt;</span> <span class=n>iterator</span> <span class=o>=</span> <span class=n>matches</span><span class=o>.</span><span class=na>iterator</span><span class=o>();</span>


    <span class=k>while</span> <span class=o>(</span><span class=n>iterator</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
        <span class=kd>final</span> <span class=n>TemplateMatch</span> <span class=n>bestMatch</span> <span class=o>=</span> <span class=n>iterator</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>
        <span class=n>iterator</span><span class=o>.</span><span class=na>remove</span><span class=o>();</span>
        <span class=kt>boolean</span> <span class=n>removeBestMatch</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>


        <span class=k>while</span> <span class=o>(</span><span class=n>iterator</span><span class=o>.</span><span class=na>hasNext</span><span class=o>())</span> <span class=o>{</span>
            <span class=n>TemplateMatch</span> <span class=n>next</span> <span class=o>=</span> <span class=n>iterator</span><span class=o>.</span><span class=na>next</span><span class=o>();</span>


            <span class=kt>double</span> <span class=n>overlapThreshold</span> <span class=o>=</span> <span class=n>_overlapThreshold</span><span class=o>;</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>bestMatch</span><span class=o>.</span><span class=na>is_sub_image</span> <span class=o>||</span> <span class=n>next</span><span class=o>.</span><span class=na>is_sub_image</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>overlapThreshold</span> <span class=o>=</span> <span class=n>1</span><span class=o>.</span><span class=na>2</span><span class=o>;</span> <span class=c1>// PARAMETER
</span><span class=c1></span>            <span class=o>}</span>


            <span class=n>TemplateMatch</span> <span class=n>bigger</span> <span class=o>=</span> <span class=n>next</span><span class=o>.</span><span class=na>scale</span> <span class=o>&gt;</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>scale</span> <span class=o>?</span> <span class=n>next</span> <span class=o>:</span> <span class=n>bestMatch</span><span class=o>;</span>
            <span class=kt>double</span> <span class=n>xDiff</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>x</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>x</span><span class=o>);</span>
            <span class=kt>double</span> <span class=n>yDiff</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>y</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>y</span><span class=o>);</span>
            <span class=kt>double</span> <span class=n>xDiff_threshold</span> <span class=o>=</span> <span class=n>getClippedTemplate</span><span class=o>(</span><span class=n>template_index</span><span class=o>,</span> <span class=n>bigger</span><span class=o>.</span><span class=na>angle</span><span class=o>).</span><span class=na>width</span><span class=o>()</span> <span class=o>*</span> <span class=n>bigger</span><span class=o>.</span><span class=na>scale</span> <span class=o>*</span> <span class=n>overlapThreshold</span><span class=o>;</span>
            <span class=kt>double</span> <span class=n>yDiff_threshold</span> <span class=o>=</span> <span class=n>getClippedTemplate</span><span class=o>(</span><span class=n>template_index</span><span class=o>,</span> <span class=n>bigger</span><span class=o>.</span><span class=na>angle</span><span class=o>).</span><span class=na>height</span><span class=o>()</span> <span class=o>*</span> <span class=n>bigger</span><span class=o>.</span><span class=na>scale</span> <span class=o>*</span> <span class=n>overlapThreshold</span><span class=o>;</span>
            <span class=c1>// Log.i(TAG, &#34;xDiff: &#34; + xDiff + &#34;, yDiff: &#34; + yDiff + &#34;, xDiff_threshold: &#34; + xDiff_threshold + &#34;, yDiff_threshold: &#34; + yDiff_threshold);
</span><span class=c1></span>            <span class=kt>boolean</span> <span class=n>isOverlapping</span> <span class=o>=</span> <span class=n>xDiff</span> <span class=o>&lt;</span> <span class=n>xDiff_threshold</span> <span class=o>&amp;&amp;</span> <span class=n>yDiff</span> <span class=o>&lt;</span> <span class=n>yDiff_threshold</span> <span class=o>&amp;&amp;</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>==</span> <span class=n>0</span><span class=o>;</span>


            <span class=c1>// PARAMETER
</span><span class=c1></span>            <span class=k>if</span> <span class=o>(</span><span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;watch&#34;</span><span class=o>)</span> <span class=o>||</span> <span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;goggle&#34;</span><span class=o>)</span> <span class=o>||</span> <span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;wrench&#34;</span><span class=o>)</span> <span class=o>||</span> <span class=n>isOverlapDeleted</span><span class=o>)</span> <span class=o>{</span>
                <span class=c1>// 左右対称な図形は180度回転しても一致しがち
</span><span class=c1></span>                <span class=c1>// 検出したのを削除済みだと180度回転しても一致しがち
</span><span class=c1></span>                <span class=n>isOverlapping</span> <span class=o>=</span> <span class=n>isOverlapping</span> <span class=o>||</span> <span class=o>(</span><span class=n>xDiff</span> <span class=o>&lt;</span> <span class=n>xDiff_threshold</span> <span class=o>&amp;&amp;</span> <span class=n>yDiff</span> <span class=o>&lt;</span> <span class=n>yDiff_threshold</span> <span class=o>&amp;&amp;</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>==</span> <span class=n>180</span><span class=o>);</span>
            <span class=o>}</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;kapton_tape&#34;</span><span class=o>))</span> <span class=o>{</span>
                <span class=c1>// 180度回転して芯が一致しがち
</span><span class=c1></span>                <span class=n>isOverlapping</span> <span class=o>=</span> <span class=n>isOverlapping</span> <span class=o>||</span> <span class=o>(</span><span class=n>xDiff</span> <span class=o>&lt;</span> <span class=n>xDiff_threshold</span> <span class=o>*</span> <span class=n>1</span><span class=o>.</span><span class=na>5</span> <span class=o>&amp;&amp;</span> <span class=n>yDiff</span> <span class=o>&lt;</span> <span class=n>yDiff_threshold</span> <span class=o>*</span> <span class=n>1</span><span class=o>.</span><span class=na>5</span> <span class=o>&amp;&amp;</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>==</span> <span class=n>180</span><span class=o>);</span>
            <span class=o>}</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;pipette&#34;</span><span class=o>)</span> <span class=o>||</span> <span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;screwdriver&#34;</span><span class=o>)</span> <span class=o>||</span> <span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;thermometer&#34;</span><span class=o>))</span> <span class=o>{</span>
                <span class=c1>// 0度or180度でわりとずれてても一致しがち
</span><span class=c1></span>                <span class=n>isOverlapping</span> <span class=o>=</span> <span class=n>isOverlapping</span> <span class=o>||</span> <span class=o>(</span><span class=n>xDiff</span> <span class=o>&lt;</span> <span class=n>xDiff_threshold</span> <span class=o>*</span> <span class=n>2</span><span class=o>.</span><span class=na>5</span> <span class=o>&amp;&amp;</span> <span class=n>yDiff</span> <span class=o>&lt;</span> <span class=n>yDiff_threshold</span> <span class=o>*</span> <span class=n>2</span><span class=o>.</span><span class=na>5</span> <span class=o>&amp;&amp;</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>%</span> <span class=n>180</span> <span class=o>==</span> <span class=n>0</span><span class=o>);</span>
            <span class=o>}</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;beaker&#34;</span><span class=o>))</span> <span class=o>{</span>
                <span class=c1>// 四角形なので90度単位で回転しても一致しがち
</span><span class=c1></span>                <span class=n>isOverlapping</span> <span class=o>=</span> <span class=n>isOverlapping</span> <span class=o>||</span> <span class=o>(</span><span class=n>xDiff</span> <span class=o>&lt;</span> <span class=n>xDiff_threshold</span> <span class=o>*</span> <span class=n>1</span><span class=o>.</span><span class=na>5</span> <span class=o>&amp;&amp;</span> <span class=n>yDiff</span> <span class=o>&lt;</span> <span class=n>yDiff_threshold</span> <span class=o>*</span> <span class=n>1</span><span class=o>.</span><span class=na>5</span> <span class=o>&amp;&amp;</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>%</span> <span class=n>90</span> <span class=o>==</span> <span class=n>0</span><span class=o>);</span>
                <span class=c1>// 横向きの小さいテンプレートの方が一致しがち（同じサイズで重なるのは普通にありうる）
</span><span class=c1></span>                <span class=n>removeBestMatch</span> <span class=o>=</span> <span class=o>(</span><span class=n>xDiff</span> <span class=o>&lt;</span> <span class=n>xDiff_threshold</span> <span class=o>&amp;&amp;</span> <span class=n>yDiff</span> <span class=o>&lt;</span> <span class=n>yDiff_threshold</span> <span class=o>&amp;&amp;</span> <span class=o>(</span><span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>==</span> <span class=n>90</span> <span class=o>||</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>-</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>==</span> <span class=n>270</span><span class=o>))</span> <span class=o>&amp;&amp;</span> <span class=o>(</span><span class=n>1</span><span class=o>.</span><span class=na>06</span> <span class=o>&lt;</span> <span class=n>next</span><span class=o>.</span><span class=na>scale</span> <span class=o>/</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>scale</span><span class=o>)</span> <span class=o>&amp;&amp;</span> <span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>scale</span> <span class=o>/</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>scale</span> <span class=o>&lt;</span> <span class=n>1</span><span class=o>.</span><span class=na>35</span><span class=o>);</span>
            <span class=o>}</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;thermometer&#34;</span><span class=o>))</span> <span class=o>{</span>
                <span class=c1>// 角度が違っても温度計の端の模様が一致しがち
</span><span class=c1></span>                <span class=k>if</span> <span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span> <span class=o>!=</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>)</span> <span class=o>{</span>
                    <span class=kt>double</span> <span class=n>thermometer_height</span> <span class=o>=</span> <span class=n>getClippedTemplate</span><span class=o>(</span><span class=n>template_index</span><span class=o>,</span> <span class=n>0</span><span class=o>).</span><span class=na>height</span><span class=o>();</span>
                    <span class=kt>double</span> <span class=n>thermometer_width</span> <span class=o>=</span> <span class=n>getClippedTemplate</span><span class=o>(</span><span class=n>template_index</span><span class=o>,</span> <span class=n>0</span><span class=o>).</span><span class=na>width</span><span class=o>();</span>
                    <span class=kt>double</span> <span class=n>thermometer_length_next</span> <span class=o>=</span> <span class=n>0</span><span class=o>.</span><span class=na>637</span> <span class=o>*</span> <span class=n>thermometer_height</span> <span class=o>*</span> <span class=n>next</span><span class=o>.</span><span class=na>scale</span> <span class=o>/</span> <span class=n>2</span><span class=o>;</span>
                    <span class=kt>double</span> <span class=n>thermometer_length_best</span> <span class=o>=</span> <span class=n>0</span><span class=o>.</span><span class=na>637</span> <span class=o>*</span> <span class=n>thermometer_height</span> <span class=o>*</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>scale</span> <span class=o>/</span> <span class=n>2</span><span class=o>;</span>
                    <span class=kt>double</span> <span class=n>circle_x_next</span> <span class=o>=</span> <span class=n>next</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>x</span> <span class=o>+</span> <span class=n>Math</span><span class=o>.</span><span class=na>sin</span><span class=o>(</span><span class=n>Math</span><span class=o>.</span><span class=na>toRadians</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span><span class=o>))</span> <span class=o>*</span> <span class=n>thermometer_length_next</span><span class=o>;</span>
                    <span class=kt>double</span> <span class=n>circle_y_next</span> <span class=o>=</span> <span class=n>next</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>y</span> <span class=o>+</span> <span class=n>Math</span><span class=o>.</span><span class=na>cos</span><span class=o>(</span><span class=n>Math</span><span class=o>.</span><span class=na>toRadians</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>angle</span><span class=o>))</span> <span class=o>*</span> <span class=n>thermometer_length_next</span><span class=o>;</span>
                    <span class=kt>double</span> <span class=n>circle_x_best</span> <span class=o>=</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>x</span> <span class=o>+</span> <span class=n>Math</span><span class=o>.</span><span class=na>sin</span><span class=o>(</span><span class=n>Math</span><span class=o>.</span><span class=na>toRadians</span><span class=o>(</span><span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>))</span> <span class=o>*</span> <span class=n>thermometer_length_best</span><span class=o>;</span>
                    <span class=kt>double</span> <span class=n>circle_y_best</span> <span class=o>=</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>center</span><span class=o>.</span><span class=na>y</span> <span class=o>+</span> <span class=n>Math</span><span class=o>.</span><span class=na>cos</span><span class=o>(</span><span class=n>Math</span><span class=o>.</span><span class=na>toRadians</span><span class=o>(</span><span class=n>bestMatch</span><span class=o>.</span><span class=na>angle</span><span class=o>))</span> <span class=o>*</span> <span class=n>thermometer_length_best</span><span class=o>;</span>
                    <span class=c1>// Log.i(TAG, &#34;circle_x_next: &#34; + circle_x_next + &#34;, circle_y_next: &#34; + circle_y_next + &#34;, circle_x_best: &#34; + circle_x_best + &#34;, circle_y_best: &#34; + circle_y_best);
</span><span class=c1></span>                    <span class=kt>double</span> <span class=n>circle_x_diff</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>circle_x_next</span> <span class=o>-</span> <span class=n>circle_x_best</span><span class=o>);</span>
                    <span class=kt>double</span> <span class=n>circle_y_diff</span> <span class=o>=</span> <span class=n>Math</span><span class=o>.</span><span class=na>abs</span><span class=o>(</span><span class=n>circle_y_next</span> <span class=o>-</span> <span class=n>circle_y_best</span><span class=o>);</span>
                    <span class=kt>double</span> <span class=n>Diff_threshold</span> <span class=o>=</span> <span class=n>0</span><span class=o>.</span><span class=na>5</span> <span class=o>*</span> <span class=n>thermometer_width</span> <span class=o>*</span> <span class=n>Math</span><span class=o>.</span><span class=na>max</span><span class=o>(</span><span class=n>next</span><span class=o>.</span><span class=na>scale</span><span class=o>,</span> <span class=n>bestMatch</span><span class=o>.</span><span class=na>scale</span><span class=o>);</span>
                    <span class=c1>// Log.i(TAG, &#34;circle_x_diff: &#34; + circle_x_diff + &#34;, circle_y_diff: &#34; + circle_y_diff + &#34;, Diff_threshold: &#34; + Diff_threshold);
</span><span class=c1></span>                    <span class=kt>boolean</span> <span class=n>circle_overlapping</span> <span class=o>=</span> <span class=n>circle_x_diff</span> <span class=o>&lt;</span> <span class=n>Diff_threshold</span> <span class=o>&amp;&amp;</span> <span class=n>circle_y_diff</span> <span class=o>&lt;</span> <span class=n>Diff_threshold</span><span class=o>;</span>
                    <span class=n>isOverlapping</span> <span class=o>=</span> <span class=n>isOverlapping</span> <span class=o>||</span> <span class=n>circle_overlapping</span><span class=o>;</span>
                <span class=o>}</span>
            <span class=o>}</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>name</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;wrench&#34;</span><span class=o>)</span> <span class=o>&amp;&amp;</span> <span class=o>(</span><span class=n>bestMatch</span><span class=o>.</span><span class=na>is_sub_image</span> <span class=o>||</span> <span class=n>next</span><span class=o>.</span><span class=na>is_sub_image</span><span class=o>))</span> <span class=o>{</span>
                <span class=c1>// 向きにかかわらず一致しがち
</span><span class=c1></span>                <span class=n>isOverlapping</span> <span class=o>=</span> <span class=n>isOverlapping</span> <span class=o>||</span> <span class=o>(</span><span class=n>xDiff</span> <span class=o>&lt;</span> <span class=n>xDiff_threshold</span> <span class=o>&amp;&amp;</span> <span class=n>yDiff</span> <span class=o>&lt;</span> <span class=n>yDiff_threshold</span><span class=o>);</span>
            <span class=o>}</span>


            <span class=k>if</span> <span class=o>(</span><span class=n>removeBestMatch</span><span class=o>)</span> <span class=o>{</span>
                <span class=k>break</span><span class=o>;</span>
            <span class=o>}</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>isOverlapping</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>iterator</span><span class=o>.</span><span class=na>remove</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>


        <span class=k>if</span> <span class=o>(!</span><span class=n>removeBestMatch</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>suppressed</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>bestMatch</span><span class=o>);</span>
        <span class=o>}</span>


        <span class=c1>// Reset the iterator to the beginning of the list for the next round of checks
</span><span class=c1></span>        <span class=n>iterator</span> <span class=o>=</span> <span class=n>matches</span><span class=o>.</span><span class=na>iterator</span><span class=o>();</span>
    <span class=o>}</span>
    <span class=k>return</span> <span class=n>suppressed</span><span class=o>;</span>
<span class=o>}</span>
</code></pre></td></tr></table></div></div></details><h5 id=機械学習>機械学習</h5><p>機械学習にはTensor Flow Liteを使用しました．</p><p>Pythonで学習データセットを生成し，Tensor Flowの事前トレーニング済みモデルに対するファインチューニングをPythonで行い，モデルファイルを生成，これをもとにAstrobee上で動作するJavaプログラムを作成しました．という流れです．</p><p>Kibo-RPCでは、プログラミングマニュアルで<code>tensorflow-lite-task-vision:0.4.0</code>を使うことが推奨されています。<br>これはTensorFlow Lite Task VisionはTensorFlow Liteの画像処理用のAPIで、画像分類・物体検出・セグメンテーションなど用途に合わせた事前トレーニング済みモデルを使用できます。<br>今回はこの中のObject Detectorを使用しました。</p><ul><li><a href=https://www.tensorflow.org/lite/api_docs/python/tflite_support/task/vision>https://www.tensorflow.org/lite/api_docs/python/tflite_support/task/vision</a></li><li><a href=https://www.tensorflow.org/lite/api_docs/python/tflite_support/task/vision/ObjectDetector>https://www.tensorflow.org/lite/api_docs/python/tflite_support/task/vision/ObjectDetector</a></li></ul><p>事前トレーニング済みモデルに対して、自分のデータを使ってファインチューニングを行うためのツールがTensorFlow Lite Model Makerです。</p><ul><li><a href=https://www.tensorflow.org/lite/api_docs/python/tflite_model_maker>https://www.tensorflow.org/lite/api_docs/python/tflite_model_maker</a></li><li><a href=https://www.tensorflow.org/lite/api_docs/python/tflite_model_maker/object_detector>https://www.tensorflow.org/lite/api_docs/python/tflite_model_maker/object_detector</a></li></ul><p>Pythonによる学習は以下のように行います。</p><ul><li><a href=https://www.tensorflow.org/lite/models/modify/model_maker/object_detection>https://www.tensorflow.org/lite/models/modify/model_maker/object_detection</a></li><li><a href=https://github.com/tensorflow/examples/tree/master/tensorflow_examples/lite/model_maker>https://github.com/tensorflow/examples/tree/master/tensorflow_examples/lite/model_maker</a></li><li><a href=https://github.com/tensorflow/examples/blob/master/tensorflow_examples/lite/model_maker/requirements.txt>https://github.com/tensorflow/examples/blob/master/tensorflow_examples/lite/model_maker/requirements.txt</a></li></ul><p>モデルは以下の中から選択します。</p><ul><li><a href=https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md>https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md</a></li></ul><p>訓練データは以下のように用意します。</p><ul><li><a href="https://cloud.google.com/vision/automl/object-detection/docs/prepare?hl=ja">https://cloud.google.com/vision/automl/object-detection/docs/prepare?hl=ja</a></li></ul><p><img src=/images/blog/kibo-rpc/train.jpg alt loading=lazy>
<center>↑学習データ生成に用いたアイテム画像</center></p><p>Androidアプリでの推論は以下のように行います。</p><ul><li><p><a href="https://www.tensorflow.org/lite/inference_with_metadata/task_library/object_detector?hl=ja">https://www.tensorflow.org/lite/inference_with_metadata/task_library/object_detector?hl=ja</a></p></li><li><p><a href="https://www.tensorflow.org/lite/api_docs/java/org/tensorflow/lite/task/vision/detector/package-summary?hl=ja">https://www.tensorflow.org/lite/api_docs/java/org/tensorflow/lite/task/vision/detector/package-summary?hl=ja</a></p></li><li><p><a href="https://www.tensorflow.org/lite/examples/object_detection/overview?hl=ja">https://www.tensorflow.org/lite/examples/object_detection/overview?hl=ja</a></p></li></ul><h3 id=テストフレームワーク>テストフレームワーク</h3><h4 id=オンラインシミュレーターの自動実行>オンラインシミュレーターの自動実行</h4><p>Kibo-RPCのシミュレータは、ビルドしたAPKファイルをブラウザでアップロードすることで実行します。Astrobeeの基盤はROSであり、シミュレータはサーバー内のROSのシミュレータで動いています。ローカルでシミュレータを動かすこともできますが、画像や航法誤差のランダム要素と採点機能がないため、オンラインシミュレーターでの実行が必要です。</p><p>画像処理アルゴリズムを評価したり確率的に発生するバグを見つけたりするには大量にシミュレーションを行う必要がありますが、1回のシミュレーションに10～15分程度かかることもあり、手作業でシミュレーターを実行するのは現実的ではありません。直接シミュレータを操作するAPIは提供されていないため、RPA（Robotic Process Automation）ツールのPower Automateによりブラウザの操作を自動化しました。</p><p>Power Automateにはレコーダーという機能があり、ブラウザの操作を記録して再現することができます。手動操作を記録したうえでループやスクリーンショット等の操作を追加してフローを作成することにより、シミュレーションの自動実行を実現しました。</p><p><img src=/images/blog/kibo-rpc/RPA.png alt loading=lazy></p><h4 id=画像処理の単体テスト>画像処理の単体テスト</h4><p>Android InstrumentationTest</p><h4 id=シーケンスのテスト>シーケンスのテスト</h4><h3 id=マルチスレッド>マルチスレッド</h3><h3 id=誘導>誘導</h3><p>位置姿勢など状態を推定する航法システム、経路決定を行う誘導システム、目標の状態に近づける制御システムのうち、航法と制御はAPIで提供されてますが、誘導は自前で実装する必要があります。また、精密な制御を行うため、APIの制御システムの外側でさらに制御を行います。</p><h4 id=経路設計>経路設計</h4><h4 id=精密制御>精密制御</h4><h2 id=本選>本選</h2><h3 id=実機画質評価>実機画質評価</h3><h3 id=実機処理時間評価>実機処理時間評価</h3><h3 id=実機制御評価>実機制御評価</h3><h3 id=実際の実装スケジュール>実際の実装スケジュール</h3><h2 id=反省>反省</h2><h3 id=予選-1>予選</h3><p>勝利要因</p><ul><li>テストの自動化<blockquote class=twitter-tweet><p lang=ja dir=ltr>開発体験と検証をとにかく大事にする精神がArkEgdeで染み付いてたおかげで勝てたな<br>シミュレーションの自動実行化と画像認識単体テストの環境構築を諦めてたら負けてた</p>&mdash; 8bitマイコン (@771_8bit) <a href="https://twitter.com/771_8bit/status/1807031194472833495?ref_src=twsrc%5Etfw">June 29, 2024</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script>ArkEdge SpaceがArkE**gd**eになってるのはさておき，これは</li><li>膨大なデータセットとテンプレートマッチングの閾値・非最大制御ロジックの職人芸</li><li>爆速経路</li></ul><h3 id=本選-1>本選</h3><h2 id=headings>Headings</h2><p>The following HTML <code>&lt;h1></code>—<code>&lt;h6></code> elements represent six levels of section headings. <code>&lt;h1></code> is the highest section level while <code>&lt;h6></code> is the lowest.</p><h1 id=h1>H1</h1><h2 id=h2>H2</h2><h3 id=h3>H3</h3><h4 id=h4>H4</h4><h5 id=h5>H5</h5><h6 id=h6>H6</h6><h2 id=paragraph>Paragraph</h2><p>Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.</p><p>Itatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.</p><h2 id=blockquotes>Blockquotes</h2><p>The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a <code>footer</code> or <code>cite</code> element, and optionally with in-line changes such as annotations and abbreviations.</p><h4 id=blockquote-without-attribution>Blockquote without attribution</h4><blockquote><p>Tiam, ad mint andaepu dandae nostion secatur sequo quae.<br><strong>Note</strong> that you can use <em>Markdown syntax</em> within a blockquote.</p></blockquote><h4 id=blockquote-with-attribution>Blockquote with attribution</h4><blockquote><p>Don&rsquo;t communicate by sharing memory, share memory by communicating.</p><br>— <cite>Rob Pike<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></cite></p></blockquote><h2 id=tables>Tables</h2><p>Tables aren&rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.</p><table><thead><tr><th>Name</th><th>Age</th></tr></thead><tbody><tr><td>Bob</td><td>27</td></tr><tr><td>Alice</td><td>23</td></tr></tbody></table><h4 id=inline-markdown-within-tables>Inline Markdown within tables</h4><table><thead><tr><th>Inline   </th><th>Markdown   </th><th>In   </th><th>Table</th></tr></thead><tbody><tr><td><em>italics</em></td><td><strong>bold</strong></td><td><del>strikethrough</del>   </td><td><code>code</code></td></tr></tbody></table><h2 id=code-blocks>Code Blocks</h2><h4 id=code-block-with-backticks>Code block with backticks</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>html
&lt;!DOCTYPE html&gt;
&lt;html lang=&#34;en&#34;&gt;
&lt;head&gt;
  &lt;meta charset=&#34;UTF-8&#34;&gt;
  &lt;title&gt;Example HTML5 Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;p&gt;Test&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></td></tr></table></div></div><h4 id=code-block-indented-with-four-spaces>Code block indented with four spaces</h4><pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;Example HTML5 Document&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;p&gt;Test&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h4 id=code-block-with-hugos-internal-highlight-shortcode>Code block with Hugo&rsquo;s internal highlight shortcode</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=cp>&lt;!DOCTYPE html&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Example HTML5 Document<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Test<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span></code></pre></td></tr></table></div></div><h2 id=list-types>List Types</h2><h4 id=ordered-list>Ordered List</h4><ol><li>First item</li><li>Second item</li><li>Third item</li></ol><h4 id=unordered-list>Unordered List</h4><ul><li>List item</li><li>Another item</li><li>And another item</li></ul><h4 id=nested-list>Nested list</h4><ul><li>Item</li></ul><ol><li>First Sub-item</li><li>Second Sub-item</li></ol><h2 id=other-elements--abbr-sub-sup-kbd-mark>Other Elements — abbr, sub, sup, kbd, mark</h2><p><abbr title="Graphics Interchange Format">GIF</abbr> is a bitmap image format.</p><p>H<sub>2</sub>O</p><p>X<sup>n</sup> + Y<sup>n</sup>: Z<sup>n</sup></p><p>Press <kbd><kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>Delete</kbd></kbd> to end the session.</p><p>Most <mark>salamanders</mark> are nocturnal, and hunt for insects, worms, and other small creatures.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>The above quote is excerpted from Rob Pike&rsquo;s <a href="https://www.youtube.com/watch?v=PAAkCSZUG1c">talk</a> during Gopherfest, November 18, 2015. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><script defer src=/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js></script><script defer src=/js/helper/prev.min.js></script><script defer src=/js/helper/prop.min.js></script><script>'use strict';document.addEventListener('DOMContentLoaded',function(){var clipInit=false;var preChromaElem=document.querySelectorAll('pre.chroma');var langCodeElem=document.querySelectorAll('.language-code');var dollarCodeElem=document.querySelectorAll('div.language-\\$');var gtCodeElem=document.querySelectorAll('div.language-\\>');var makeClipboard=function(elem){var code=elem,text=elem.textContent;if(text.length>15){if(!clipInit){var text,clip=new ClipboardJS('.copy-to-clipboard',{text:function(trigger){var codeElem=prev(trigger).querySelectorAll('code');if(codeElem.length>1){text=prev(trigger).querySelector('code[class^="language-"]').textContent;}else{text=prev(trigger).querySelector('code').textContent;}
return text.replace(/^\$\s/gm,'');}});var inPre;clip.on('success',function(e){e.clearSelection();inPre=prop(e.trigger.parentNode,'tagName')=='PRE';e.trigger.setAttribute('aria-label','Copied to clipboard!');e.trigger.classList.add('tooltipped');e.trigger.classList.add('tooltipped-w');});clip.on('error',function(e){inPre=prop(e.trigger.parentNode,'tagName')=='PRE';e.trigger.setAttribute('aria-label',e.action.toString());e.trigger.classList.add('tooltipped');e.trigger.classList.add('tooltipped-w');});clipInit=true;}
var notAllowedClass=['language-mermaid','language-viz','language-wave','language-chart','language-msc','language-flowchart'];var isNotAllowedIncluded=false;var curClassName=code.getAttribute('class');for(var i=0;i<notAllowedClass.length;i++){if(curClassName&&curClassName.startsWith(notAllowedClass[i])){isNotAllowedIncluded=true;break;}}
if(!isNotAllowedIncluded){if(curClassName){var newClipboardElem=document.createElement('span');newClipboardElem.setAttribute('class','copy-to-clipboard');newClipboardElem.setAttribute('title','Copy to clipboard');elem.parentNode.parentNode.insertBefore(newClipboardElem,elem.parentNode.nextElementSibling);}}}}
var makeSymbolClipboard=function(elem){var clipboardSpan=document.createElement('span');clipboardSpan.setAttribute('class','copy-to-clipboard');clipboardSpan.setAttribute('title','Copy to clipboard');elem.parentNode.parentNode.insertBefore(clipboardSpan,elem.parentNode.nextElementSibling);}
preChromaElem?preChromaElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeClipboard(codeElem);});}):null;langCodeElem?langCodeElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeClipboard(codeElem);});}):null;dollarCodeElem?dollarCodeElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeSymbolClipboard(codeElem);});}):null;gtCodeElem?gtCodeElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeSymbolClipboard(codeElem);});}):null;});</script><script>'use strict';function wrap(el,wrapper){el.parentNode.insertBefore(wrapper,el);wrapper.appendChild(el);}
(function(){var singleContentsElem=document.querySelector('.single__contents');singleContentsElem?singleContentsElem.querySelectorAll('pre > code').forEach(function(elem){var dataLang=elem.getAttribute('data-lang');var dataLangWrapper=document.createElement('div');var code=null;var codeTitle=null;if(dataLang&&dataLang.includes(':')){code=dataLang.split(':')[0];codeTitle=dataLang.split(':')[1];dataLangWrapper.className='language-'+code;dataLangWrapper.setAttribute('data-lang',codeTitle);elem.className='language-'+code;elem.setAttribute('data-lang',codeTitle);elem.setAttribute('id',codeTitle);}else if(!dataLang){dataLangWrapper.setAttribute('data-lang','Code');dataLangWrapper.className='language-code';}
if(!dataLang||codeTitle){wrap(elem.parentNode,dataLangWrapper);}}):null;})();var langCodeElem=document.querySelectorAll('.language-code');langCodeElem?langCodeElem.forEach(function(elem){var newElem=document.createElement('span');newElem.className='copy-to-clipboard';newElem.setAttribute('title','Copy to clipboard');elem.append(newElem);}):null;var dollarCodeElem=document.querySelectorAll('div.language-\\$');var gtCodeElem=document.querySelectorAll('div.language-\\>');dollarCodeElem?dollarCodeElem.forEach(function(elem){var lnts=elem.parentNode.parentNode?elem.parentNode.parentNode.querySelectorAll('.lnt'):null;lnts?lnts.forEach(function(lnt){lnt.innerHTML='$<br/>';}):null;}):null;gtCodeElem?gtCodeElem.forEach(function(elem){var lnts=elem.parentNode.parentNode?elem.parentNode.parentNode.querySelectorAll('.lnt'):null;lnts?lnts.forEach(function(lnt){lnt.innerHTML='><br/>';}):null;}):null;</script><div class=whoami__gutter></div><hr class="hr-slash whoami-hr"><section class=whoami><div class=whoami__image-wrapper><img data-src=/images/whoami/avatar.jpg src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDI0djI0SDBWMHoiLz48cGF0aCBmaWxsPSIjYWFhIiBkPSJNMTkgM0g1Yy0xLjEuMC0yIC45LTIgMnYxNGMwIDEuMS45IDIgMiAyaDE0YzEuMS4wIDItLjkgMi0yVjVjMC0xLjEtLjktMi0yLTJ6bS0xIDE2SDZjLS41NS4wLTEtLjQ1LTEtMVY2YzAtLjU1LjQ1LTEgMS0xaDEyYy41NS4wIDEgLjQ1IDEgMXYxMmMwIC41NS0uNDUgMS0xIDF6bS00LjQ0LTYuMTktMi4zNSAzLjAyLTEuNTYtMS44OGMtLjItLjI1LS41OC0uMjQtLjc4LjAxbC0xLjc0IDIuMjNjLS4yNi4zMy0uMDIuODEuMzkuODFoOC45OGMuNDEuMC42NS0uNDcuNC0uOGwtMi41NS0zLjM5Yy0uMTktLjI2LS41OS0uMjYtLjc5LjB6Ii8+PC9zdmc+ alt=8bitマイコン class="lazyload whoami__image"></div><div class=whoami__contents><div class=whoami__written-by>著者</div><div class=whoami__title>8bitマイコン</div><div class=whoami__desc>組み込み周りで遊ぶ宇宙好き</div><div class=whoami__social><a href=https://github.com/771-8bit title=github aria-label=github><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24"><g id="surface3680"><path fill="currentcolor" d="M10.898438 2.101562C6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 8.699219 21.398438 9 21.199219 9 20.800781V19.199219S8.601562 19.300781 8.101562 19.300781C6.699219 19.300781 6.101562 18.101562 6 17.398438 5.898438 17 5.699219 16.699219 5.398438 16.398438 5.101562 16.300781 5 16.300781 5 16.199219 5 16 5.300781 16 5.398438 16 6 16 6.5 16.699219 6.699219 17 7.199219 17.800781 7.800781 18 8.101562 18 8.5 18 8.800781 17.898438 9 17.800781 9.101562 17.101562 9.398438 16.398438 10 16 7.699219 15.5 6 14.199219 6 12 6 10.898438 6.5 9.800781 7.199219 9 7.101562 8.800781 7 8.300781 7 7.601562 7 7.199219 7 6.601562 7.300781 6 7.300781 6 8.699219 6 10.101562 7.300781 10.601562 7.101562 11.300781 7 12 7S13.398438 7.101562 14 7.300781C15.300781 6 16.800781 6 16.800781 6 17 6.601562 17 7.199219 17 7.601562 17 8.398438 16.898438 8.800781 16.800781 9 17.5 9.800781 18 10.800781 18 12 18 14.199219 16.300781 15.5 14 16 14.601562 16.5 15 17.398438 15 18.300781V20.898438C15 21.199219 15.300781 21.5 15.699219 21.398438 19.398438 19.898438 22 16.300781 22 12.101562 22 6.101562 16.898438 1.398438 10.898438 2.101562zm0 0"/></g></svg></a><a href=https://twitter.com/771_8bit title=twitter aria-label=twitter><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32"><g id="surface676"><path fill="currentcolor" d="M28 8.558594C27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 5.246094 7.875 5.003906 8.722656 5.003906 9.625 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469c0 .023437000000001262.0.042969000000001145.0.0625C4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 4.777344 23.609375 4.386719 23.585938 4 23.539062 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 26.503906 10.410156 27.339844 9.542969 28 8.558594zm0 0"/></g></svg></a></div></div></section><hr class="hr-slash whoami-hr"><section class=related></section><div class=grow></div><nav class=pagination-single><div class=grow></div></nav><div class="modal micromodal-slide" id=modal aria-hidden=true><div class=modal__overlay tabindex=-1 data-micromodal-close><div class=modal__container role=dialog aria-modal=true aria-labelledby=modal-title><div class=modal__content id=modal-content><div id=mySwipe class=swipe><div class=swipe-wrap></div></div></div><span class=modal__items><span class=modal__header><div class=modal__paging title="Page Info" aria-label="Current Page"></div><div class="modal__icon modal__toolbar modal__toolbar--close" title=Close aria-label="Close Button" data-micromodal-close><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentcolor" d="M21.734375 19.640625 19.636719 21.734375C19.253906 22.121094 18.628906 22.121094 18.242188 21.734375L13 16.496094 7.761719 21.734375C7.375 22.121094 6.746094 22.121094 6.363281 21.734375L4.265625 19.640625C3.878906 19.253906 3.878906 18.628906 4.265625 18.242188L9.503906 13 4.265625 7.761719C3.882813 7.371094 3.882813 6.742188 4.265625 6.363281L6.363281 4.265625C6.746094 3.878906 7.375 3.878906 7.761719 4.265625L13 9.507813 18.242188 4.265625C18.628906 3.878906 19.257813 3.878906 19.636719 4.265625L21.734375 6.359375C22.121094 6.746094 22.121094 7.375 21.738281 7.761719L16.496094 13 21.734375 18.242188C22.121094 18.628906 22.121094 19.253906 21.734375 19.640625z"/></svg></div><div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentcolor" d="M5 3C3.9069372 3 3 3.9069372 3 5V8A1.0001 1.0001.0 105 8V5H8A1.0001 1.0001.0 108 3H5zM16 3a1.0001 1.0001.0 100 2h3V8a1.0001 1.0001.0 102 0V5C21 3.9069372 20.093063 3 19 3H16zM3.984375 14.986328A1.0001 1.0001.0 003 16v3C3 20.093063 3.9069372 21 5 21H8a1.0001 1.0001.0 100-2H5V16A1.0001 1.0001.0 003.984375 14.986328zm16 0A1.0001 1.0001.0 0019 16v3H16a1.0001 1.0001.0 100 2h3C20.093063 21 21 20.093063 21 19V16A1.0001 1.0001.0 0019.984375 14.986328z"/></svg></div><div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentcolor" d="M16.96875 4.972656C15.867188 4.988281 14.984375 5.894531 15 7v8H7C6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 5.609375 18.632813 6.277344 19.011719 7 19H19V7C19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656zm16 0C31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 31 6.90625 31 6.953125 31 7V19H43C43.066406 19 43.132813 19 43.199219 18.992188 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 44.964844 15.828125 44.074219 14.988281 43 15H35V7C35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656zM7 31C6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 5.609375 34.632813 6.277344 35.011719 7 35h8v8C14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 18.632813 44.390625 19.011719 43.722656 19 43V31zm24 0V43C30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 34.632813 44.390625 35.011719 43.722656 35 43V35h8C43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 44.390625 31.367188 43.722656 30.988281 43 31z"/></svg></div></span><div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentcolor" d="M23.28125 11 10 10V6.851563C10 6.523438 9.839844 6.277344 9.519531 6.03125 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 2.003906 12.980469 2 12.988281 2 12.992188 2 13.15625 2.078125 13.402344 2.160156 13.484375 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 9.839844 19.722656 10 19.476563 10 19.148438V16l13.28125-1C23.679688 14.679688 24 13.875 24 12.992188 24 12.195313 23.761719 11.320313 23.28125 11z"/></svg></div><div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentcolor" d="M2.71875 11.023438l13.28125-1V6.875C16 6.546875 16.160156 6.300781 16.480469 6.054688 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 23.917969 12.601563 23.992188 12.835938 23.996094 13 23.996094 13.003906 24 13.011719 24 13.015625 24 13.179688 23.921875 13.425781 23.839844 13.507813 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 16.160156 19.746094 16 19.5 16 19.171875V16.023438L2.71875 15.023438C2.320313 14.703125 2 13.898438 2 13.015625 2 12.21875 2.238281 11.34375 2.71875 11.023438z"/></svg></div><div class=modal__caption><div class=modal__caption--text></div></div></span></div></div></div><script defer src=/js/swipe.min.b4b82839155519d9ca67746615a4c86ccbc1061c196fe6d8aa26e4fe22902718.js></script><script defer src=/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js></script><script defer src=/js/helper/fadeinout.min.js></script><script>document.addEventListener('DOMContentLoaded',function(){var docElem=document.documentElement;function openFullscreen(){if(docElem.requestFullscreen){docElem.requestFullscreen();}else if(docElem.mozRequestFullScreen){docElem.mozRequestFullScreen();}else if(docElem.webkitRequestFullscreen){docElem.webkitRequestFullscreen();}else if(docElem.msRequestFullscreen){docElem.msRequestFullscreen();}}
function closeFullscreen(){if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement){if(document.exitFullscreen){document.exitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitExitFullscreen){document.webkitExitFullscreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}}}
var modal=document.getElementById('modal');var galleryContainerElem=document.querySelector('.gallery__container');var swipeWrapElem=document.querySelector('.swipe-wrap');var mySwipeElem=document.getElementById('mySwipe');var arrowLeftElem=document.querySelector('.modal__arrow--left');var arrowRightElem=document.querySelector('.modal__arrow--right');var closeElem=document.querySelector('.modal__toolbar--close');var fullElem=document.querySelector('.modal__toolbar--full');var normalElem=document.querySelector('.modal__toolbar--normal');var captionElem=document.querySelector('.modal__caption');var pagingElem=document.querySelector('.modal__paging');var itemsElem=document.querySelector('.modal__items');var imgTotalNum=null;var myFadeTimeout=null;var mySwipe=null;var keydownFunction=function(e){if(e.key==='ArrowRight'){if(modal&&modal.classList.contains('is-open')){mySwipe.next();}}else if(e.key==='ArrowLeft'){if(modal&&modal.classList.contains('is-open')){mySwipe.prev();}}}
if(galleryContainerElem){imgTotalNum=galleryContainerElem.querySelectorAll('img').length;}else{galleryContainerElem=document.querySelector('.single__contents');imgTotalNum=galleryContainerElem.querySelectorAll('img').length;}
MicroModal.init({onClose:function(){if(mySwipe){mySwipe.kill();mySwipe=null;closeFullscreen();}
window.removeEventListener('keydown',keydownFunction);},disableScroll:true,disableFocus:true,awaitOpenAnimation:false,awaitCloseAnimation:false,debugMode:false,});var imageLoad=function(src){return new Promise(function(resolve,reject){var newImg=new Image;newImg.onload=function(){resolve(newImg);}
newImg.onerror=reject;newImg.src=src;});}
galleryContainerElem.querySelectorAll('img').forEach(function(elem,idx){elem.style.cursor='pointer';var clonedElem=elem.cloneNode(true);clonedElem.style.maxHeight='100%';clonedElem.style.maxWidth='100%';clonedElem.onclick=function(e){e.stopPropagation();}
var wrapper=document.createElement('div');wrapper.style.width='100%';wrapper.style.height='100vh';wrapper.setAttribute('data-micromodal-close','');wrapper.onclick=function(){if(mySwipe){mySwipe.kill();mySwipe=null;}}
wrapper.onmouseenter=function(){clearTimeout(myFadeTimeout);fadeIn(itemsElem,200);};wrapper.onmouseleave=function(){myFadeTimeout=setTimeout(function(){fadeOut(itemsElem,200);},2500);}
wrapper.ontouchstart=function(){fadeIn(itemsElem,200);}
wrapper.append(clonedElem);swipeWrapElem.append(wrapper);elem.addEventListener('click',async function(e){MicroModal.show('modal');if(mySwipe){mySwipe.kill();mySwipe=null;}
var imgSrc=e.target.getAttribute('data-src')||e.target.getAttribute('src');var img=await imageLoad(imgSrc);clonedElem.style.width=img.width+'px';clonedElem.style.height=img.height+'px';mySwipe=new Swipe(mySwipeElem,{startSlide:idx,draggable:true,autoRestart:false,continuous:false,disableScroll:true,stopPropagation:true,callback:async function(index,element){var imgElem=element.querySelector('img');var imgSrc=imgElem.getAttribute('data-src')||imgElem.getAttribute('src');var img=await imageLoad(imgSrc);imgElem.style.width=img.width+'px';imgElem.style.height=img.height+'px';if(captionElem&&imgElem){var caption=null;if(imgElem.getAttribute('data-caption')){caption=imgElem.getAttribute('data-caption');}else if(imgElem.getAttribute('title')){caption=imgElem.getAttribute('title');}else if(imgElem.getAttribute('alt')){caption=imgElem.getAttribute('alt');}else{caption=imgElem.getAttribute('src');}
captionElem.querySelector('.modal__caption--text').innerText=caption;pagingElem.innerText=(index+1)+' / '+imgTotalNum;clearTimeout(myFadeTimeout);fadeIn(itemsElem,200);}},});fadeIn(itemsElem);if(captionElem){var caption=null;if(e.target.getAttribute('data-caption')){caption=e.target.getAttribute('data-caption');}else if(e.target.getAttribute('title')){caption=e.target.getAttribute('title');}else if(e.target.getAttribute('alt')){caption=e.target.getAttribute('alt');}else{caption=e.target.getAttribute('src');}
captionElem.querySelector('.modal__caption--text').innerText=caption;pagingElem.innerText=(idx+1)+' / '+imgTotalNum;}
if(normalElem&&fullElem){normalElem.style.zIndex=-1;normalElem.style.opacity=0;fullElem.style.zIndex=25;fullElem.style.opacity=1;}});window.addEventListener('keydown',keydownFunction);});arrowLeftElem?arrowLeftElem.addEventListener('click',function(e){if(mySwipe){mySwipe.prev();}}):null;arrowRightElem?arrowRightElem.addEventListener('click',function(e){if(mySwipe){mySwipe.next();}}):null;closeElem?closeElem.addEventListener('click',function(){if(mySwipe){mySwipe.kill();mySwipe=null;}
closeFullscreen();MicroModal.close('modal');}):null;fullElem?fullElem.addEventListener('click',function(e){openFullscreen();if(normalElem){normalElem.style.zIndex=25;normalElem.style.opacity=1;fullElem.style.zIndex=-1;fullElem.style.opacity=0;}}):null;normalElem?normalElem.addEventListener('click',function(e){closeFullscreen();if(fullElem){fullElem.style.zIndex=25;fullElem.style.opacity=1;normalElem.style.zIndex=-1;normalElem.style.opacity=0;}}):null;});</script><div class=hide><div class=search><span class=icon><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49.0s.41-1.08.0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></span><input id=search aria-label="Site Search" class=input type=text placeholder=検索 autocomplete=off><div id=search-results class=dropdown><div id=search-menu class=dropdown-menu role=menu></div></div></div></div></div></main><aside class="single__side main-side"><section class="sidebar hide"><script>document.querySelector('.sidebar').classList.remove('hide')</script><div class=toc__flexbox data-position=fixed><h6 class=toc__title data-ani=true>目次</h6><label class=switch data-ani=true><input id=toggle-toc aria-label="Toggle TOC" type=checkbox checked>
<span class="slider round"></span></label></div><div class=toc data-dir=ltr data-folding=false data-ani=true><nav id=TableOfContents><ul><li><a href=#kibo-rpcとは>Kibo-RPCとは</a></li><li><a href=#大会ルール>大会ルール</a></li><li><a href=#チーム構成>チーム構成</a></li><li><a href=#マネジメント>マネジメント</a><ul><li><a href=#コミュニケーション>コミュニケーション</a></li><li><a href=#スケジュール管理>スケジュール管理</a></li><li><a href=#タスク分担>タスク分担</a></li><li><a href=#ドキュメント>ドキュメント</a></li></ul></li><li><a href=#ソフトウェア>ソフトウェア</a><ul><li><a href=#ルール詳細>ルール詳細</a></li><li><a href=#シーケンス>シーケンス</a><ul><li><a href=#予選>予選</a></li><li><a href=#決勝>決勝</a></li></ul></li><li><a href=#画像認識>画像認識</a><ul><li><a href=#エリアの抽出>エリアの抽出</a></li><li><a href=#二値化>二値化</a></li><li><a href=#アイテム認識>アイテム認識</a></li></ul></li><li><a href=#テストフレームワーク>テストフレームワーク</a><ul><li><a href=#オンラインシミュレーターの自動実行>オンラインシミュレーターの自動実行</a></li><li><a href=#画像処理の単体テスト>画像処理の単体テスト</a></li><li><a href=#シーケンスのテスト>シーケンスのテスト</a></li></ul></li><li><a href=#マルチスレッド>マルチスレッド</a></li><li><a href=#誘導>誘導</a><ul><li><a href=#経路設計>経路設計</a></li><li><a href=#精密制御>精密制御</a></li></ul></li></ul></li><li><a href=#本選>本選</a><ul><li><a href=#実機画質評価>実機画質評価</a></li><li><a href=#実機処理時間評価>実機処理時間評価</a></li><li><a href=#実機制御評価>実機制御評価</a></li><li><a href=#実際の実装スケジュール>実際の実装スケジュール</a></li></ul></li><li><a href=#反省>反省</a><ul><li><a href=#予選-1>予選</a></li><li><a href=#本選-1>本選</a></li></ul></li><li><a href=#headings>Headings</a></li></ul><ul><li><a href=#h2>H2</a><ul><li><a href=#h3>H3</a><ul><li><a href=#h4>H4</a></li></ul></li></ul></li><li><a href=#paragraph>Paragraph</a></li><li><a href=#blockquotes>Blockquotes</a><ul><li><ul><li><a href=#blockquote-without-attribution>Blockquote without attribution</a></li><li><a href=#blockquote-with-attribution>Blockquote with attribution</a></li></ul></li></ul></li><li><a href=#tables>Tables</a><ul><li><ul><li><a href=#inline-markdown-within-tables>Inline Markdown within tables</a></li></ul></li></ul></li><li><a href=#code-blocks>Code Blocks</a><ul><li><ul><li><a href=#code-block-with-backticks>Code block with backticks</a></li><li><a href=#code-block-indented-with-four-spaces>Code block indented with four spaces</a></li><li><a href=#code-block-with-hugos-internal-highlight-shortcode>Code block with Hugo&rsquo;s internal highlight shortcode</a></li></ul></li></ul></li><li><a href=#list-types>List Types</a><ul><li><ul><li><a href=#ordered-list>Ordered List</a></li><li><a href=#unordered-list>Unordered List</a></li><li><a href=#nested-list>Nested list</a></li></ul></li></ul></li><li><a href=#other-elements--abbr-sub-sup-kbd-mark>Other Elements — abbr, sub, sup, kbd, mark</a></li></ul></nav></div></section></aside><script>var enableToc=JSON.parse("true");var toc=JSON.parse("null");var tocPosition=JSON.parse("\"inner\"");var singleMainElem=document.querySelector('.single__main');var singleSideElem=document.querySelector('.single__side');enquire.register("screen and (max-width: 769px)",{match:function(){if((enableToc||toc)&&tocPosition!=="outer"){if(singleMainElem&&singleSideElem){singleMainElem.classList.remove('main-main');singleMainElem.classList.add('main');singleSideElem.classList.remove('main-side');singleSideElem.classList.add('hide');}}else if(tocPosition==="outer"){if(singleMainElem&&!singleMainElem.classList.contains('main-main')){singleMainElem.classList.remove('main-main');singleMainElem.classList.add('main');}
if(singleSideElem&&!singleSideElem.classList.contains('hide')){singleSideElem.classList.add('hide');}}},unmatch:function(){if((enableToc||toc)&&tocPosition!=="outer"){singleMainElem.classList.remove('main');singleMainElem.classList.add('main-main');singleSideElem.classList.remove('hide');singleSideElem.classList.add('main-side');}else if(tocPosition==="outer"){if(singleMainElem&&!singleMainElem.classList.contains('main-main')){singleMainElem.classList.remove('main-main');singleMainElem.classList.add('main');}
if(singleSideElem&&!singleSideElem.classList.contains('hide')){singleSideElem.classList.add('hide');}}
var navCollapseBtn=document.querySelector('.navbar__burger');var navCollapse=document.getElementsByClassName('navbarm__collapse')[0];if(navCollapse){navCollapse.setAttribute('data-open',false);navCollapse.style.maxHeight=0;navCollapseBtn.classList.remove('is-active');}
document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');document.getElementsByClassName('mobile-search')[0].classList.add('hide');},setup:function(){},deferSetup:true,destroy:function(){},});</script><script defer src=/js/helper/getParents.min.js></script><script defer src=/js/helper/closest.min.js></script><script defer src=/js/helper/prev.min.js></script><script defer src=/js/helper/prop.min.js></script><script defer src=/js/helper/fadeinout.min.js></script><script defer src=/js/helper/throttle.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity="sha256-V8SV2MO1FUb63Bwht5Wx9x6PVHNa02gv8BgH/uH3ung=" crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity="sha256-F/Xda58SPdcUCr+xhSGz9MA2zQBPb0ASEYKohl8UCHc=" crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity="sha256-90d2pnfw0r4K8CZAWPko4rpFXQsZvJhTBGYNkipDprI=" crossorigin=anonymous></script><script>'use strict';window.onload=function(){var navbar=document.querySelector('.navbar');var singleContentsElem=document.querySelector('.single__contents');var enableBusuanzi=JSON.parse("false");var busuanziPagePV=JSON.parse("true");if(enableBusuanzi&&busuanziPagePV){var pagePvElem=document.querySelector('#busuanzi_value_page_pv');pagePvElem.textContent=pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");}
var enableToc=JSON.parse("true");var toc=JSON.parse("null");var hideToc=JSON.parse("false");var tocFlexbox=document.querySelector('.toc__flexbox');var tocFlexboxOuter=document.querySelector('.toc__flexbox--outer');var tocFolding=JSON.parse("false");if((enableToc||toc)&&document.querySelector('.toc')){var tableOfContentsElem=document.querySelector('.toc').querySelector('#TableOfContents');tableOfContentsElem.onmouseenter=function(){if(navbar.classList.contains('scrolling')){navbar.classList.remove('scrolling');}}
tableOfContentsElem.onmouseleave=function(){if(!navbar.classList.contains('scrolling')){navbar.classList.add('scrolling');}}
if(false===tocFolding){}else{tableOfContentsElem.querySelectorAll('ul')?tableOfContentsElem.querySelectorAll('ul').forEach(function(rootUl){rootUl.querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});});}):null;}
if(tableOfContentsElem){if(tableOfContentsElem.querySelectorAll('a').length>0){tableOfContentsElem.querySelectorAll('a').forEach(function(elem){elem.addEventListener('click',function(){var id=elem.getAttribute('id');if(!navbar.classList.contains('scrolling')){navbar.classList.remove('navbar--show');navbar.classList.remove('navbar--hide');navbar.classList.add('navbar--hide');}
document.querySelector('.toc').querySelectorAll('a').forEach(function(elem){elem.classList.remove('active');});elem.classList.add('active');var curElem=tableOfContentsElem.querySelector('[href="#'+id+'"]');if(curElem&&curElem.nextElementSibling){curElem.nextElementSibling.style.display='block';}
if(curElem){getParents(curElem,'ul')?getParents(curElem,'ul').forEach(function(elem){elem.style.display='block';}):null;}});});}else{if(tocFlexbox){tocFlexbox.setAttribute('data-position','');if(!tocFlexbox.classList.contains('hide')){tocFlexbox.classList.add('hide');}}
if(tocFlexboxOuter){tocFlexboxOuter.setAttribute('data-position','');if(!tocFlexboxOuter.classList.contains('hide')){tocFlexboxOuter.classList.add('hide');}}}}
var toggleTocElem=document.getElementById("toggle-toc");var visibleTocElem=document.getElementById('visible-toc');var tocElem=document.querySelector('.toc');var mainElem=document.querySelector('main');var sideElem=document.querySelector('side');var tocFlexboxElem=document.querySelector('.toc__flexbox');toggleTocElem?toggleTocElem.addEventListener('change',function(e){if(e.target.checked){if(tocElem){fadeIn(tocElem,200);}
if(tocFlexboxElem){tocFlexboxElem.setAttribute('data-position','fixed');}
if(mainElem){mainElem.classList.remove('main-main');mainElem.classList.remove('main');mainElem.classList.add('main-main');}
if(sideElem){sideElem.classList.remove('main-side');}}else{if(tocElem){fadeOut(tocElem,200);}
if(tocFlexboxElem){tocFlexboxElem.setAttribute('data-position','absolute');}
if(mainElem){mainElem.classList.remove('main-main');mainElem.classList.remove('main');mainElem.classList.add('main');}
if(sideElem){sideElem.classList.remove('main-side');}}}):null;visibleTocElem?visibleTocElem.addEventListener('change',function(e){if(e.target.checked){if(tocElem){fadeIn(tocElem,200);}}else{if(tocElem){fadeOut(tocElem,200);}}}):null;}
var topOffset=120;var botOffset=70;var handleWindowResize=function(){if(tocElem){tocElem.style.maxHeight=(window.innerHeight-topOffset-botOffset)+'px';}}
var throttledWindowResize=throttle(handleWindowResize,300);throttledWindowResize()
window.addEventListener('resize',throttledWindowResize);var text,clip=new ClipboardJS('.anchor');var headers=singleContentsElem.querySelectorAll("h1, h2, h3, h4");var languagedir=JSON.parse("\"ltr\"");headers?headers.forEach(function(elem){var size=parseInt(elem.tagName.substr(1),10)*2;var url=encodeURI(document.location.origin+document.location.pathname);var link=url+"#"+elem.getAttribute('id');var newElemOuter=document.createElement('span');newElemOuter.classList.add('anchor');newElemOuter.classList.add('hide');newElemOuter.setAttribute('data-clipboard-text',decodeURI(link));newElemOuter.style.position='relative';var newElemInner=document.createElement('span');newElemInner.style.position='absolute';newElemInner.style.top='50%';newElemInner.style.left='0.75rem';newElemInner.style.transform='translateY(-50%)';newElemInner.innerHTML=`
<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${32-size}px" height="${32-size}px"><path d="M 5.5625 0 C 4.136719 0 2.707031 0.542969 1.625 1.625 C -0.539063 3.789063 -0.539063 7.335938 1.625 9.5 L 5.28125 13.15625 C 5.667969 13.554688 6.304688 13.558594 6.703125 13.171875 C 7.101563 12.785156 7.105469 12.148438 6.71875 11.75 L 3.03125 8.0625 C 1.632813 6.664063 1.632813 4.429688 3.03125 3.03125 C 4.429688 1.632813 6.664063 1.632813 8.0625 3.03125 L 12.96875 7.9375 C 14.367188 9.335938 14.367188 11.570313 12.96875 12.96875 C 12.804688 13.132813 12.621094 13.25 12.4375 13.375 C 11.980469 13.6875 11.859375 14.308594 12.171875 14.765625 C 12.484375 15.222656 13.105469 15.34375 13.5625 15.03125 C 13.847656 14.835938 14.125 14.625 14.375 14.375 C 16.539063 12.210938 16.539063 8.664063 14.375 6.5 L 9.5 1.625 C 8.417969 0.542969 6.988281 0 5.5625 0 Z M 10.78125 8.875 C 10.738281 8.882813 10.695313 8.894531 10.65625 8.90625 C 10.507813 8.9375 10.371094 9 10.25 9.09375 C 10.039063 9.253906 9.820313 9.429688 9.625 9.625 C 7.460938 11.789063 7.460938 15.335938 9.625 17.5 L 14.5 22.375 C 16.664063 24.539063 20.210938 24.539063 22.375 22.375 C 24.539063 20.210938 24.539063 16.664063 22.375 14.5 L 18.71875 10.875 C 18.476563 10.578125 18.089844 10.441406 17.714844 10.527344 C 17.34375 10.613281 17.050781 10.90625 16.964844 11.277344 C 16.878906 11.652344 17.015625 12.039063 17.3125 12.28125 L 20.96875 15.9375 C 22.367188 17.335938 22.367188 19.570313 20.96875 20.96875 C 19.570313 22.367188 17.335938 22.367188 15.9375 20.96875 L 11.03125 16.0625 C 9.632813 14.664063 9.632813 12.429688 11.03125 11.03125 C 11.152344 10.90625 11.300781 10.820313 11.4375 10.71875 C 11.839844 10.472656 12.015625 9.976563 11.855469 9.53125 C 11.699219 9.085938 11.25 8.8125 10.78125 8.875 Z"/></svg>`;if(languagedir==="rtl"){newElemInner.style.left='-2rem';}else{newElemInner.style.right='-2rem';}
newElemOuter.append(newElemInner);elem.append(newElemOuter);elem.addEventListener('mouseenter',function(){this.querySelector('.anchor').classList.remove('hide');});elem.addEventListener('mouseleave',function(){this.querySelector('.anchor').classList.add('hide');});}):null;document.querySelectorAll('.anchor').forEach(function(elem){elem.addEventListener('mouseleave',function(){elem.setAttribute('aria-label',null);elem.classList.remove('tooltipped');elem.classList.remove('tooltipped-s');elem.classList.remove('tooltipped-w');});});clip.on('success',function(e){e.clearSelection();e.trigger.setAttribute('aria-label','Link copied to clipboard!');e.trigger.classList.add('tooltipped');e.trigger.classList.add('tooltipped-s');});var lib=JSON.parse("\"katex\"");if(lib&&lib.includes('mermaid')){var themeVariant=localStorage.getItem('theme')||JSON.parse("\"light\"");if(themeVariant==="dark"||themeVariant==="hacker"){mermaid.initialize({theme:'dark'});}else{mermaid.initialize({theme:'default'});}
var mermaids=[];[].push.apply(mermaids,document.getElementsByClassName('language-mermaid'));mermaids.forEach(function(elem){var elemParentNode=elem.parentNode;if(elemParentNode!==document.body){elemParentNode.parentNode.insertBefore(elem,elemParentNode);elemParentNode.parentNode.removeChild(elemParentNode);}
var newElemWrapper=document.createElement('div');newElemWrapper.classList.add('mermaid');newElemWrapper.style.padding='34px 4px 6px';newElemWrapper.innerHTML=elem.innerHTML;elem.replaceWith(newElemWrapper);});}
if(lib&&lib.includes('katex')){var mathElements=document.getElementsByClassName('math');var options={delimiters:[{left:"$$",right:"$$",display:true},{left:"\\[",right:"\\]",display:true},{left:"$",right:"$",display:false},{left:"\\(",right:"\\)",display:false}],};renderMathInElement(document.querySelector('.single__contents'),options);}
if(lib&&lib.includes('flowchartjs')){var options=JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");var jsonContent=null;var flowchartPrefix="language-flowchart";var index=0;Array.prototype.forEach.call(document.querySelectorAll("[class^="+flowchartPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('div');node0.id='flowchart'+index;x.parentNode.insertBefore(node0,x);var diagram=flowchart.parse(jsonContent);diagram.drawSVG("flowchart"+index,options);index+=1;});}
document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'});if(lib&&lib.includes('msc')){var options=JSON.parse("{\"theme\":\"hand\"}");var jsonContent=null;var index=0;var chartPrefix="language-msc";Array.prototype.forEach.call(document.querySelectorAll("[class^="+chartPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('div');node0.id='msc'+index;x.parentNode.insertBefore(node0,x);var diagram=Diagram.parse(jsonContent);diagram.drawSVG("msc"+index,options);index+=1;});}
if(lib&&lib.includes('chart')){var borderColor="#666";var bgColor="#ddd";var borderWidth=2;Chart.defaults.global.elements.rectangle.borderWidth=borderWidth;Chart.defaults.global.elements.rectangle.borderColor=borderColor;Chart.defaults.global.elements.rectangle.backgroundColor=bgColor;Chart.defaults.global.elements.line.borderWidth=borderWidth;Chart.defaults.global.elements.line.borderColor=borderColor;Chart.defaults.global.elements.line.backgroundColor=bgColor;Chart.defaults.global.elements.point.borderWidth=borderWidth;Chart.defaults.global.elements.point.borderColor=borderColor;Chart.defaults.global.elements.point.backgroundColor=bgColor;var chartPrefix="language-chart";var index=0;var jsonContent=null;Array.prototype.forEach.call(document.querySelectorAll("[class^="+chartPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('canvas');var source=null;node0.height=200;node0.style.height=200;node0.id='myChart'+index;source=JSON.parse(jsonContent);x.parentNode.insertBefore(node0,x);var ctx=document.getElementById('myChart'+index).getContext('2d');var myChart=new Chart(ctx,source);index+=1;});}
if(lib&&lib.includes('wavedrom')){var wavePrefix="language-wave";var index=0;var jsonContent=null;Array.prototype.forEach.call(document.querySelectorAll("[class^="+wavePrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('div');var source=null;node0.id='WaveDrom_Display_'+index;source=JSON.parse(jsonContent);x.parentNode.insertBefore(node0,x);WaveDrom.RenderWaveForm(index,source,"WaveDrom_Display_");index+=1;});}
if(lib&&lib.includes('viz')){var vizPrefix="language-viz-";Array.prototype.forEach.call(document.querySelectorAll("[class^="+vizPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
var engine;x.getAttribute("class").split(" ").forEach(function(cls){if(cls.startsWith(vizPrefix)){engine=cls.substr(vizPrefix.length);}});var viz=new Viz();viz.renderSVGElement(x.innerText,{engine:engine}).then(function(element){element.style.width="100%";x.parentNode.insertBefore(element,x);})});}}</script><footer class=footer><div class=footer__social><div class=social><a href=https://github.com/771-8bit title=github aria-label=github><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24"><g id="surface3680"><path fill="currentcolor" d="M10.898438 2.101562C6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 8.699219 21.398438 9 21.199219 9 20.800781V19.199219S8.601562 19.300781 8.101562 19.300781C6.699219 19.300781 6.101562 18.101562 6 17.398438 5.898438 17 5.699219 16.699219 5.398438 16.398438 5.101562 16.300781 5 16.300781 5 16.199219 5 16 5.300781 16 5.398438 16 6 16 6.5 16.699219 6.699219 17 7.199219 17.800781 7.800781 18 8.101562 18 8.5 18 8.800781 17.898438 9 17.800781 9.101562 17.101562 9.398438 16.398438 10 16 7.699219 15.5 6 14.199219 6 12 6 10.898438 6.5 9.800781 7.199219 9 7.101562 8.800781 7 8.300781 7 7.601562 7 7.199219 7 6.601562 7.300781 6 7.300781 6 8.699219 6 10.101562 7.300781 10.601562 7.101562 11.300781 7 12 7S13.398438 7.101562 14 7.300781C15.300781 6 16.800781 6 16.800781 6 17 6.601562 17 7.199219 17 7.601562 17 8.398438 16.898438 8.800781 16.800781 9 17.5 9.800781 18 10.800781 18 12 18 14.199219 16.300781 15.5 14 16 14.601562 16.5 15 17.398438 15 18.300781V20.898438C15 21.199219 15.300781 21.5 15.699219 21.398438 19.398438 19.898438 22 16.300781 22 12.101562 22 6.101562 16.898438 1.398438 10.898438 2.101562zm0 0"/></g></svg></a><a href=https://twitter.com/771_8bit title=twitter aria-label=twitter><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><g id="surface676"><path fill="currentcolor" d="M28 8.558594C27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 5.246094 7.875 5.003906 8.722656 5.003906 9.625 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469c0 .023437000000001262.0.042969000000001145.0.0625C4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 4.777344 23.609375 4.386719 23.585938 4 23.539062 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 26.503906 10.410156 27.339844 9.542969 28 8.558594zm0 0"/></g></svg></a></div></div><div id=gtt><div class=gtt><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentcolor" d="M8.12 14.71 12 10.83l3.88 3.88c.39.39 1.02.39 1.41.0s.39-1.02.0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41.0L6.7 13.3c-.39.39-.39 1.02.0 1.41.39.38 1.03.39 1.42.0z"/></svg></div></div><hr><div class="basicflex flexwrap"></div><div class=footer__poweredby></div></footer></div><div class="wrapper__right hide" data-pad=true dir=ltr><script>document.querySelector('.wrapper__right').classList.remove('hide')</script></div></div></body></html>