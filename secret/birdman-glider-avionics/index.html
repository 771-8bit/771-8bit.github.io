<!doctype html><html lang=ja dir=ltr><head prefix="og: http://ogp.me/ns#"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>鳥コン滑空機の電装の開発 – @771-8bit</title><script defer src=/js/fuse.min.32195737929df2c8096e855a5789cbb3f1331224d9169e8705493e7008f47df8.js></script><script src=/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js></script><script defer src=/js/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js></script><script defer src=/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js></script><script defer src=/js/helper/fadeinout.min.efa35f4c090622130b3f4cfae6971448b5ffb61c5f0a8f21cdfd157fa712abc4.js></script><script defer src=/js/helper/closest.min.js></script><script>"use strict";if(window.NodeList&&!NodeList.prototype.forEach){NodeList.prototype.forEach=Array.prototype.forEach;}
if(!String.prototype.includes){String.prototype.includes=function(search,start){'use strict';if(search instanceof RegExp){throw TypeError('first argument must not be a RegExp');}
if(start===undefined){start=0;}
return this.indexOf(search,start)!==-1;};}
Document.prototype.append=Element.prototype.append=function append(){this.appendChild(_mutation(arguments));};function _mutation(nodes){if(!nodes.length){throw new Error('DOM Exception 8');}else if(nodes.length===1){return typeof nodes[0]==='string'?document.createTextNode(nodes[0]):nodes[0];}else{var
fragment=document.createDocumentFragment(),length=nodes.length,index=-1,node;while(++index<length){node=nodes[index];fragment.appendChild(typeof node==='string'?document.createTextNode(node):node);}
return fragment;}}
if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return this.indexOf(searchString,position)===position;};}
document.addEventListener('DOMContentLoaded',function(){var navCollapseBtn=document.querySelector('.navbar__burger');navCollapseBtn?navCollapseBtn.addEventListener('click',function(e){var navCollapse=document.querySelector('.navbarm__collapse');if(navCollapse){var dataOpen=navCollapse.getAttribute('data-open');if(dataOpen==='true'){navCollapse.setAttribute('data-open','false');navCollapse.style.maxHeight=0;navCollapseBtn.classList.remove('is-active');}else{navCollapse.setAttribute('data-open','true');navCollapse.style.maxHeight=navCollapse.scrollHeight+"px";navCollapseBtn.classList.add('is-active');}}}):null;var tables=document.querySelectorAll('.single__contents > table');for(let i=0;i<tables.length;i++){var table=tables[i];var wrapper=document.createElement('div');wrapper.className='table-wrapper';table.parentElement.replaceChild(wrapper,table);wrapper.appendChild(table);}
var footNoteRefs=document.querySelectorAll('.footnote-ref');var footNoteBackRefs=document.querySelectorAll('.footnote-backref');footNoteRefs?footNoteRefs.forEach(function(elem,idx){elem.onmouseenter=function(){if(navbar.classList.contains('scrolling')){navbar.classList.remove('scrolling');}}
elem.onmouseleave=function(){if(!navbar.classList.contains('scrolling')){setTimeout(function(){navbar.classList.add('scrolling');},100);}}
elem.onclick=function(){if(!navbar.classList.contains('scrolling')){navbar.classList.remove('navbar--show');navbar.classList.remove('navbar--hide');navbar.classList.add('navbar--hide');}}}):null;footNoteBackRefs?footNoteBackRefs.forEach(function(elem,idx){elem.onmouseenter=function(){if(navbar.classList.contains('scrolling')){navbar.classList.remove('scrolling');}}
elem.onmouseleave=function(){if(!navbar.classList.contains('scrolling')){setTimeout(function(){navbar.classList.add('scrolling');},100);}}
elem.onclick=function(){if(!navbar.classList.contains('scrolling')){navbar.classList.remove('navbar--show');navbar.classList.remove('navbar--hide');navbar.classList.add('navbar--hide');}}}):null;var summaryContainer=document.querySelector('.summary__container');var searchResult=document.querySelector('.search-result');var searchResultCloseBtn=document.querySelector('.search-result__close');searchResultCloseBtn?searchResultCloseBtn.addEventListener('click',function(e){searchResult.setAttribute('data-display','none');summaryContainer.setAttribute('data-display','block');}):null;document.querySelectorAll('.tab')?document.querySelectorAll('.tab').forEach(function(elem,idx){var containerId=elem.getAttribute('id');var containerElem=elem;var tabLinks=elem.querySelectorAll('.tab__link');var tabContents=elem.querySelectorAll('.tab__content');var ids=[];tabLinks&&tabLinks.length>0?tabLinks.forEach(function(link,index,self){link.onclick=function(e){for(var i=0;i<self.length;i++){if(index===parseInt(i,10)){if(!self[i].classList.contains('active')){self[i].classList.add('active');tabContents[i].style.display='block';}}else{self[i].classList.remove('active');tabContents[i].style.display='none';}}}}):null;}):null;document.querySelectorAll('.codetab')?document.querySelectorAll('.codetab').forEach(function(elem,idx){var containerId=elem.getAttribute('id');var containerElem=elem;var codetabLinks=elem.querySelectorAll('.codetab__link');var codetabContents=elem.querySelectorAll('.codetab__content');var ids=[];codetabLinks&&codetabLinks.length>0?codetabLinks.forEach(function(link,index,self){link.onclick=function(e){for(var i=0;i<self.length;i++){if(index===parseInt(i,10)){if(!self[i].classList.contains('active')){self[i].classList.add('active');codetabContents[i].style.display='block';}}else{self[i].classList.remove('active');codetabContents[i].style.display='none';}}}}):null;}):null;var gttBtn=document.getElementById("gtt");gttBtn.style.display="none";gttBtn.addEventListener('click',function(){if(window.document.documentMode){document.documentElement.scrollTop=0;}else{scrollToTop(250);}});function scrollToTop(scrollDuration){var scrollStep=-window.scrollY/(scrollDuration/15);var scrollInterval=setInterval(function(){if(window.scrollY!=0){window.scrollBy(0,scrollStep);}
else clearInterval(scrollInterval);},15);}
var scrollFunction=function(){if(document.body.scrollTop>250||document.documentElement.scrollTop>250){gttBtn.style.display="block";}else{gttBtn.style.display="none";}}
var expandBtn=document.querySelectorAll('.expand__button');for(let i=0;i<expandBtn.length;i++){expandBtn[i].addEventListener("click",function(){var content=this.nextElementSibling;if(content.style.maxHeight){content.style.maxHeight=null;this.querySelector('svg').classList.add('expand-icon__right');this.querySelector('svg').classList.remove('expand-icon__down');}else{content.style.maxHeight=content.scrollHeight+"px";this.querySelector('svg').classList.remove('expand-icon__right');this.querySelector('svg').classList.add('expand-icon__down');}});}
var lastScrollTop=window.pageYOffset||document.documentElement.scrollTop;var tocElem=document.querySelector('.toc');var tableOfContentsElem=tocElem?tocElem.querySelector('#TableOfContents'):null;var toggleTocElem=document.getElementById('toggle-toc');var singleContentsElem=document.querySelector('.single__contents');var navbar=document.querySelector('.navbar');var tocFlexbox=document.querySelector('.toc__flexbox');var tocFlexboxOuter=document.querySelector('.toc__flexbox--outer');var expandContents=document.querySelectorAll('.expand__content');var boxContents=document.querySelectorAll('.box');var notAllowedTitleIds=null;var tocFolding=JSON.parse("false");var tocLevels=JSON.parse("[\"h2\",\"h3\",\"h4\"]");if(tocLevels){tocLevels=tocLevels.toString();}else{tocLevels="h1, h2, h3, h4, h5, h6";}
singleContentsElem&&singleContentsElem.querySelectorAll(".tab")?singleContentsElem.querySelectorAll(".tab").forEach(function(elem){elem.querySelectorAll(tocLevels).forEach(function(element){notAllowedTitleIds=Array.isArray(notAllowedTitleIds)?notAllowedTitleIds.concat(element.getAttribute('id')):[element.getAttribute('id')];});}):null;expandContents?expandContents.forEach(function(elem){elem.querySelectorAll(tocLevels).forEach(function(element){notAllowedTitleIds=Array.isArray(notAllowedTitleIds)?notAllowedTitleIds.concat(element.getAttribute('id')):[element.getAttribute('id')];});}):null;boxContents?boxContents.forEach(function(elem){elem.querySelectorAll(tocLevels).forEach(function(element){notAllowedTitleIds=Array.isArray(notAllowedTitleIds)?notAllowedTitleIds.concat(element.getAttribute('id')):[element.getAttribute('id')];});}):null;window.onscroll=function(){scrollFunction();var st=window.pageYOffset||document.documentElement.scrollTop;if(st>lastScrollTop){if(st<250){gttBtn.style.display="none";}else{gttBtn.style.display="block";}
if(st<45){return null;}
if(navbar.classList.contains('scrolling')){if(!navbar.classList.contains('navbar--hide')){navbar.classList.add('navbar--hide');}else if(navbar.classList.contains('navbar--show')){navbar.classList.remove('navbar--show');}}
if(singleContentsElem){if(singleContentsElem.querySelectorAll(tocLevels).length>0){singleContentsElem.querySelectorAll(tocLevels).forEach(function(elem){if(toggleTocElem&&!toggleTocElem.checked){return null;}
if(notAllowedTitleIds&&notAllowedTitleIds.includes(elem.getAttribute('id'))){return null;}
if(document.documentElement.scrollTop>=elem.offsetTop){if(tableOfContentsElem){var id=elem.getAttribute('id');tocElem.querySelectorAll('a').forEach(function(elem){elem.classList.remove('active');});tocElem.querySelector('a[href="#'+id+'"]')?tocElem.querySelector('a[href="#'+id+'"]').classList.add('active'):null;if(false===tocFolding){}else{tableOfContentsElem.querySelectorAll('ul')?tableOfContentsElem.querySelectorAll('ul').forEach(function(rootUl){rootUl.querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});});}):null;}
var curElem=tableOfContentsElem.querySelector("[href='#"+id+"']");if(curElem&&curElem.nextElementSibling){curElem.nextElementSibling.style.display='block';}
getParents(curElem,'ul')?getParents(curElem,'ul').forEach(function(elem){elem.style.display='block';}):null;}}});}else{if(tocFlexbox){tocFlexbox.setAttribute('data-position','');if(!tocFlexbox.classList.contains('hide')){tocFlexbox.classList.add('hide');}}
if(tocFlexboxOuter){tocFlexboxOuter.setAttribute('data-position','');if(!tocFlexboxOuter.classList.contains('hide')){tocFlexboxOuter.classList.add('hide');}}}}}else{if(st<250){gttBtn.style.display="none";}
if(navbar.classList.contains('scrolling')){if(navbar.classList.contains('navbar--hide')){navbar.classList.remove('navbar--hide');}else if(!navbar.classList.contains('navbar--show')){navbar.classList.add('navbar--show');}}
if(singleContentsElem){if(singleContentsElem.querySelectorAll(tocLevels).length>0){singleContentsElem.querySelectorAll(tocLevels).forEach(function(elem){if(toggleTocElem&&!toggleTocElem.checked){return null;}
if(notAllowedTitleIds&&notAllowedTitleIds.includes(elem.getAttribute('id'))){return null;}
if(document.documentElement.scrollTop>=elem.offsetTop){if(tableOfContentsElem){var id=elem.getAttribute('id');tocElem.querySelectorAll('a').forEach(function(elem){elem.classList.remove('active');});tocElem.querySelector('a[href="#'+id+'"]')?tocElem.querySelector('a[href="#'+id+'"]').classList.add('active'):null;if(false===tocFolding){}else{tableOfContentsElem.querySelectorAll('ul')?tableOfContentsElem.querySelectorAll('ul').forEach(function(rootUl){rootUl.querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});});}):null;}
var curElem=tableOfContentsElem.querySelector("[href='#"+id+"']");if(curElem&&curElem.nextElementSibling){curElem.nextElementSibling.style.display='block';}
getParents(curElem,'ul')?getParents(curElem,'ul').forEach(function(elem){elem.style.display='block';}):null;}}});}else{if(tocFlexbox&&!tocFlexbox.classList.contains('hide')){tocFlexbox.classList.add('hide');}
if(tocFlexboxOuter&&!tocFlexboxOuter.classList.contains('hide')){tocFlexboxOuter.classList.add('hide');}}}
if(tableOfContentsElem&&document.documentElement.scrollTop<250){if(false===tocFolding){}else{tableOfContentsElem.querySelector('ul')?tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});}):null;}}}
lastScrollTop=st<=0?0:st;};var localTheme=localStorage.getItem('theme');var rootEleme=document.getElementById('root');var selectThemeElem=document.querySelectorAll('.select-theme');var selectThemeItemElem=document.querySelectorAll('.select-theme__item');var skinDarkCode=JSON.parse("\"dark\"");var skinLightCode=JSON.parse("\"light\"");var skinHackerCode=JSON.parse("\"hacker\"");var skinSolarizedCode=JSON.parse("\"solarized\"");var skinKimbieCode=JSON.parse("\"kimbie\"");var setMetaColor=function(themeColor){var metaMsapplicationTileColor=document.getElementsByName('msapplication-TileColor')[0];var metaThemeColor=document.getElementsByName('theme-color')[0];var metaMsapplicationNavbuttonColor=document.getElementsByName('msapplication-navbutton-color')[0];var metaAppleMobileWebAappStatusBarStyle=document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];if(themeColor.includes('dark')){metaMsapplicationTileColor.setAttribute('content','#fcfcfa');metaThemeColor.setAttribute('content','#403E41');metaMsapplicationNavbuttonColor.setAttribute('content','#403E41');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#403E41');}else if(themeColor.includes('light')){metaMsapplicationTileColor.setAttribute('content','#555');metaThemeColor.setAttribute('content','#eee');metaMsapplicationNavbuttonColor.setAttribute('content','#eee');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#eee');}else if(themeColor.includes('hacker')){metaMsapplicationTileColor.setAttribute('content','#e3cd26');metaThemeColor.setAttribute('content','#252526');metaMsapplicationNavbuttonColor.setAttribute('content','#252526');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#252526');}else if(themeColor.includes('solarized')){metaMsapplicationTileColor.setAttribute('content','#d3af86');metaThemeColor.setAttribute('content','#51412c');metaMsapplicationNavbuttonColor.setAttribute('content','#51412c');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#51412c');}else if(themeColor.includes('kimbie')){metaMsapplicationTileColor.setAttribute('content','#586e75');metaThemeColor.setAttribute('content','#eee8d5');metaMsapplicationNavbuttonColor.setAttribute('content','#eee8d5');metaAppleMobileWebAappStatusBarStyle.setAttribute('content','#eee8d5');}}
var parseSkinCode=function(themeText){if(themeText===skinDarkCode){return 'dark';}else if(themeText===skinLightCode){return 'light';}else if(themeText===skinHackerCode){return 'hacker';}else if(themeText===skinSolarizedCode){return 'solarized';}else if(themeText===skinKimbieCode){return 'kimbie';}}
if(localTheme){selectThemeItemElem?selectThemeItemElem.forEach(function(elem){if(elem.text.trim()===localTheme){elem.classList.add('is-active');}else{elem.classList.remove('is-active');}}):null;setMetaColor(localTheme);}else{setMetaColor(rootEleme.className);}
selectThemeItemElem?selectThemeItemElem.forEach(function(v,i){v.addEventListener('click',function(e){var selectedThemeVariant=parseSkinCode(e.target.text.trim());localStorage.setItem('theme',selectedThemeVariant);setMetaColor(selectedThemeVariant);rootEleme.removeAttribute('class');rootEleme.classList.add('theme__'+selectedThemeVariant);selectThemeElem.forEach(function(rootElem){rootElem.querySelectorAll('a').forEach(function(elem){if(elem.classList){if(elem.text.trim()===selectedThemeVariant){if(!elem.classList.contains('is-active')){elem.classList.add('is-active');}}else{if(elem.classList.contains('is-active')){elem.classList.remove('is-active');}}}});});if(window.mermaid){if(selectedThemeVariant==="dark"||selectedThemeVariant==="hacker"){mermaid.initialize({theme:'dark'});location.reload();}else{mermaid.initialize({theme:'default'});location.reload();}}
var utterances=document.getElementById('utterances');if(utterances){utterances.querySelector('iframe').contentWindow.postMessage({type:'set-theme',theme:selectedThemeVariant==="dark"||selectedThemeVariant==="hacker"?'photon-dark':selectedThemeVariant==='kimbie'?'github-dark-orange':'github-light',},'https://utteranc.es');}
var twitterCards=document.querySelectorAll('.twitter-timeline');if(twitterCards){window.postMessage({type:'set-twitter-theme',theme:selectedThemeVariant==='light'||selectedThemeVariant==='solarized'?'light':'dark',});}});}):null;var baseurl=JSON.parse("\"https://771-8bit.com\"");var permalink=JSON.parse("\"https://771-8bit.com/secret/birdman-glider-avionics/\"");var langprefix=JSON.parse("\"\"");var searchResults=null;var searchMenu=null;var searchText=null;var enableSearch=JSON.parse("true");var searchDistance=JSON.parse("100");var searchThreshold=JSON.parse("0.4");var searchContent=JSON.parse("true");var enableSearchHighlight=JSON.parse("true");var searchResultPosition=JSON.parse("\"main\"");var sectionType=JSON.parse("\"secret\"");var kind=JSON.parse("\"page\"");var fuse=null;if(enableSearch){(function initFuse(){var xhr=new XMLHttpRequest();if(sectionType==="publication"&&kind!=="page"){xhr.open('GET',permalink+"index.json");}else{xhr.open('GET',baseurl+langprefix+"/index.json");}
xhr.setRequestHeader('Content-Type','application/json; charset=utf-8');xhr.onload=function(){if(xhr.status===200){fuse=new Fuse(JSON.parse(xhr.response.toString('utf-8')),{keys:sectionType.includes('publication')?['title','abstract']:searchContent?['title','description','content']:['title','description'],includeMatches:enableSearchHighlight,shouldSort:true,threshold:searchThreshold?searchThreshold:0.4,location:0,distance:searchDistance?searchDistance:100,maxPatternLength:32,minMatchCharLength:1,isCaseSensitive:false,findAllMatches:false,useExtendedSearch:false,});window.fuse=fuse;}
else{console.error('['+xhr.status+']Error:',xhr.statusText);}};xhr.send();})();}
function makeLi(ulElem,obj){var li=document.createElement('li');li.className='search-result__item';var a=document.createElement('a');a.innerHTML=obj.item.title;a.setAttribute('class','search-result__item--title');a.setAttribute('href',obj.item.uri);var descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');if(obj.item.description){descDiv.innerHTML=obj.item.description;}else if(obj.item.content){descDiv.innerHTML=obj.item.content.substring(0,225);}
li.appendChild(a);li.appendChild(descDiv);ulElem.appendChild(li);}
function makeHighlightLi(ulElem,obj){var li=document.createElement('li');li.className='search-result__item';var descDiv=null;var a=document.createElement('a');a.innerHTML=obj.item.title;a.setAttribute('class','search-result__item--title');a.setAttribute('href',obj.item.uri);if(obj.matches&&obj.matches.length){for(var i=0;i<obj.matches.length;i++){if('title'===obj.matches[i].key){a=document.createElement('a');a.innerHTML=generateHighlightedText(obj.matches[i].value,obj.matches[i].indices);a.setAttribute('class','search-result__item--title');a.setAttribute('href',obj.item.uri);}
if('description'===obj.matches[i].key){descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=generateHighlightedText(obj.item.description,obj.matches[i].indices);}else if('content'===obj.matches[i].key){if(!descDiv){descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=generateHighlightedText(obj.item.content.substring(0,150),obj.matches[i].indices);}}else{if(obj.item.description){descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=obj.item.description;}else{descDiv=document.createElement('div');descDiv.setAttribute('class','search-result__item--desc');descDiv.innerHTML=obj.item.content.substring(0,150);}}}
li.appendChild(a);if(descDiv){li.appendChild(descDiv);}
if(li){ulElem.appendChild(li);}}}
function renderSearchResultsSide(searchText,results){searchResults=document.getElementById('search-results');searchMenu=document.getElementById('search-menu');searchResults.setAttribute('class','dropdown is-active');var ul=document.createElement('ul');ul.setAttribute('class','dropdown-content search-content');if(results.length){results.forEach(function(result){var li=document.createElement('li');var a=document.createElement('a');a.setAttribute('href',result.uri);a.setAttribute('class','dropdown-item');a.appendChild(li);var titleDiv=document.createElement('div');titleDiv.innerHTML=result.title;titleDiv.setAttribute('class','menu-item__title');var descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');if(result.description){descDiv.innerHTML=result.description;}else if(result.content){descDiv.innerHTML=result.content.substring(0,150);}
li.appendChild(titleDiv);li.appendChild(descDiv);ul.appendChild(a);});}else{var li=document.createElement('li');li.setAttribute('class','dropdown-item');li.innerText='No results found';ul.appendChild(li);}
while(searchMenu.hasChildNodes()){searchMenu.removeChild(searchMenu.lastChild);}
searchMenu.appendChild(ul);}
function renderSearchHighlightResultsSide(searchText,results){searchResults=document.getElementById('search-results');searchMenu=document.getElementById('search-menu');searchResults.setAttribute('class','dropdown is-active');var ul=document.createElement('ul');ul.setAttribute('class','dropdown-content search-content');if(results.length){results.forEach(function(result){var li=document.createElement('li');var a=document.createElement('a');var descDiv=null;a.setAttribute('href',result.item.uri);a.setAttribute('class','dropdown-item');a.appendChild(li);var titleDiv=document.createElement('div');titleDiv.innerHTML=result.item.title;titleDiv.setAttribute('class','menu-item__title');if(result.matches&&result.matches.length){for(var i=0;i<result.matches.length;i++){if('title'===result.matches[i].key){titleDiv.innerHTML=generateHighlightedText(result.matches[i].value,result.matches[i].indices);}
if('description'===result.matches[i].key){descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=generateHighlightedText(result.item.description,result.matches[i].indices);}else if('content'===result.matches[i].key){if(!descDiv){descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=generateHighlightedText(result.item.content.substring(0,150),result.matches[i].indices);}}else{if(result.item.description){descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=result.item.description;}else{descDiv=document.createElement('div');descDiv.setAttribute('class','menu-item__desc');descDiv.innerHTML=result.item.content.substring(0,150);}}}
li.appendChild(titleDiv);if(descDiv){li.appendChild(descDiv);}
ul.appendChild(a);}});}else{var li=document.createElement('li');li.setAttribute('class','dropdown-item');li.innerText='No results found';ul.appendChild(li);}
while(searchMenu.hasChildNodes()){searchMenu.removeChild(searchMenu.lastChild);}
searchMenu.appendChild(ul);}
function renderSearchResultsMobile(searchText,results){searchResults=document.getElementById('search-mobile-results');var content=document.createElement('div');content.setAttribute('class','mobile-search__content');if(results.length>0){results.forEach(function(result){var item=document.createElement('a');item.setAttribute('href',result.uri);item.innerHTML='<div class="mobile-search__item"><div class="mobile-search__item--title">📄 '+result.title+'</div><div class="mobile-search__item--desc">'+(result.description?result.description:result.content)+'</div></div>';content.appendChild(item);});}else{var item=document.createElement('span');content.appendChild(item);}
let wrap=document.getElementById('search-mobile-results');while(wrap.firstChild){wrap.removeChild(wrap.firstChild)}
searchResults.appendChild(content);}
function renderSearchHighlightResultsMobile(searchText,results){searchResults=document.getElementById('search-mobile-results');var ul=document.createElement('div');ul.setAttribute('class','mobile-search__content');if(results.length){results.forEach(function(result){var li=document.createElement('li');var a=document.createElement('a');var descDiv=null;a.setAttribute('href',result.item.uri);a.appendChild(li);li.setAttribute('class','mobile-search__item');var titleDiv=document.createElement('div');titleDiv.innerHTML=result.item.title;titleDiv.setAttribute('class','mobile-search__item--title');if(result.matches&&result.matches.length){for(var i=0;i<result.matches.length;i++){if('title'===result.matches[i].key){titleDiv.innerHTML=generateHighlightedText(result.matches[i].value,result.matches[i].indices);}
if('description'===result.matches[i].key){descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=generateHighlightedText(result.item.description,result.matches[i].indices);}else if('content'===result.matches[i].key){if(!descDiv){descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=generateHighlightedText(result.item.content.substring(0,150),result.matches[i].indices);}}else{if(result.item.description){descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=result.item.description;}else{descDiv=document.createElement('div');descDiv.setAttribute('class','mobile-search__item--desc');descDiv.innerHTML=result.item.content.substring(0,150);}}}
li.appendChild(titleDiv);if(descDiv){li.appendChild(descDiv);}
ul.appendChild(a);}});}else{var item=document.createElement('span');ul.appendChild(item);}
let wrap=document.getElementById('search-mobile-results');while(wrap.firstChild){wrap.removeChild(wrap.firstChild)}
searchResults.appendChild(ul);}
function generateHighlightedText(text,regions){if(!regions){return text;}
var content='',nextUnhighlightedRegionStartingIndex=0;regions.forEach(function(region){if(region[0]===region[1]){return null;}
content+=''+
text.substring(nextUnhighlightedRegionStartingIndex,region[0])+
'<span class="search__highlight">'+
text.substring(region[0],region[1]+1)+
'</span>'+
'';nextUnhighlightedRegionStartingIndex=region[1]+1;});content+=text.substring(nextUnhighlightedRegionStartingIndex);return content;};var searchElem=document.getElementById('search');var searchMobile=document.getElementById('search-mobile');var searchResultsContainer=document.getElementById('search-results');searchElem?searchElem.addEventListener('input',function(e){if(!e.target.value|window.innerWidth<770){searchResultsContainer?searchResultsContainer.setAttribute('class','dropdown'):null;searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;return null;}
searchText=e.target.value;var results=fuse.search(e.target.value);if(searchResultPosition==="main"){if(enableSearchHighlight){renderSearchHighlightResultsMain(searchText,results);}else{renderSearchResultsMain(searchText,results);}}else{if(enableSearchHighlight){renderSearchHighlightResultsSide(searchText,results);}else{renderSearchResultsSide(searchText,results);}
var dropdownItems=searchResultsContainer.querySelectorAll('.dropdown-item');dropdownItems?dropdownItems.forEach(function(item){item.addEventListener('mousedown',function(e){e.target.click();});}):null;}}):null;searchElem?searchElem.addEventListener('blur',function(){if(window.innerWidth<770){return null;}
searchResultsContainer?searchResultsContainer.setAttribute('class','dropdown'):null;}):null;searchElem?searchElem.addEventListener('click',function(e){if(window.innerWidth<770){return null;}
if(!e.target.value){searchResultsContainer?searchResultsContainer.setAttribute('class','dropdown'):null;return null;}
searchText=e.target.value;var results=fuse.search(e.target.value);if(searchResultPosition==="main"){if(enableSearchHighlight){renderSearchHighlightResultsMain(searchText,results);}else{renderSearchResultsMain(searchText,results);}}else{if(enableSearchHighlight){renderSearchHighlightResultsSide(searchText,results);}else{renderSearchResultsSide(searchText,results);}
var dropdownItems=searchResultsContainer.querySelectorAll('.dropdown-item');dropdownItems?dropdownItems.forEach(function(item){item.addEventListener('mousedown',function(e){e.target.click();});}):null;}}):null;var searchMenuElem=document.getElementById("search-menu");var activeItem=document.querySelector('#search-menu .dropdown-item.is-active');var activeIndex=null;var items=null;var searchContainerMaxHeight=350;searchElem?searchElem.addEventListener('keydown',function(e){if(window.innerWidth<770){return null;}
if(e.key==='Escape'){searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;}
var items=document.querySelectorAll('#search-menu .dropdown-item');var keyCode=e.which||e.keyCode;if(!items||!items.length){return null;}
if(e.key==='ArrowDown'||keyCode===40){if(activeIndex===null){activeIndex=0;items[activeIndex].classList.remove('is-active');}else{items[activeIndex].classList.remove('is-active');activeIndex=activeIndex===items.length-1?0:activeIndex+1;}
items[activeIndex].classList.add('is-active');let overflowedPixel=items[activeIndex].offsetTop+items[activeIndex].clientHeight-searchContainerMaxHeight;if(overflowedPixel>0){document.querySelector(".search-content").scrollTop+=items[activeIndex].getBoundingClientRect().height;}else if(activeIndex===0){document.querySelector(".search-content").scrollTop=0;}}else if(e.key==='ArrowUp'||keyCode===38){if(activeIndex===null){activeIndex=items.length-1;items[activeIndex].classList.remove('is-active');}else{items[activeIndex].classList.remove('is-active');activeIndex=activeIndex===0?items.length-1:activeIndex-1;}
items[activeIndex].classList.add('is-active');let overflowedPixel=items[activeIndex].offsetTop+items[activeIndex].clientHeight-searchContainerMaxHeight;if(overflowedPixel<0){document.querySelector(".search-content").scrollTop-=items[activeIndex].getBoundingClientRect().height;}else{document.querySelector(".search-content").scrollTop=overflowedPixel+items[activeIndex].getBoundingClientRect().height;}}else if(e.key==='Enter'||keyCode===13){if(items[activeIndex]&&items[activeIndex].getAttribute('href')){location.href=items[activeIndex].getAttribute('href');}}else if(e.key==='Escape'||keyCode===27){e.target.value=null;if(searchResults){searchResults.classList.remove('is-active');}}}):null;searchMobile?searchMobile.addEventListener('input',function(e){if(!e.target.value){let wrap=document.getElementById('search-mobile-results');while(wrap.firstChild){wrap.removeChild(wrap.firstChild);}
return null;}
searchText=e.target.value;var results=fuse.search(e.target.value);renderSearchResultsMobile(searchText,results);if(enableSearchHighlight){renderSearchHighlightResultsMobile(searchText,results);}else{renderSearchResultsMobile(searchText,results);}}):null;var mobileSearchInputElem=document.querySelector('#search-mobile');var mobileSearchClassElem=document.querySelector('.mobile-search');var mobileSearchBtnElems=document.querySelectorAll('.navbar-search');var mobileSearchCloseBtnElem=document.querySelector('#search-mobile-close');var mobileSearchContainer=document.querySelector('#search-mobile-container');var mobileSearchResultsElem=document.querySelector('#search-mobile-results');var htmlElem=document.querySelector('html');if(mobileSearchClassElem){mobileSearchClassElem.style.display='none';}
mobileSearchBtnElems?mobileSearchBtnElems.forEach(function(elem,idx){elem.addEventListener('click',function(){if(mobileSearchContainer){mobileSearchContainer.style.display='block';}
if(mobileSearchInputElem){mobileSearchInputElem.focus();}
if(htmlElem){htmlElem.style.overflowY='hidden';}});}):null;mobileSearchCloseBtnElem?mobileSearchCloseBtnElem.addEventListener('click',function(){if(mobileSearchContainer){mobileSearchContainer.style.display='none';}
if(mobileSearchInputElem){mobileSearchInputElem.value='';}
if(mobileSearchResultsElem){while(mobileSearchResultsElem.firstChild){mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);}}
if(htmlElem){htmlElem.style.overflowY='visible';}}):null;mobileSearchInputElem?mobileSearchInputElem.addEventListener('keydown',function(e){var keyCode=e.which||e.keyCode;if(e.key==='Escape'||keyCode===27){if(mobileSearchContainer){mobileSearchContainer.style.display='none';}
if(mobileSearchInputElem){mobileSearchInputElem.value='';}
if(mobileSearchResultsElem){while(mobileSearchResultsElem.firstChild){mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);}}
if(htmlElem){htmlElem.style.overflowY='visible';}}}):null;function renderSearchResultsMain(searchText,results){var searchBody=document.querySelector('.search-result__body');var originUl=searchBody.querySelector('ul');var ul=document.createElement('ul');if(!searchText){searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;}else if(results){if(results&&results.length){results.forEach(function(result){makeLi(ul,result);});searchResult?searchResult.setAttribute('data-display','block'):null;summaryContainer?summaryContainer.setAttribute('data-display','none'):null;}}
originUl.parentNode.replaceChild(ul,originUl);}
function renderSearchHighlightResultsMain(searchText,results){var searchBody=document.querySelector('.search-result__body');var originUl=searchBody.querySelector('ul');var ul=document.createElement('ul');if(!searchText){searchResult?searchResult.setAttribute('data-display','none'):null;summaryContainer?summaryContainer.setAttribute('data-display','block'):null;}else if(results){if(results&&results.length){results.forEach(function(result){makeHighlightLi(ul,result);});searchResult?searchResult.setAttribute('data-display','block'):null;summaryContainer?summaryContainer.setAttribute('data-display','none'):null;}}
originUl.parentNode.replaceChild(ul,originUl);}});</script><link rel=stylesheet href=/css/main.min.css><meta name=description content><meta name=created content="2022-10-30T00:00:00+0000"><meta name=modified content="2022-10-31T00:00:00+0000"><meta property="article:published_time" content="2022-10-30T00:00:00+0000"><meta name=author content="8bitマイコン"><meta property="og:site_name" content="@771-8bit"><meta property="og:title" content="鳥コン滑空機の電装の開発"><meta property="og:url" content="https://771-8bit.com/secret/birdman-glider-avionics/"><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:image" content="https://771-8bit.com/images/blog/birdman-glider-avionics/torica.jpg"><meta property="og:image:url" content="https://771-8bit.com/images/blog/birdman-glider-avionics/torica.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:app:name:iphone content="@771-8bit"><meta property="twitter:title" content="鳥コン滑空機の電装の開発"><meta property="twitter:description" content><meta name=generator content="Hugo 0.78.2"><meta name=msapplication-TileColor content="#fff"><meta name=theme-color content="#fff"><meta name=msapplication-navbutton-color content="#fff"><meta name=apple-mobile-web-app-status-bar-style content="#fff"><link rel=canonical href=https://771-8bit.com/secret/birdman-glider-avionics/><link rel=manifest href=/manifest.json><link rel=apple-touch-icon sizes=57x57 href=/favicon/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/favicon/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/favicon/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/favicon/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/favicon/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/favicon/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/favicon/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/favicon/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-512x512.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","headline":"鳥コン滑空機の電装の開発","datePublished":"2022-10-30T00:00:00Z","dateModified":"2022-10-31T00:00:00Z","url":"https://771-8bit.com/secret/birdman-glider-avionics/","description":"\u003cp\u003e鳥人間コンテスト2023滑空機部門に出場した，東京理科大学鳥人間サークル鳥科の電装のまとめです．サークル内部の開発用資料，引き継ぎ資料でもあります．\u003c/p\u003e","image":"https://771-8bit.com/images/blog/birdman-glider-avionics/torica.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://771-8bit.com"},"publisher":{"@type":"Organization","name":"@771-8bit","url":"https://771-8bit.com"}}</script></head><body id=root class=theme__light><script>var localTheme=localStorage.getItem('theme');if(localTheme){document.getElementById('root').className='theme__'+localTheme;}</script><div id=container><div class=wrapper data-type=secret data-kind=page><nav class="navbar scrolling" role=navigation aria-label="main navigation" data-dir=ltr><div class=navbar__brand>&nbsp;&nbsp;
<a href=/ title=ホーム rel=home class=navbar__title-link><h6 class=navbar__title>@771-8bit</h6></a></div><div class="theme theme-mobile" data-ani=true><div class=dropdown><button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentcolor" d="M6.34 7.93c-3.12 3.12-3.12 8.19.0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19.0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41.0L6.34 7.93zM12 19.59c-1.6.0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg></button><div class="dropdown-content select-theme"><a href=# class="dropdown-item select-theme__item is-active">light</a>
<a href=# class="dropdown-item select-theme__item">dark</a></div></div></div><div class="mobile-search__btn navbar-search" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49.0s.41-1.08.0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></div><div id=search-mobile-container class="mobile-search hide" data-dir=ltr><div class=mobile-search__top><input id=search-mobile type=text aria-label="Mobile Search" placeholder=検索 class=mobile-search__top--input><div id=search-mobile-close class=mobile-search__top--icon><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path opacity=".87" fill="none" d="M0 0h24v24H0V0z"/><path fill="currentcolor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41.0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"/></svg></div></div><div id=search-mobile-results class=mobile-search__body></div></div><a role=button class=navbar__burger aria-label=menu aria-expanded=false data-ani=true><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><div class=navbarm__collapse data-open=false><ul dir=ltr><li class=navbarm__menu--item><a href=/profile>Profile</a></li><li class=navbarm__menu--item><a href=/archive>Archive</a></li><li class=navbarm__menu--item><a href=/tags class=navbarm__menu--term data-index=0>タグ</a></li></ul></div><div class=navbar__menu><div class=theme data-ani=true><div class=dropdown><button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentcolor" d="M6.34 7.93c-3.12 3.12-3.12 8.19.0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19.0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41.0L6.34 7.93zM12 19.59c-1.6.0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg></button><div class="dropdown-content select-theme"><a href=# class="dropdown-item select-theme__item is-active">light</a>
<a href=# class="dropdown-item select-theme__item">dark</a></div></div></div><a href=/profile class="navbar__menu-item navbar__slide-down" dir=ltr data-ani=true>Profile</a>
<a href=/archive class="navbar__menu-item navbar__slide-down" dir=ltr data-ani=true>Archive</a></div></nav><main class="single__main main-main"><nav class="breadcrumb hide" aria-label=breadcrumbs><script>document.querySelector('.breadcrumb').classList.remove('hide')</script><ol><li><a href=https://771-8bit.com/ class=capitalize>@771-8bit</a></li><li><a href=https://771-8bit.com/secret/ class=capitalize>Secrets</a></li><li class=is-active><span>鳥コン滑空機の電装の開発</span></li></ol></nav><div class=single><div class=single__nojs>JavaScriptを有効にしてください</div><script>document.querySelector('.single').classList.remove('hide');document.querySelector('.single__nojs').classList.add('hide');</script><h2 class=single__title data-ani=true>鳥コン滑空機の電装の開発</h2><h3 class=single__subtitle></h3><div class=single__meta><div class=single__infos><time class=single__info title=作成日>📅&nbsp;2022/10/30</time>
&nbsp;&#183;&nbsp; <time class=single__info title=編集日>📝&nbsp;2022/10/31</time>
&nbsp;&#183;&nbsp; <span class=single__info title=読了時間>☕&nbsp;68&nbsp;分で読めます</span>
<span class=single__info></span></div><ul class="single__tags caption"></ul></div><article class=single__contents data-dir=ltr data-ani=true><p>鳥人間コンテスト2023滑空機部門に出場した，東京理科大学鳥人間サークル鳥科の電装のまとめです．サークル内部の開発用資料，引き継ぎ資料でもあります．</p><hr><p><img src=/images/blog/birdman-glider-avionics/title.png alt loading=lazy></p><h2 id=はじめに>はじめに</h2><p>東京理科大学鳥人間サークル鳥科23代電装班長のブログです．</p><p>鳥科では電装系がロステクしていたため，今後の電装のベースとなるように必要十分な機能を癖なく普通に作るということを心がけました．</p><p>サークル内の開発・引き継ぎ用資料でもあり，情報量が多くまとまりきっていない部分もありますが全て公開します．</p><h2 id=要求定義>要求定義</h2><p>特に滑空機では電装は無くても飛びはしますが，電装があるとちょっと嬉しいので頑張ります．</p><p>要求は上から順に優先です．フライトデータの取得は最低なのは飛ぶことを優先するためです．</p><ul><li>システムの要求<ol><li>パイロットの操作でラダーを制御する</li><li>プラットホーム上で姿勢を確認する</li><li>パイロットに対地高度・対気速度を伝達する</li><li>フライトデータを取得する</li></ol></li><li>電装班運営の要求<ol><li>必要な技術を継承する</li></ol></li></ul><h2 id=要件定義>要件定義</h2><h3 id=共通事項>共通事項</h3><h5 id=非機能要件>非機能要件</h5><ul><li>信頼性<ul><li>故障による直接的な機能の喪失認めるが，優先度が低いものの故障が高いものに影響を与えないような設計にする<ul><li>無線通信が混信しても他に影響を与えない</li><li>メイン電装のマイコンが停止しても操舵系は機能を維持する</li><li>SDカードが脱落しても他の機能は動作する</li></ul></li><li>ソフトウェアのバグ，コクピフレームとの接触による短絡，通信線の切断などの故障を想定する</li><li>システムが複雑になるため基本的に冗長は組まず，予備部品の用意で対応する</li></ul></li><li>安全性<ul><li>着水時に発煙・発火しない</li><li>パイロットの頭部付近に電装を配置しない</li></ul></li><li>稼働時間<ul><li>フライトまでバッテリーが持つ<ul><li>電圧の監視が可能である</li><li>バッテリーに最後にアクセスできるのはフライト前日の機体組み立て開始時</li></ul></li></ul></li><li>環境<ul><li>機体が直射日光にあたり温度が上昇しても動作する</li><li>多少の水滴では故障せず動作し続ける</li><li>(直射日光下で)LEDを見る必要なく運用できる</li></ul></li><li>運用<ul><li>プラットフォーム上で電装の電源を起動できる</li><li>プラホ上での電装作業を最小限にする</li></ul></li><li>開発環境・メンテナンス<ul><li>琵琶湖で機体を組んだ状態で電装のプログラムを変更できる</li></ul></li><li>拡張性<ul><li>とりあえず考えない</li></ul></li></ul><h5 id=制約条件>制約条件</h5><ul><li>電気的制約<ul><li>SPIは通信速度が速く，I2Cはプルアップが不安定なため基板内のみで使用</li><li>基板間の通信はUARTおよびそれに近い規格(RS422など)</li><li>マイコンの動作電圧は多くのセンサーに合わせて基本3.3V</li></ul></li><li>技術(力)的制約<ul><li>Arduinoを使用し，自力でライブラリを書かなくて良い構成とする</li><li>CANはなるべく使用せず，UARTによる文字列送受信を行う</li><li>チップ部品は使用しない</li><li>ケーブルの圧着はせず，既製品を使用する</li></ul></li></ul><h3 id=操舵>操舵</h3><p>そもそもワイヤーリンケージかフライバイワイヤーかはチームにノウハウがあるかで決めていいと思うので，鳥科では電装の仕事</p><ul><li>パイロットの操作でラダーを制御する<ul><li>入力を読む<ul><li>アナログ入力を読むためジョイスティックを使用する</li><li>不感帯を含む，任意のカーブを設定できる</li></ul></li><li>サーボモータを動かす<ul><li>十分なトルクがある<ul><li>風対策</li></ul></li><li>信号・電力の減衰が起きない<ul><li>ケーブルが断線しない</li><li>ケーブルの電圧降下が小さい</li><li>テールまでの長いケーブルで問題なく信号伝達ができる</li></ul></li></ul></li></ul></li><li>その他の要件<ul><li>トラブル時ニュートラルでフライトできる(これは機構側で担保)</li><li>プログラムを変更せずに琵琶湖でニュートラル調整が可能である(操舵範囲は事前調整)</li><li>テールを軽くする<ul><li>バッテリーはコクピに搭載</li><li>軽量なサーボを使用</li></ul></li><li>機体内通信を含む，無線通信で操舵を行ってはならない(大会ルール)</li></ul></li></ul><h3 id=テレメトリ>テレメトリ</h3><ul><li>プラホからの発進時に姿勢などを確認できるようにする<ul><li><del>以下のデータをダウンリンクする</del><ul><li><del>ロール・ピッチ</del></li><li><del>対気速度</del></li></ul></li><li>受信機はポケットに入る程度のサイズにする<ul><li>PC・タブレットは大きくてプラットホームで扱いづらい(特に雨天時)</li></ul></li></ul></li><li>デバッグのため，全センサーデータをダウンリンクする</li></ul><h3 id=高度速度計>高度速度計</h3><ul><li>パイロットに対地高度・対気速度を伝達する<ul><li>対地高度を推定する<ul><li>測定精度は0.1m単位を要求</li><li>技術的な制約<ul><li>高高度では気圧高度を，低高度では超音波高度を信用すべき<ul><li>気圧高度は湖面からの絶対高度は分からない</li><li>超音波は高高度からでは届かない</li></ul></li><li>気圧センサ<ul><li>動圧・ハッチの衝撃によるセンサーの外れ値を弾く</li><li>中央値を取るために違う場所に3つの気圧センサを配置する</li></ul></li><li>超音波センサ<ul><li>水面付近は気圧高度より信用できる</li></ul></li></ul></li></ul></li><li>対気速度はピトー管</li><li>パイロットに情報を伝達する<ul><li>視覚は前方に集中するのでモニター等は使えない(テープLEDはアリかも)</li><li>触覚は操縦に影響するので使えない</li><li>使えるのは聴覚のみ</li></ul></li><li>フェールセーフ<ul><li>センサーデータが取得できない場合，異常だと検知した場合は読み上げを行わない</li></ul></li></ul></li></ul><h3 id=ロガー>ロガー</h3><ul><li>下記のデータを記録する</li></ul><table><thead><tr><th>優先度</th><th>測定値</th><th>備考</th></tr></thead><tbody><tr><td>高</td><td>GPS</td><td>ある程度信頼できるため冗長の必要はない</td></tr><tr><td>高</td><td>超音波高度</td><td>超音波が干渉するため一つだけ搭載する</td></tr><tr><td>高</td><td>気圧高度</td><td>高度計の信頼性を確保できる分だけ搭載する</td></tr><tr><td>中</td><td>ラダー操作量</td><td>ラダー操作に影響を与えないように</td></tr><tr><td>中</td><td>9軸・姿勢</td><td>複数搭載なら異種のセンサーを搭載する</td></tr><tr><td>中</td><td>対気速度</td><td>様々な測定方法があるので後述</td></tr><tr><td>低</td><td>AoA(Angle of Attack)・迎え角</td><td>水面付近は上下方向の風は基本なく，ピッチの測定で十分</td></tr><tr><td>低</td><td>AoS(Angle of Slip)・滑り角</td><td>代替手段がなく，AoAと同じく製作が高難度で今回は見送り</td></tr></tbody></table><ul><li>データを同期した状態で記録する</li><li>着水時にデータをロストしない</li><li>大型の滑空機で急速な動きはしないことを念頭に置いてデータレートを決定する<ul><li>無人機・ロケット界隈のアビオ屋の感覚よりはデータレートは下げても良い(10～20Hz程度)</li><li>要求に完全に合わせるよりもマイコンのスペックで実現可能なものを実装する流れになるので定量的な要求は出さない</li></ul></li></ul><h2 id=スケジュール>スケジュール</h2><div class=mermaid>gantt
dateFormat YYYY-MM-DD
axisFormat %m
todayMarker off
excludes weekends
%% (`excludes` accepts specific dates in YYYY-MM-DD format, days of the week ("sunday") or "weekends", but not the word "weekdays".)
section システム設計
要求定義 :req_def , 2022-10-17,2022-10-27
要求分析 :req_analysis , after req_def , 7d
基本設計 :Functional_design , after req_analysis , 7d
詳細設計 :physical_design , after Functional_design , 2022-11-29
section 電装班外と調整
基板搭載場所仮決定 : kiban, 2022-11-20,1d
基板搭載場所確定(ピトー管以外) : kiban, 2023-02-02,1d
ピトー管場所確定 : pitot, 2023-02-17,1d
ピトー管固定方法確定 :pitot , 2023-03-21,1d
コクピ上部電装固定 :kotei , 2023-04-28,2023-05-10
ジョイスティック固定 :stick , 2023-07-14,1d
超音波センサ用カウル穴あけ :hole , 2023-07-21,1d
section 電装全体
BBM統合 :milestone , 2023-02-21,1d
基板設計 : pcb, 2023-02-03,2023-03-01
FM基板実装 :milestone , 2023-03-06,1d
ケーブル製作 : cable, 2023-05-10,2023-05-19
予備基板実装 : cable, 2023-07-24,2023-07-28
section メインマイコン
構成部品候補の調査 :research , 2022-10-17,2022-11-01
音声合成ICハードウェア :callout_integrate , 2022-12-01 , 2022-12-15
内蔵センサー値取得 :sense ,2023-01-10 , 2023-01-17
SD記録 :sd , 2023-01-17 , 2023-01-24
スケジューリング :sche , 2023-01-24 , 2023-01-31
操舵量取得 :ctrl , 2023-01-31 ,2023-02-06
SD高速化 :sd_fast ,2023-03-06 ,2023-03-09
合成音声仕様決定 :callout_spec , 2023-04-07 , 2023-04-14
音声合成ICコマンド解析 :callout, 2023-04-14,2023-04-31
スピーカーアンプ動作確認 :speaker_amp, 2023-05-12, 2023-05-15
音声合成関連データ処理 :alt , 2023-05-11 , 2023-07-28
SDデバッグ : sd, 2023-05-18,2023-06-01
SDスプーリング用マイコン追加 : sd, 2023-06-02,2023-06-17
修正基板設計 : pcb, 2023-06-03,2023-06-07
修正基板実装 : pcb, 2023-06-14,2023-06-16
section 操舵系
ICSサーボ引き継ぎ :ICS , 2022-12-02 , 1d
BBM完成 :milestone , 2022-12-09
ジョイスティック選定 :stick , 2023-01-31 , 2023-02-06
サーボケーブル製作 :cable , 2023-06-08 , 2023-06-09
テール桁サーボ固定 :servo , 2023-06-28 , 1d
section 電源部
電気的仕様決定 :power , 2023-04-07 , 2023-04-14
外装設計・製作 :case , 2023-04-14 , 2023-04-28
ケーブルの取り付け方向を変え再製作 :cable , 2023-06-12 , 2023-06-14
section 機体下電装部
超音波センサ選定 :sonic , 2022-11-29 , 2022-12-02
BBM完成 :milestone , 2022-12-15
プログラム : pitot,2023-04-28,2023-05-19
section エアデータ電装部
プログラム : pitot,2023-04-14,2023-05-19
固定用フランジ製作 : pitot,2023-05-17,2023-05-24
AB翼内ケーブルコネクタはんだ付け : connector,2023-05-25,1d
基板故障 : milestone,2023-06-04,1d
デバッグ・基板再製作 : pitot,2023-06-05,2023-06-14
先端部・カバー製作 : pitot,2023-07-03,2023-07-14
section カメラ
カメラ選定 :camera , 2023-02-04 , 1d
カメラ非搭載判断(画質不足) :camera , 2023-06-14 , 1d
section テレメトリ
仕様決定 :tele_need , 2023-03-09 , 2023-03-11
乗り込み練用送受信機製作 :air_hard , after tele_need , 2023-03-16
無線ハブ基板設計 :radio_design , 2023-04-07 , 2023-04-14
無線ハブ基板実装 :radio_impl , 2023-04-21 , 2023-04-28
プログラム :radio_program , 2023-04-14 , 2023-05-12
全データダウンリンク :radio_all , 2023-05-22 , 2023-05-26
テレメトリ受信機基板設計 : radio_design , 2023-06-02 , 2023-06-06
基板実装 : pcb, 2023-06-14,2023-06-16
section テスト
水没試験 :water , 2023-02-22 , 1d
ロングラン試験(全組中) :longrun , 2023-06-11 , 1d
温度環境試験(TF) :sunlight , 2023-07-07 , 1d
End-to-End試験 :e2e , 2023-07-28 , 1d
section 鳥科全体
桁試験 : milestone, 2022-12-27,1d
新歓 : milestone, 2023-04-06,1d
初全組 : milestone, 2023-06-04,1d
初TF : milestone, 2023-06-17,1d
鳥コン : milestone, 2023-07-30,1d
section 班長の都合
ロケット打上げ :rocket_voilet, 2022-11-11,2022-11-13
中間試験 :mid, 2022-11-08,2022-11-16
ロケット審査書 :rocket_happa , 2022-12-30,2023-01-27
期末試験 :last , 2023-01-17,2023-01-25
インターン :AE , 2023-03-20,2023-04-05
インターン :AE2 , 2023-06-01,2023-06-23</div><script>(function(){if(window.isMermaidLoaded)return;window.isMermaidLoaded=true;const script=document.createElement('script');script.src='https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js';script.onload=()=>{mermaid.initialize({startOnLoad:true});};document.body.appendChild(script);})();</script><ul><li>BBM : ブレッドボードモデル，試作<br><img src=/images/blog/birdman-glider-avionics/BBM.png alt loading=lazy></li><li>EM : エンジニアリングモデル，FM同等品なのでPM(プロトタイプモデル)寄りかも<br>(23代電装では省略したが，結果的にはFMを作り直したので一回目のFMがEM扱い)<br><img src=/images/blog/birdman-glider-avionics/EM.jpg alt loading=lazy></li><li>FM : フライトモデル，本番用<br><img src=/images/blog/birdman-glider-avionics/FM.jpg alt loading=lazy></li></ul><h2 id=基本設計>基本設計</h2><p>要求から設計への落とし込みの根拠</p><ul><li>癖のある設計はしてないつもりなので，特記事項のみ↓</li><li>各コンポートの必要性<ul><li>機体下：超音波センサを機体下部に搭載する必要</li><li>エアデータ：センサーを機体外部に搭載する必要</li><li>ジョイスティック：アナログジョイスティックのすぐ近くに配置する必要</li><li>電源部：防水が必要な区画を最小限にするため独立</li><li>スピーカー：聞きやすい位置に配置するため独立</li><li>ラダー：垂直尾翼の機構にサーボのみ配置</li><li>無線ハブ：Arduino Dueのシールドのフットプリントに入らなかったので独立</li><li>メイン：スペース的にどのコンポーネントにも統合できないので独立</li></ul></li><li>メインマイコンはArduino Due一択<ul><li>マイコンの駆動電圧は3.3V（センサーの制約）</li><li>UARTがたくさんほしい</li><li>有名なArduino互換ボードでこれらを満たすのはDueのみ</li><li>選定時点でRaspberry Pi Picoはわりと新製品でDueしかなかった</li></ul></li><li>他のマイコンは小さいのでSeeed Studio XIAO</li><li>ラダーのサーボモーターは鳥科で代々使ってる近藤科学の<a href=https://kondo-robot.com/product/krs-4034hv-ics>KRS-4034HV ICS</a><ul><li>トルクについて定量的な要求を出すのは難しいが，前年これで不足しなかった</li><li>前年と同じアルミのサーボホーンが使えるため機構の設計が楽</li><li>テールヘビーを避けるため軽量なものが良い</li><li>ケーブルが長くなるのでPWMではなくシリアル通信が良い</li><li>（まず無いけど，）水平を電装で制御したくなった場合でも，複数のサーボをデイジーチェーン接続できるので電装の設計変更が少ない</li></ul></li><li>ジョイスティック電装部と機体下電装部は搭載位置が近くても統合しない<ul><li>操舵系はクリティカルなため余計な機能を混ぜない</li></ul></li><li>エアデータ電装部は有線接続（電源通信両方）<ul><li>TWELITEはスループット，レイテンシともに不足</li><li>電装班の技術力的に通信は有線の方が安心<br>（Bluetooth/WiFiは経験が無かったから避けた）</li><li>電源は独立でも良いが，通信は有線なのでまとめて有線</li></ul></li><li><del>姿勢取得のためにカメラを搭載</del><ul><li><del>センサーデータを使うよりカメラ映像の方が確実</del><br>カメラから翼の上下がほとんど見えなかったので削除</li></ul></li><li>電源設計<ul><li>サーボモータ用に3セルのLiPoバッテリーを搭載</li><li>火災防止のためサーボに過電流保護を挟んで供給，逆接保護は省略</li><li>電源はサーボ用のLiPoバッテリーのみで，ロガー系もこれから供給する<ul><li>それぞれのマイコンには独立した過電流保護を挟んで供給する</li><li>ロガー系からの波及故障のリスクよりも，電源を分散させる手間の方が大きいと判断</li><li>舵角計測のため操舵系の信号線がロガー系に繋がっているため，電源を完全に分離してまで波及故障を防ぐのは意味がない</li><li>電源を分散させると，各機器の起動タイミングによる問題・各バッテリーの残量管理の手間・電源投入の手間が増える</li></ul></li></ul></li><li>姿勢モニタの受信側のデバイスはスマホのシリアルモニタ<ul><li>液晶・7segを使うのは技術的にダルい</li><li>スマホアプリの開発は面倒だけど，シリアルモニタならアプリがあるから楽</li></ul></li></ul><h3 id=全体像>全体像</h3><p><img src=/images/blog/birdman-glider-avionics/overvirew.svg alt=overvirew loading=lazy><br>初期案からの変更点（独立したエアデータ電装部の構成は参考）</p><ul><li>テレメトリのためTWELITEを追加</li><li>カメラを廃止</li><li>SDカードをDue直結ではなくスプーリング用のXIAO経由に変更（<a href=#SD%E3%82%AB%E3%83%BC%E3%83%89%E3%82%B9%E3%83%97%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0>詳細</a>）<ul><li>GPSとTWELITEをセットにした基板を製作済みだったので，操舵角計測でRXを使っているポートのTXをSD用に使用し，これらのポートは115200bpsにした．</li><li>RX側はGPSが460800bpsまでで操舵角が115200bps(頑張れば変更可)，TX側はTWELITEが230400bpsまでで，SDにはなるべく早いボーレートを使いたい．このため本来はGPSとSD，操舵角とTWELITEの組み合わせが良い．</li><li>エアデータ電装部・機体下電装部はSD書き込み以外のタスクもあるため460800bpsにしたが，SD書き込みのみは115200bpsで足りた．</li></ul></li></ul><h3 id=物理的な配置>物理的な配置</h3><p><img src=/images/blog/birdman-glider-avionics/arrangement.svg alt=arrangement loading=lazy></p><ul><li><del>メイン電装部には電装ハッチを用意</del></li><li>ジョイスティック電装部はパイロットが操作しやすい位置に</li><li>機体下電装部は超音波センサを湖面に垂直に向けることができれば場所は任意</li><li>スピーカー部は場所は任意(音が聞こえるならメイン電装部に統合も可)</li><li>エアデータ電装部は<del>コクピ上</del><ul><li>設計陣との調整で翼から生やすことになった</li><li>三面図提出時点で左翼に配置で確定</li><li>重量バランスはダミーウェイトで調整する(同じものを2つ作るのは非常に難易度が高く，UARTのポートも空いてない)</li></ul></li></ul><h3 id=質量概算>質量概算</h3><table><thead><tr><th>コンポーネント</th><th>寸法[mm]</th><th>質量[g]</th><th>memo</th></tr></thead><tbody><tr><td>メイン電装部</td><td>100×150×70</td><td>300~600</td><td><a href=https://www.amazon.co.jp/dp/B07XXQST52/>Lipo</a>が60g，Dueが60g，防水をちゃんとやると+300g</td></tr><tr><td><del>カメラ</del></td><td><del>81x65x78</del></td><td><del>200</del></td><td><del>防水ハウジング含む</del></td></tr><tr><td><del>カメラ</del></td><td><del>48x50x53</del></td><td><del>85</del></td><td><del>本体が防水</del></td></tr><tr><td>エアデータ電装部</td><td>あざみ野ぐらい</td><td>40</td><td>ピトー管含めた電装部品のみの質量，AoA・AoS無し</td></tr><tr><td>機体下部電装部</td><td>50mm四方の基板一枚</td><td>20</td><td>ロケットのノーズが20g</td></tr><tr><td>ジョイスティック電装部</td><td>50mm四方の基板一枚+ジョイスティック</td><td>30</td><td>ジョイスティックのサイズに依存</td></tr><tr><td>ラダー部</td><td>43×32×33</td><td>60</td><td><a href=https://kondo-robot.com/product/krs-4034hv-ics>サーボモータ</a>のみ</td></tr><tr><td>スピーカー部</td><td>直径50ぐらい</td><td>50</td><td>音量を求めると重くなるかも</td></tr></tbody></table><h2 id=詳細設計製作>詳細設計・製作</h2><p>電装は作ってみないと設計が固まらないので詳細設計と製作はほぼ同じ．</p><p><strong>とにかく要求を満たすものを作れれば良いので，手を動かしていろいろ試しつつ，設計の根拠はしっかり記録に残す．</strong></p><h3 id=全体>全体</h3><h4 id=uartフォーマット>UARTフォーマット</h4><p>桁が固定されていない小数をカンマ区切りで送信し，改行コードLF(\n)をつける． <del>ボーレートは115200bpsとする．</del> SD用マイコンは通信速度が足りなかったので460800bps．</p><p>機体下電装部->メイン電装部<br><code>気圧[hPa],温度[deg],気圧高度[m],超音波高度[m]</code></p><p>エアデータ電装部->メイン電装部<br><code>気圧[hPa],温度[deg],気圧高度[m],差圧[Pa],対気速度[m/ss]</code></p><p>メインマイコンからは，<a href=#SD%E3%82%AB%E3%83%BC%E3%83%89%E3%82%B9%E3%83%97%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0>SD用マイコン</a>・機体下電装部・エアデータ電装部のmicro SDに保存する文字列を直接送信する．</p><h4 id=コネクタケーブル>コネクタ・ケーブル</h4><ul><li>すべて手で圧着はせず，コネクタ付きのケーブルやアッセンブリワイヤーなどを使用する．</li><li><del>ケーブル同士の接続には基本的には半田スリーブを使用する．ただし芯線が細かったりヒートガンが使えない場所では，普通にはんだ付けして熱収縮チューブで保護する．</del><br>フラックスを使っても半田が芯線にのらなかったので(特に細いケーブル)，半田付けは手で行うことにした．ただし，細いケーブルでも被膜にスリーブを固定できるのでホットメルト接着剤リングは有用だった．半田付けは手で行った上で半田スリーブを熱収縮チューブとして使用する．
<img src=/images/blog/birdman-glider-avionics/sleeve.jpg alt loading=lazy></li><li><a href=https://www.amazon.co.jp/gp/product/B0811BSJ8R/>半田スリーブ(白)</a><ul><li>AWG26-24用らしいけど22までは使える</li></ul></li><li>コネクタ<ul><li>汎用：JST-XHコネクタ<ul><li>2,3,4,5ピンの在庫がある</li><li>PAコネクタのほうが抜き挿ししやすいけど入手性が悪い</li><li>半田スリーブを使うと2.0mmピッチは狭い，XHは2.5mmピッチ</li><li><a href=https://www.daisen-netstore.com/shopdetail/000000000152/>XHアッセンブリワイヤー</a></li></ul></li><li>中継：JST-SMコネクタ<ul><li>中継用ならこれ</li><li>TORICA-UARTの中継<ul><li><a href=https://www.amazon.co.jp/gp/product/B07RQ4DKS9/>SMケーブル</a><ul><li>シールドふくめて5Pを使用</li><li>ピトー管用だとHR30も良さそうだけどアッセンブリワイヤーが売ってない</li></ul></li></ul></li><li>サーボの中継<ul><li><a href=https://www.amazon.co.jp/gp/product/B07RR7JD52/>SMケーブル</a><ul><li>シールドふくめて4Pを使用</li><li>最大電流3Aで，他のいい感じの中継コネクタもないからこれで</li></ul></li></ul></li></ul></li><li>サーボの差し込み部分のコネクタ<ul><li><a href=https://www.amazon.co.jp/gp/product/B07H6RQBLH/>サーボ専用の端子</a>は使わない</li><li>サーボに付属する専用のケーブルを切って接続する</li></ul></li><li>4P TORICA-UART<ul><li>1 黒 GND シールド</li><li>2 赤 5V</li><li>3 緑 Due TX - XIAO RX DTXR</li><li>4 白 Due RX - XIAO TX DRXT</li></ul></li><li>5P ICS-UART<ul><li>1 黒 GND</li><li>2 赤 5V</li><li>3 緑 ICS TX - XIAO RX ITXR</li><li>4 白 ICS RX - XIAO TX IRXT</li><li>5 青 EN</li></ul></li><li>4P JOYSTICK<ul><li>1 黒 GND</li><li>2 赤 3.3V</li><li>3 緑 X</li><li>4 白 Y</li></ul></li><li>4P サーボ<ul><li>黒 GND</li><li>赤 LiPo VCC</li><li>白 ICS</li><li>青 シールド</li></ul></li></ul></li><li>ケーブル<ul><li>シールドの扱い<ul><li>すべて<a href=https://metoree.com/categories/shielded-cable/>静電シールド</a>なので，電源に近い方側でシールドをGNDに接続する</li><li>サーボケーブルも近くに他の信号線はないので，ノイズを漏らさない電磁シールドケーブルではなく周囲からのノイズを防ぐ静電シールドケーブル</li></ul></li><li>サーボ・電源用ケーブル<ul><li><del><a href=https://www.monotaro.com/p/3496/7344/>FA用300V電源・低速移動屈曲配線ケーブルシールド有</a></del><ul><li>3芯・シールドあり・AWG22(QIコネクタ,2550コネクタの最大)・3m以上</li></ul></li><li><a href=https://shop.oyaide.com/products/s_vsvc_3.html>坂東電線 軟質マイクコード スーパーフレックス VSVC 3芯</a><ul><li>3Aが流せるなかで一番細いAWG24に変更</li></ul></li></ul></li><li>その他信号用ケーブル<ul><li><a href=https://www.monotaro.com/g/01117577/>シールド付きスリムロボットケーブル</a></li><li>↑とモノタロウでまとめて買ってもいいけど千石でも売ってる</li></ul></li></ul></li></ul><h4 id=ブートローダー小噺>ブートローダー小噺</h4><p>Arduinoにはブートローダーというものがある．他にも役割があるが，PCと通信を行いフラッシュメモリにプログラムを書き込む役割を持つ．</p><ul><li><a href=https://store.arduino.cc/products/arduino-due>Arduino Due</a><ul><li>ブートローダーはチップ内蔵のROMに書かれていて，フラッシュメモリが消去されるとプログラムを書き込めるようになる．ROMなので破壊はされない．</li><li>メインのマイコンがAT91SAM3X8Eで，Programming Portからの書き込みを担当するATmega16U2はAT91SAM3X8EのEraseピンとハードウェアで接続されているため，AT91SAM3X8Eがクラッシュしていてもフラッシュメモリを消去して書き込みを行うことができる．</li><li>Programing PortはAT91SAM3X8EのUART0を使用するため，これとは別にNative Portからの書き込み方法も用意されている．これはAT91SAM3X8EのUSBポートを使用したものでソフトウェア的にフラッシュメモリを消去して書き込みを行う．AT91SAM3X8EがクラッシュしているとNative Portからの書き込みはできない．</li></ul></li><li><a href=https://arduino-pico.readthedocs.io/en/latest/install.html#uploading-sketches>Seeed Studio XIAO RP2040</a><ul><li>RP2040のバイナリ書き込みはチップ内のROMに書かれていて，BOOTボタンを押して接続してuf2ファイルをアップロードする方式の書き込みを担う．</li><li>arduino-picoを使用してBOOTボタンを押さずにArduino IDEからアップロードする方式に対応するブートローダーはチップ外付けのフラッシュに書き込まれ，これは破壊されうるがBOOTボタンを押した書き込みで復活できる．</li></ul></li><li><a href=https://labo.mycabin.net/electronics-programming/arduino-samd/1517/amp/>Seeed Studio XIAO SAMD21</a><ul><li>チップはSAMD21G18で，このフラッシュメモリにブートローダーが書かれている．USBからの書き込みはこれが壊れると他に手段はなくなる．ブートローダーの書き込み時にここを書き込み禁止に設定できるが，工場出荷時はこの設定がされていないらしい．</li></ul></li></ul><p>配列外参照をしたり割り込み関連で事故ったりするとブートローダーを含むフラッシュのプログラムが壊れるリスクがあり，XIAO SAMD21の場合はこれが回復不能なダメージとなる．<br>復活させる方法もあるが，かなり面倒なので同じフォームファクタのXIAO RP2040を使うことにした．</p><ul><li>(参考)メモリの種類<ul><li>ROM(Read Only Memory)<ul><li>工場で書き込まれた後，ユーザーは書き換えられないメモリ</li><li>パソコンで例えるとBIOSあたり</li></ul></li><li>RAM(Random Access Memory)<ul><li>マイコンが動作するために必要なメモリ</li><li>パソコンで例えると16GBとかのメモリ</li></ul></li><li>フラッシュメモリ<ul><li>プログラムを書き込むためのメモリ</li><li>パソコンで例えるとSSDとか</li></ul></li></ul></li></ul><h3 id=コンポーネントごと>コンポーネントごと</h3><h4 id=電源部>電源部</h4><ul><li>サーボの過電流保護<ul><li><a href=https://akizukidenshi.com/catalog/g/gP-12630/>リセッタブルヒューズ</a>を挟む<ul><li><a href=https://detail-infomation.com/poly-switch/>【ポリスイッチとは】ヒューズとの違いは？</a></li><li>トリップ電流(遮断しうる最小電流)：6.0A > サーボの最大消費電流</li><li>遮断電流(瞬時に遮断する電流)：40A</li><li>保持電流(遮断後に流れ続ける電流)：3.0A</li><li>温度上昇でディレーティングしても(保持1.56A/トリップ3.12A@85℃)なのでセーフ</li></ul></li><li>サーボの最大消費電流は3.1A</li></ul></li><li>電源スイッチ<ul><li>サーボ無しでも200mA程度消費するので，なんらかの電源スイッチは必要</li><li>サーボの最大負荷を想定し，12V5A定常的に流せる回路を作る</li><li>半導体スイッチを使うフライトピンは電気的に複雑になので不採用（<a href=https://twitter.com/771_8bit/status/1646459711523549184>参考</a>）</li><li>電源スイッチは<a href=https://akizukidenshi.com/catalog/g/gP-12710/>レバーロック式のトグルスイッチ</a>を使う</li></ul></li><li>電圧電流計<ul><li>バッテリーの電圧監視のために<a href=https://akizukidenshi.com/catalog/g/gM-09738/>電圧計DE-2645-02</a>をつける</li><li>短絡，モータの過負荷が分かるように電流も測定できるものを選定</li></ul></li><li>電源BOX<ul><li>バッテリー本体とヒューズのみを防水し，他は面倒なので対策しない（SDカードもOK）</li><li>防水には<a href=https://www.amazon.co.jp/gp/product/B001UJJAI8>ロック付きのタッパー</a>を使う<ul><li>透明なのは必須</li></ul></li><li><del>搭載するバッテリーは<a href=https://www.amazon.co.jp/dp/B017VOL574>Kypom K6 11.1V 2200mAh 35C70C</a></del><ul><li><del>Eclatと同じ</del><br>軽量化のため<a href=https://www.amazon.co.jp//dp/B017VOKZHK>Kypom K6 11.1V 850mAh 35C70C</a>を搭載</li></ul></li><li>以下のケーブルをケーブルグランドを使って出す<br>（どちらも同じ量の電流が流れる）<ul><li>メイン電装に供給する電源ケーブル</li><li>電源スイッチにつなぐケーブル</li></ul></li><li><a href="https://www.monotaro.com/p/8836/5961/?displayId=5">ケーブルグランドPG7</a><ul><li>選定は適合ケーブル径だけ見れば基本OK<ul><li>防水等級はIPX7で良い．IPX8はいらない．</li></ul></li><li>これの取付穴径(ドリルで開ける穴)は12.7mm</li><li>ケーブルグランドつけてもコネクタのせいで結局取り外しはできないので，シーリング材で固定しても良い</li><li>今回は鳥科に在庫あって見た目もいいから採用</li><li>ケーブルの長さの調整ができるのがややメリット？<br><img src=/images/blog/birdman-glider-avionics/power.png alt=power loading=lazy></li></ul></li></ul></li></ul><ul><li>マイコンへの電源供給<ul><li>それぞれに<a href=https://akizukidenshi.com/catalog/g/gM-07179/>M78AR05-0.5</a>を使用</li><li>過電流保護を搭載(入力側にスパイクがないことを確認済み・自動復帰あり)</li><li>電源に近い部分に過電流保護を持たせるため，DCDCはメイン基板に搭載し5Vをケーブルで配電する</li><li>基本的にDCDCは<a href="https://akizukidenshi.com/catalog/goods/search.aspx?keyword=&maker=minimax&goods=m&number=m78ar&sort=g&style=T&search.x=68&search.y=24">M78ARシリーズ</a>がおすすめ</li><li>(出力側からの逆流対策が甘いので改善が必要)</li></ul></li><li>コンデンサ配置<ul><li><a href=https://www.arduino.cc/en/uploads/Main/arduino-Due-schematic.pdf>Arduino Dueの回路図</a>参考<ul><li>VINに47uFついてる．</li><li>DCDCで5Vに落とす．VIN側に10uF，5.5V側に47uFついてる．</li><li>5Vからレギュレータで3.3Vに落とす．3.3V側に10uFついてる．</li></ul></li><li>GPSとスピーカーの消費電流が大きいので，5Vラインにコンデンサを外付けする．</li><li>XIAOが載った基板にはコンデンサを外付けする．</li></ul></li></ul><h4 id=メイン電装部>メイン電装部</h4><h5 id=ハードウェア>ハードウェア</h5><table><thead><tr><th>部品</th><th align=center>個数</th><th align=right>価格</th></tr></thead><tbody><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-07386/>Arduino Due</a></td><td align=center>1</td><td align=right>6,920</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-17044/>Seeeduino XIAO RP2040</a></td><td align=center>1</td><td align=right>830</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gK-05488/>マイクロSDカードスロットDIP化キット</a></td><td align=center>1</td><td align=right>300</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gK-16996/>9軸センサ BNO055</a></td><td align=center>1</td><td align=right>2,450</td></tr><tr><td><a href=https://www.switch-science.com/products/6286>気圧センサ DPS310</a></td><td align=center>1</td><td align=right>1,408</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-12905/>GPS(GT-902PMGG)</a></td><td align=center>1</td><td align=right>2,480</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-07179/>M78AR05-0.5</a></td><td align=center>3</td><td align=right>480</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gI-08327/>整流ダイオード1N4007-B</a></td><td align=center>4</td><td align=right>100</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gI-09973/>音声合成LSI ATP3012F6-PU</a></td><td align=center>1</td><td align=right>1,100</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gP-09576/>セラミック発振子 CSTLS16M0X53-B0</a></td><td align=center>1</td><td align=right>35</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-12505/>TWELITE RED DIP</a></td><td align=center>1</td><td align=right>3,030</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gP-10958/>アンテナ TWE-AN-D85</a></td><td align=center>1</td><td align=right>550</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gC-10960/>アンテナケーブル</a></td><td align=center>1</td><td align=right>550</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gI-06247/>抵抗内蔵5mm青色LED</a></td><td align=center>1</td><td align=right>200</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gP-12406/>トグルスイッチ 1回路2接点</a></td><td align=center>1</td><td align=right>90</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gP-00301/>トグルスイッチ 2回路2接点</a></td><td align=center>1</td><td align=right>100</td></tr></tbody></table><ul><li><p>気圧センサ</p><ul><li>調べた限り気圧センサはDPS310が一番高精度<blockquote class=twitter-tweet><p lang=ja dir=ltr>DPS310精度やばすぎて草<br>これが静電容量式気圧センサの力か… <a href=https://t.co/TUkWzHqA4O>pic.twitter.com/TUkWzHqA4O</a></p>&mdash; だん (@kogakudanshi) <a href="https://twitter.com/kogakudanshi/status/1538601537483972610?ref_src=twsrc%5Etfw">June 19, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></li></ul></li><li><p>9軸センサ</p><ul><li>姿勢計算までやってくれるのでBNO055を使う</li><li>加速度角速度磁気だけの場合はマイコン側でカルマンフィルタなりMadgwickフィルタなりを回す必要がある</li></ul></li><li><p>GPS</p><ul><li>GPSはu-bloxが一番信頼できる</li><li>GPSは受信RXだけ，TWELITEは送信TXだけのため，1つのUARTポートで処理を行える<br><img src=/images/blog/birdman-glider-avionics/hub_BBM.JPG alt loading=lazy></li></ul></li><li><p>micro SD</p><ul><li><a href=https://ht-deko.com/arduino/micro_sdcard.html>ピン配置</a></li></ul></li><li><p>音声合成用スピーカー</p><ul><li>アンプつきスピーカー候補(可変抵抗による音量調整機能付き)<ul><li><a href=https://www.switch-science.com/products/5888#erid10755820>Adafruit(あざみ野2022)</a></li><li><a href="https://www.sengoku.co.jp/mod/sgk_cart/detail.php?code=EEHD-54PR">Seeed Studio</a></li></ul></li><li>結局音量が足りなかったのでアンプとスピーカーをバラで購入<ul><li><a href=https://akizukidenshi.com/catalog/g/gK-08217/>PAM8012使用2ワットD級アンプモジュール</a> 電源と信号いれてスピーカーに繋げるだけ</li><li><a href=https://akizukidenshi.com/catalog/g/gP-16024/>スピーカーユニット 5cm 8Ω0.5W</a> ネジ穴があり結束バンド固定が可能</li></ul></li></ul></li><li><p>TWELITE</p><ul><li>TWELITEはREDの方が出力が高い</li><li>アンテナは<a href=https://mono-wireless.com/jp/products/TWE-ANTENNAS/dipole/index.html>ダイポール</a>なので縦向きに設置する</li><li>TWELITEは事前に<a href=https://771-8bit.com/blog/twelite-uart/>設定</a>が必要</li><li>チャンネルは干渉対策のためデフォルトからずらすと良い</li></ul></li><li><p>スイッチ</p><ul><li>サーボの通信線と計測用のArduino Dueの間の接続をトラブル時に切れるようにトグルスイッチを使用する</li><li><a href=#%E3%83%A1%E3%82%A4%E3%83%B3%E9%9B%BB%E8%A3%85%E3%81%AE%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF>Programming Port</a>とエアデータ電装部の通信を切れるようにトグルスイッチを使用する</li><li>万一パイロットが接触しても問題ないよう，トグルスイッチは機体後方に倒れる向きが通常となるようにする</li></ul></li></ul><h5 id=ソフトウェア>ソフトウェア</h5><p>SDカードの書き込みに時間がかかり，<a href=https://e-words.jp/w/%E3%83%80%E3%83%96%E3%83%AB%E3%83%90%E3%83%83%E3%83%95%E3%82%A1%E3%83%AA%E3%83%B3%E3%82%B0.html>ダブルバッファ</a>を使って書き込むデータを管理してSD書き込み以外を割り込みで処理しようとしたが，起動から数分後にマイコンがハングアップする問題が解決できなかった．SDアクセス中もUART受信割り込みなどは動作しているはずで，SDカードアクセスに使用する割り込みとタイマ割り込みの優先度の問題やリソースの競合が原因と考えているが，ダブルバッファの実装が原因の可能性も否定はできず，デバッグに時間がかかりそうだったのでハードウェアの仕様変更により解決した．</p><details><summary>[廃止]タイマ割り込みを使ったスケジューリング</summary><ul><li>用意するタイマ割り込み<ul><li>100Hz</li><li>200Hz</li></ul></li><li>I2Cセンサーの計測<ul><li>I2C接続のセンサーとの通信は一連の送受信が高速に行われるためプリエンプションを認めない．</li><li>プリエンプションを認めないため，優先度の高いタイマ割り込みで処理を行う．</li><li>ISRの起動周期は100Hzとする．<ul><li>BNO055は通信時にデータを計測し，100Hzで取れる．</li><li>DPS310は32Hzでデータを計測し，ISRで最新値を取得する．</li></ul></li><li>I2Cの速度はBNO055の最大の400kHzとする(DPS310はMHzクラス)．</li></ul></li><li>UART送信<ul><li>機体下部電装部・エアデータ電装部のmicro SD記録用のデータ送信はISRに合わせて100Hzで行う．</li></ul></li><li>UART接続のGPS・マイコン(機体下電装部・エアデータ電装部・ジョイスティック電装部)の受信<ul><li>UART受信データはマイコン内のバッファに貯まるため，プリエンプション(中断)されることを認める．</li><li>I2Cセンサーの処理を優先させるため，そのISRより高い優先度にはしない．</li><li>ISRの起動周期は<del>500Hz</del>200Hzとする．<del>500</del>200の根拠は最大<del>250</del>の2倍(サンプリング定理の気持ち)．ペリフェラルにはアクセスせずマイコン内の処理で完結するので<del>500Hzの</del>高速起動で問題ない(と思っていたが，micro SDへの書き込み量が増えるためデータ量は落とさないとダメだった)．<ul><li>UARTの受信周期は以下の通り<ul><li>ICS <del>250Hz</del> 100Hz</li><li>エアデータ電装部 <del>100Hz</del> 32Hz</li><li>機体下部電装部 <del>100Hz</del> 32Hz</li><li>GPS 10Hz</li></ul></li></ul></li></ul></li><li>SDへの書き込み<ul><li>SDカードへのアクセスは時間がかかるため，SPIをSDカード専用バスとする．</li><li>SDカードへのアクセスはプリエンプションを認める．</li><li>優先度が低いためメインループで処理を行う．</li></ul></li><li>TWELITEでのダウンリンク<ul><li><del>1</del>4Hzでダウンリンクを行う．（体感で読みやすい速度に調整）<ul><li>頻度が低いのでloop内で<code>millis()</code>を使ってタイミングを管理して4Hzで実行する．<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-cpp data-lang=cpp><span class=kt>uint32_t</span> <span class=n>now_time</span> <span class=o>=</span> <span class=n>millis</span><span class=p>();</span>
<span class=k>static</span> <span class=kt>uint32_t</span> <span class=n>last_time</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
<span class=k>if</span> <span class=p>(</span><span class=n>now_time</span> <span class=o>-</span> <span class=n>last_time</span> <span class=o>&gt;=</span> <span class=n>FUNCTION_PERIOD</span><span class=p>)</span> <span class=p>{</span>
  <span class=n>last_time</span> <span class=o>=</span> <span class=n>now_time</span><span class=p>;</span>
  <span class=n>some_function</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div></li></ul></li><li>割り込み含めてを全ての初期設定を終えたあと全データを一度だけダウンリンクする．<ul><li>ただしGPSはロックまで時間がかかるのでダウンリンクしない．</li><li>大量のデータを一度に送信するとマイコン側の処理が詰まるのである程度時間を分けてダウンリンクする必要がある．</li></ul></li></ul></li><li>音声合成IC<ul><li><a href=https://akizukidenshi.com/catalog/g/gI-09973/>秋月商品ページ</a></li><li>音声合成ICとの通信はプリエンプションしても問題ないが，プリエンプションを認めないI2Cセンサーと独立させるためにI2C1に接続する．</li><li>通信で厳密なリアルタイム性を求めないことは<a href="https://akizukidenshi.com/download/ds/a-quest/atp3012_datasheet.pdf#page=11">音声合成ICのタイミングチャート</a>で確認した．</li><li>優先度が低いためメインループで処理を行う．</li><li>I2C関連<ul><li><a href=https://eiseilab.com/i2c/>I2C概要</a></li><li><a href=https://eiseilab.com/arduino-i2c/>ArduinoでI2C</a></li><li>I2Cの速度はICの最大の400kHzとする．<ul><li><a href=https://www.arduino.cc/reference/en/language/functions/communication/wire/setclock/>I2C高速化</a></li></ul></li></ul></li></ul></li></ul><table><thead><tr><th>タスク名</th><th>起動周期</th><th>優先度</th><th>中断</th><th>概要</th></tr></thead><tbody><tr><td>ISR_100Hz()</td><td>100Hz</td><td>14</td><td>禁止</td><td>メインマイコン内のセンサーデータ取得，機体下部電装部・エアデータ電装部・GPSからのデータ受信，機体下部電装部・エアデータ電装部へのSD保存文字列送信</td></tr><tr><td>ISR_200Hz()</td><td>200Hz</td><td>15</td><td>許可</td><td>ジョイスティック電装部からのデータ受信</td></tr><tr><td>main_SD.flash()</td><td>&mdash;</td><td>loop()</td><td>許可</td><td>SDカードへの書き込み</td></tr><tr><td>TWE_downlink()</td><td>4Hz</td><td>loop()</td><td>許可</td><td>TWELITEへのダウンリンク</td></tr><tr><td>callout_altitude()</td><td>TBD</td><td>loop()</td><td>許可</td><td>高度の読み上げ</td></tr></tbody></table><ul><li>タイマ割り込み詳細<ul><li>優先度含めた割り込みの設定，タイマ以外のセンサーなどの初期設定を全て終えてから割り込みをスタートさせる．</li><li>タイマ割り込みにはDueTimerを使用した上で優先度を設定する．優先度は0(最高)～15(最低)で表される．</li><li>TC1ブロックに含まれるTimer3をISR_100Hzに，Timer4をISR_200Hzに割り当てる．</li></ul><blockquote><p>DUEでは標準ではTC1のブロックは使用していないらしい <a href=http://jtakao.web.fc2.com/elec/due_timerinterrupt/index.html>参照</a></p></blockquote><ul><li>SysTick(delay()やmillis()に利用)の優先度(デフォルト15)の優先度をタイマ割り込みより高くする．</li><li>ISR_100Hz()のTimer3の優先度を，ISR_200Hz()のTimer4の優先度より高くする．</li><li>UARTの処理をISRで行うため，タイマの優先度をUART受信割り込み(優先度不明)より低くする．とりあえずめっちゃ低く．</li><li>優先度はNVIC_SetPriority()により設定する．TC3_IRQnはTC3のことではなく，Timer3のことである．<a href=https://github.com/ivanseidel/DueTimer/blob/master/DueTimer.cpp#L17>参照</a></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-cpp data-lang=cpp><span class=n>Timer3</span><span class=p>.</span><span class=n>attachInterrupt</span><span class=p>(</span><span class=n>ISR_100Hz</span><span class=p>).</span><span class=n>start</span><span class=p>(</span><span class=mi>10000</span><span class=p>);</span>
<span class=n>Timer4</span><span class=p>.</span><span class=n>attachInterrupt</span><span class=p>(</span><span class=n>ISR_200Hz</span><span class=p>).</span><span class=n>start</span><span class=p>(</span><span class=mi>5000</span><span class=p>);</span>
<span class=n>NVIC_SetPriority</span><span class=p>((</span><span class=n>IRQn_Type</span><span class=p>)</span><span class=n>SysTick_IRQn</span><span class=p>,</span> <span class=mi>13</span><span class=p>);</span>
<span class=n>NVIC_SetPriority</span><span class=p>((</span><span class=n>IRQn_Type</span><span class=p>)</span><span class=n>TC3_IRQn</span><span class=p>,</span> <span class=mi>14</span><span class=p>);</span>
<span class=n>NVIC_SetPriority</span><span class=p>((</span><span class=n>IRQn_Type</span><span class=p>)</span><span class=n>TC4_IRQn</span><span class=p>,</span> <span class=mi>15</span><span class=p>);</span> 
</code></pre></td></tr></table></div></div><ul><li><a href=https://www.arduino.cc/reference/en/libraries/duetimer/>DueTimer</a></li><li><a href=http://jtakao.web.fc2.com/elec/due_timerinterrupt/index.html>割り込みの優先度詳解</a></li><li><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-11057-32-bit-Cortex-M3-Microcontroller-SAM3X-SAM3A_Datasheet.pdf#page=164">データシート該当部</a></li><li>Seeed Studio XIAO SAMD21もArduino Dueと同じARMアーキテクチャを採用したAtmel社のSAMシリーズのマイコンで，割り込みの設定はほぼ同じ．割り込みを管理する<a href=https://toshiba.semicon-storage.com/jp/semiconductor/knowledge/e-learning/tx03-series-microcontrollers/chapter2/role-nvic.html>NVIC</a>はARMアーキテクチャに含まれるもので，ここで優先度を設定する．ただし割り込みの優先度の深さはXIAOの場合は<a href="https://ww1.microchip.com/downloads/aemDocuments/documents/MCU32/ProductDocuments/DataSheets/SAM-D21-DA1-Family-Data-Sheet-DS40001882H.pdf#page=47">4まで</a>．</li></ul></li></ul></details><br id=SDカードスプーリング><p>SDアクセスの<a href=https://e-words.jp/w/%E3%82%B9%E3%83%97%E3%83%BC%E3%83%AB.html>スプーリング</a>用にXIAO RP2040を追加して，エアデータ電装部・機体下電装部へと同様にUARTで保存する文字列を送信する仕様にした．</p><div class="notices info" data-title=スケジューリングの気持ち><p>通常マルチタスクを行う場合，割り込みを用いて実行中のタスク切り替えて複数の処理を実行する．割り込みを使う場合，基本的には頻度の高いタスクに高い優先度を割り当てれば良く，レートモノトニックスケジューリングとなる．デッドラインが早い順に高い優先度を割り当てるEarliest Deadline First方式もあるが，この規模ではレートモノトニックスケジューリングの方がシンプルで制御しやすい．素のArduinoで限界の場合はFreeRTOSなどのRTOSを使うのも良いかもしれない．</p><p>今回はSDカードアクセス中にタイマ割り込みを使用したときマイコンがハングアップする問題が解決できなかった．このため割り込み無しの<a href=https://e-words.jp/w/%E3%83%8E%E3%83%B3%E3%83%97%E3%83%AA%E3%82%A8%E3%83%B3%E3%83%97%E3%83%86%E3%82%A3%E3%83%96%E3%83%9E%E3%83%AB%E3%83%81%E3%82%BF%E3%82%B9%E3%82%AF.html>ノンプリエンプティブマルチタスク</a>を行った．ノンプリエンプティブマルチタスクではCPUを独占しないように各タスクの実行時間を最小限にしてタスクを早い周期で順番に実行することが必要である．当然だが<code>delay()</code>を使わずに<code>millis()</code>などの時間関数でスケジューリングを行う．UARTの送信は複数回に分けることで実行時間を短く分割できたが，SDカードアクセスには時間がかかり解決できなかったため，ハードウェアを変更した．</p></div><p>基本的には100Hzで各処理を行い，独自のスケジューリングが必要なものは<code>loop()</code>から直接呼び出す．行儀は悪いが，<code>data_マイコン名_センサー名_データ種類_単位</code>と命名規則は統一したうえでグローバル変数に格納する．</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-cpp data-lang=cpp><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
  <span class=kt>uint32_t</span> <span class=n>ISR_now_time</span> <span class=o>=</span> <span class=n>millis</span><span class=p>();</span>
  <span class=k>static</span> <span class=kt>uint32_t</span> <span class=n>ISR_last_time</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>ISR_now_time</span> <span class=o>-</span> <span class=n>ISR_last_time</span> <span class=o>&gt;=</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ISR_last_time</span> <span class=o>=</span> <span class=n>millis</span><span class=p>();</span>
    <span class=n>func_100Hz</span><span class=p>();</span>
  <span class=p>}</span>

  <span class=c1>// 合成音声読み上げ
</span><span class=c1></span>  <span class=n>callout_status</span><span class=p>();</span>

  <span class=c1>// テレメトリダウンリンク(タイミングも関数内調整)
</span><span class=c1></span>  <span class=n>TWE_downlink</span><span class=p>();</span>
<span class=p>}</span>


<span class=kt>void</span> <span class=nf>func_100Hz</span><span class=p>()</span> <span class=p>{</span>
  <span class=c1>// GPS・操舵角・機体下電装部・エアデータ電装部読み取り
</span><span class=c1></span>  <span class=n>polling_UART</span><span class=p>();</span>

  <span class=c1>// フライトフェーズ判断(メインの加速度も測定)
</span><span class=c1></span>  <span class=n>determine_flight_phase</span><span class=p>();</span>

  <span class=c1>// 気圧センサ×3・超音波センサから高度推定
</span><span class=c1></span>  <span class=n>calculate_altitude</span><span class=p>();</span>

  <span class=c1>// SDに記録(メインの気圧高度も測定)
</span><span class=c1></span>  <span class=n>send_SD</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><ul><li><p>BNO055詳細<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L533C6-L551><code>read_main_bno()</code></a></p><ul><li><a href=https://akizukidenshi.com/catalog/g/gK-16996>秋月商品ページ</a></li><li><a href=https://www.mouser.jp/datasheet/2/783/BST_BNO055_DS000-1509603.pdf>チップデータシート</a></li><li><a href=https://www.arduino.cc/reference/en/libraries/adafruit-bno055/>Arduinoライブラリ</a></li></ul></li><li><p>DPS310詳細<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L553C6-L565><code>read_main_dps()</code></a></p><ul><li><a href=https://github.com/Infineon/DPS310-Pressure-Sensor>Arduinoライブラリ</a></li><li><a href="https://www.infineon.com/dgdl/Infineon-DPS310-DataSheet-v01_02-EN.pdf?fileId=5546d462576f34750157750826c42242">データシート</a><ul><li>データレートとオーバーサンプリングの設定は以下の通り</li><li><a href="https://www.infineon.com/dgdl/Infineon-DPS310-DataSheet-v01_02-EN.pdf?fileId=5546d462576f34750157750826c42242#page=30">ここらへん</a>を参考に，データレートと精度のちょうど良いバランスを決めた．</li><li>気圧と温度のデータレートは同じがいいらしい</li><li>温度は気圧に比べればそこまでの精度はいらない</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-cpp data-lang=cpp><span class=n>dps</span><span class=p>.</span><span class=n>configurePressure</span><span class=p>(</span><span class=n>DPS310_32HZ</span><span class=p>,</span> <span class=n>DPS310_16SAMPLES</span><span class=p>);</span>
<span class=n>dps</span><span class=p>.</span><span class=n>configureTemperature</span><span class=p>(</span><span class=n>DPS310_32HZ</span><span class=p>,</span> <span class=n>DPS310_2SAMPLES</span><span class=p>);</span>
</code></pre></td></tr></table></div></div></li><li><a href=https://keisan.casio.jp/exec/system/1257609530>気圧計算</a></li></ul></li><li><p>UART受信<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L278-L348><code>polling_UART()</code></a></p><ul><li>UARTは全て<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L278-L348><code>polling_UART()</code></a>で読み出す．</li><li><code>loop()</code>で高速でポーリングするより<code>func_100Hz()</code>内で10ms単位でまとめて読みだした方がスループットが高い．レイテンシは十分確保できる．</li><li>操舵角度計測<ul><li><a href=https://github.com/TORICA-23th/TORICA_lib/blob/main/TORICA_ICS.cpp>TORICA_ICS</a>の<code>ics.read_Angle()</code>でサーボモーターへの指令値を取得する．</li><li>コマンドヘッダを検知し，ポジションデータの上位7ビットと下位7ビットを結合して指令値を計測する．（<a href="https://kondo-robot.com/w/wp-content/uploads/ICS3.5_3.6_SoftwareManual_2_6.pdf#page=11">参考</a>）</li><li>サーボとの通信は100Hz以上の頻度で行われるため，<code>read_Angle()</code>はUART受信バッファを全て読み出すまで繰り返して最新値を返すようになっている．</li></ul></li><li>機体下電装部・エアデータ電装部<ul><li><a href=https://github.com/TORICA-23th/TORICA_lib/blob/main/TORICA_UART.h>TORICA_UART</a>の<code>UART_read()</code>で受信した値を取得する．</li><li>TORICA_UARTの使い方は<a href=https://github.com/TORICA-23th/TORICA_lib/tree/main>README</a>参照．内部実装は以下を参照．<ul><li>UART区切り<ul><li><a href=https://qiita.com/Ninagawa_Izumi/items/6a18249a31a87dad84e2>UART区切り1</a></li><li><a href=https://www.shtsno24.tokyo/2017/11/arduino.html>UART区切り2</a></li></ul></li><li><a href=https://asukiaaa.blogspot.com/2019/03/arduino.html>UART抽象化</a></li></ul></li><li>死活監視はここで行う．</li></ul></li><li>GPS<ul><li><a href=https://akizukidenshi.com/catalog/g/gM-12905/>秋月商品ページ</a></li><li>u-center<ol><li>通信速度を115200bpsに</li><li>データレートを10Hzに</li><li>時刻緯度経度高度が含まれるセンテンス(GGA)のみ出力</li></ol></li><li><a href=https://qiita.com/chromium_k/items/056f2ac72e81ca054185#%E3%81%8A%E3%81%BE%E3%81%91%E3%82%B3%E3%83%B3%E3%83%95%E3%82%A3%E3%82%B0%E4%BF%9D%E6%8C%81>コンフィグ保持</a></li><li><a href="https://akizukidenshi.com/catalog/faq/goodsfaq.aspx?goods=M-12905">GPSのQ&A</a></li><li><a href=https://content.u-blox.com/sites/default/files/u-center_Userguide_UBX-13005250.pdf>u-center</a></li><li><a href="https://www.denshi.e.kaiyodai.ac.jp/gnss_tutor/pdf/st_190310_2.pdf#page=13">NMEAセンテンス選択</a></li><li><a href=http://arduiniana.org/libraries/tinygpsplus/>Arduinoライブラリ</a></li></ul></li></ul></li><li><p>SD記録<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L442-L481><code>send_SD()</code></a></p><ul><li><p>データ種類に応じて10~100Hzで記録しようと考えていたが，100Hzでの記録は間に合わなかったので全てまとめて20Hzで記録する仕様にした．</p><details><summary>[廃止]種類別</summary><ul><li><code>TYPE,経過時間[ms],値,値,…</code></li><li><code>GPS,経過時間[ms],hh,mm,ss.f,緯度[udeg],経度[udeg],アンテナ海抜高度[m]</code></li><li><code>PRESSURE,経過時間[ms],気圧[hPa],温度[deg],気圧高度[m]</code></li><li><code>IMU,経過時間[ms],X[m/ss],Y[m/ss],Z[m/ss],qW,qX,qY,qZ</code></li><li><code>RUDDER,経過時間[ms],角度</code></li><li><code>UNDER,経過時間[ms],気圧[hPa],温度[deg],気圧高度[m],超音波高度[m]</code></li><li><code>AIR,経過時間[ms],気圧[hPa],温度[deg],気圧高度[m],差圧[Pa],対気速度[m/ss]</code></li></ul></details></li><li><p>20Hzで全データをするため，100Hzで実行される<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L442-L481><code>send_SD()</code></a>の中で記録データを5回に分けてUARTに流す．</p></li><li><p>保存する桁数に注意してフォーマット指定子を記述する．</p><ul><li>必要な精度で記録されるように小数点以下の桁数を設定．</li><li>GPS測位の有無に関わらずデータ量が変わらないようにリーディングゼロを設定．</li></ul></li></ul></li><li><p>テレメトリダウンリンク<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L567-L632><code>TWE_downlink()</code></a></p><ul><li>4秒に1回全データをダウンリンクする．</li><li>TWELITEは一度に大量のデータを送信できないため，5回に分けてデータを送信する．</li><li>機体下電装部・エアデータ電装部は接続が途絶えても最後の値が残り続けるため，直近1秒でデータが受信できているかという死活監視の結果もダウンリンクする．</li></ul></li><li><p>対地高度・対気速度読み上げ</p><ul><li>フライトフェーズ判断<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L351-L408><code>determine_flight_phase()</code></a><br>以下のフェーズを判定する．<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>PLATFORM</td><td>プラホ上</td></tr><tr><td>TAKEOFF</td><td>発進中</td></tr><tr><td>HIGH_LEVEL</td><td>水平飛行</td></tr><tr><td>MID_LEVEL</td><td>超音波センサの測定レンジ内(5m以下)</td></tr><tr><td>LOW_LEVEL</td><td>1m以下(速度と高度を交互に読み上げ)</td></tr></tbody></table></li><li>高度推定<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L411-L439><code>calculate_altitude()</code></a><br>GNSSは信用できず，気圧は対地高度を直接測ることはできず，超音波は高い所では測定範囲外になる．高いところでは気圧高度を，低いところでは超音波高度を使うことで解決できそうだが，超音波高度にノイズがあるため単純に切り替えるだけではうまくいかなかったので以下のように実装した．<br><img src=/images/blog/birdman-glider-avionics/estimate_alt.png alt loading=lazy><ul><li>3つの気圧センサーの中央値をとり，気圧高度を取得する．</li><li><code>MID_LEVEL</code>以下のフェーズで，気圧高度と超音波高度のオフセットを計算し，気圧高度から引いて対地高度を計算する．</li><li>オフセットについて4秒間の中央値を計算することで，超音波センサのノイズの影響を無くす．</li><li>超音波による補正は3秒かけて段階的に開始する．</li></ul></li><li>合成音声読み上げ<a href=https://github.com/TORICA-23th/MainComputer/blob/bb75cfd66796f55519e823bea5d4dc78964592eb/Flight/Flight.ino#L484-L531><code>callout_status()</code></a><ul><li>基本的にピトー管の対気速度を読み上げる．</li><li>対地高度が1m下がるごとに，「コウド,ロクテンゼロ」などと読み上げる．</li><li>対地高度が1mを切ると対気速度と対地高度を交互に読み上げる．</li></ul></li><li>HILS（Hardware In the Loop Simulator）<br>実際の高度や速度を与えて電装の動作確認をすることはできない<br>テストなしでコードを書くのは無理があり，テスト用のハードウェアを雑でいいので用意する<ul><li>HILSの仕様<ul><li>エアデータ電装部・機体下電装部のダミーデータをRaspberry Pi Picoを用いてメイン電装に送信する
<img src=/images/blog/birdman-glider-avionics/HILS.JPG alt loading=lazy></li><li>読み上げに使うセンサーデータのうち，メイン電装の気圧高度のみダミーデータを送ることは難しいが，3つのデータの中央値を取るためエアデータ電装部・機体下電装部の2つのデータで十分でSILS（Software In the Loop Simulator）は用意しない</li></ul></li></ul></li></ul></li></ul><h4 id=ジョイスティック電装部>ジョイスティック電装部</h4><h5 id=ハードウェア-1>ハードウェア</h5><ul><li><p>ジョイスティック候補(選定はパイロット)</p><ul><li><a href=https://www.switch-science.com/products/2891>Adafruit</a></li><li><a href=https://akizukidenshi.com/catalog/c/cjoystick/>秋月</a></li><li><a href="https://www.sengoku.co.jp/mod/sgk_cart/search.php?cid=3517">千石</a><ul><li>セイミツ工業のものはアナログジョイスティックではなくマイクロスイッチでON/OFFが分かるだけなので注意</li></ul></li></ul></li><li><p><a href=https://akizukidenshi.com/catalog/g/gP-06110/>可変抵抗</a>を用いてニュートラル調整</p><ul><li>抵抗値は10kΩ<ul><li>あまり小さいと消費電流が大きく，あまり大きいと誤差が大きくなる</li><li>ジョイスティックに合わせて10kΩを選定</li></ul></li></ul></li><li><p>サーボとICS基板との接続</p><ul><li><a href=https://kondo-robot.com/product/03121>ICS基板の接続</a></li><li>ICS変換基板自体は電源のためメイン電装基板に搭載</li></ul></li><li><p>大電流を消費するため，サーボのあいてるコネクタにコンデンサを配置</p></li></ul><table><thead><tr><th>部品</th><th align=center>個数</th><th align=right>価格</th></tr></thead><tbody><tr><td><a href=https://www.amazon.co.jp/gp/product/B004IYPPCM/>KRS-4034HV ICS</a></td><td align=center>2(予備含む)</td><td align=right>17,600</td></tr><tr><td><a href=https://www.amazon.co.jp/dp/B07XYZWJGD>ICS変換基板</a></td><td align=center>1</td><td align=right>1980</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-17044/>Seeeduino XIAO RP2040</a></td><td align=center>1</td><td align=right>830</td></tr><tr><td><a href=https://www.switch-science.com/products/2892/>小型アナログジョイスティック</a></td><td align=center>1</td><td align=right>528</td></tr><tr><td><a href=https://www.switch-science.com/products/2893>ジョイスティック基板</a></td><td align=center>1</td><td align=right>319</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gP-06110/>可変抵抗</a></td><td align=center>1</td><td align=right>50</td></tr></tbody></table><h5 id=ソフトウェア-1>ソフトウェア</h5><ul><li>サーボモータ<ul><li>ドキュメント<ul><li><a href=https://kondo-robot.com/product/krs-4034hv-ics>KRS-4034HV ICS</a>の「市販のマイコンボード，小型PCボードから制御する」を参考に</li><li><a href=https://kondo-robot.com/faq/ics-library-a2>Arduinoライブラリ</a><ul><li>Hardware Serialを使うのでライブラリはIcsClass_V210</li></ul></li><li><a href=https://kondo-robot.com/faq/ics_board_-tutorial2>ライブラリの使い方</a></li><li><a href=https://kondo-robot.com/faq/ics3-5_3-6softwaremanual_2>ライブラリの詳細リファレンス</a></li></ul></li><li>角度制御<ul><li>フライト時はジョイスティックを読んで<code>setPos()</code>で角度を指定するだけ</li></ul></li><li>サーボ詳細設定(未実装)<ul><li>以下の詳細設定をEEPROMに書き込んでおく．専用のプログラムを使ってサーボモータに対して一度書き込めば終わり．<ul><li>ストレッチ</li><li>スピード</li><li>パンチ</li><li>デッドバンド</li><li>レスポンス</li><li>ダンピング</li><li>プロテクション</li><li>リミッタ</li><li>温度制限</li><li>電流制限</li><li>フラグ</li></ul></li></ul></li></ul></li><li>ジョイスティックまわりの関数<ul><li><code>stick_normalized()</code>でジョイスティックの値を-1～+1の小数として計測する．<ul><li>ジョイスティックは可変抵抗の分圧でアナログ電圧が出力される仕組みで，<code>analogRead()</code>で測定できる．</li><li><code>analogRead()</code>は念のためオーバーサンプリングすると良い．</li><li><code>analogReadResolution(12);</code>の詳細は<a href=https://wiki.seeedstudio.com/Seeeduino-XIAO/#analog-input-and-output>XIAOのwiki</a></li><li>XY二方向あるので，三角関数っぽい計算をして-1～+1の小数に変換する．</li></ul></li><li><code>control_curve_deg()</code>で-1～+1を角度に変換する．<ul><li>不感帯やカーブはここで設定する．</li><li>中心では繊細に動かして端では大きく動かすようなカーブを設定するのがこの関数の役割．</li></ul></li><li><code>read_offset_deg()</code>でニュートラル調整用の可変抵抗の値を読んでオフセット角度(トリム)を計測する．</li><li><code>servo_write()</code>で角度とオフセットを足してサーボに送信する．</li></ul></li></ul><h4 id=機体下部電装部>機体下部電装部</h4><h5 id=ハードウェア-2>ハードウェア</h5><ul><li><a href=https://www.keyence.co.jp/ss/products/sensor/sensorbasics/us_info.jsp>超音波センサとは</a></li><li><a href=https://akizukidenshi.com/catalog/c/csensor4/>部品候補</a><ul><li>10Hz以上で測定できる</li><li>近距離でも測定できる</li><li>UART(RS232・TTLシリアル)以外で通信できる (XIAOのポートが埋まっているため)</li></ul></li></ul><table><thead><tr><th>部品</th><th align=center>個数</th><th align=right>価格</th></tr></thead><tbody><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-17044/>Seeeduino XIAO RP2040</a></td><td align=center>1</td><td align=right>830</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gK-05488/>マイクロSDカードスロットDIP化キット</a></td><td align=center>1</td><td align=right>300</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-12450/>超音波センサー URM37 V4.0</a></td><td align=center>1</td><td align=right>1,870</td></tr><tr><td><a href=https://www.switch-science.com/products/6286>DPS310</a></td><td align=center>1</td><td align=right>1,408</td></tr></tbody></table><h5 id=ソフトウェア-2>ソフトウェア</h5><details><summary>[廃止]XIAO SAMD21での設計</summary><ul><li>メインループで行う処理<ul><li>SDカードへの書き込み<ul><li>書き込みに時間がかかるのでメインループ</li></ul></li><li>超音波高度の取得<ul><li>測定に時間がかかるのでメインループ</li><li>SDカードの書き込みより早く測定できることはないのでメインループでOK</li></ul></li></ul></li><li>割り込みで行う処理(XIAOは割り込み一つ)<ul><li>メイン電装へのUART送信<ul><li><a href=#UART%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88>UARTフォーマット</a>にのっとって，気圧・温度・気圧高度・超音波高度を送信する</li><li><del>センサーの測定レートはバラバラだがUART送信は100Hzで行う．それぞれのセンサーについて測定できたタイミングで値をグローバル変数に書き込み，ISR内で100Hzで送信する．</del></li><li>処理時間がシビアなので，DPS310の32Hzの測定タイミングに合わせて送信する．グローバル変数を使うのは同じ．</li></ul></li><li>メイン電装からのUART受信<ul><li>文字列を受信し，そのままmicro SDに書き込む．</li><li>文字列をバッファに入れるだけで，SDへの書き込み自体はメインループで行う．</li></ul></li><li>気圧センサのデータ取得<ul><li>メインループで行うと測定レートが遅くなるので割り込み内で行う．</li><li>100Hzで最新の値を取れるわけではないので，最新値が取得できたときだけグローバル変数に書き込む．</li></ul></li></ul></li></ul><table><thead><tr><th>関数名</th><th>起動タイミング</th><th>概要</th></tr></thead><tbody><tr><td>loop()</td><td>メインループ</td><td>超音波高度の取得・SDカードへの書き込み</td></tr><tr><td>ISR_100Hz()</td><td>割り込み100Hz</td><td>メイン電装へのUART送受信・気圧センサのデータ取得</td></tr></tbody></table></details><p>割り込みを下手にやると事故るので，RP2040のマルチコアをうまく使う．ただし<code>volatile</code>には注意．</p><ul><li>CORE0で行う処理(32Hz over)<ul><li>気圧センサのデータ取得<ul><li>32Hzで最新値が取得できる．</li><li>測定できたらグローバル変数に書き込む．</li></ul></li><li>メイン電装へのUART送信<ul><li><a href=#UART%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88>UARTフォーマット</a>にのっとって，気圧・温度・気圧高度・超音波高度を送信する．</li><li>DPS310の32Hzの測定タイミングに合わせて送信する．グローバル変数から測定データを取得する．</li></ul></li><li>メイン電装からのUART受信<ul><li>文字列を受信し，そのままmicro SDに書き込む．</li><li>SDカードへの書き込みも32Hzには収まることが確認できたのでCORE0のループで行う．</li></ul></li></ul></li><li>CORE1で行う処理(超音波センサーに合わせて遅くてOK)<ul><li>超音波高度の取得<ul><li><a href=https://wiki.dfrobot.com/URM37_V5.0_Ultrasonic_Sensor_SKU_SEN0001_>サンプルコード</a></li><li>測定に時間がかかるので別コアで処理する．</li><li>そもそも測定距離に応じて測定時間が変化する．</li><li>自動で25Hz程度で測定されるが，TRIGにパルスを入力するとそれに関係なく測定を開始する．</li><li>測定エラー時は50000usが返ってくる．最大測定距離の500cmでは25000usが返ってくるのでこれを上限としてグローバル変数の測定結果に書き込む．</li></ul></li></ul></li></ul><table><thead><tr><th>関数名</th><th>起動タイミング</th><th>概要</th></tr></thead><tbody><tr><td>loop()</td><td>CORE0のループ</td><td>気圧センサのデータ取得・メイン電装へのUART送受信・SDカードへの書き込み</td></tr><tr><td>loop1()</td><td>CORE1のループ</td><td>超音波高度の取得</td></tr></tbody></table><table><thead><tr><th>LED</th><th>制御CORE</th><th>点灯タイミング</th></tr></thead><tbody><tr><td>白(独立3色合成)</td><td>CORE1</td><td>超音波測定トリガ送信中</td></tr><tr><td>赤(NEO)</td><td>CORE0</td><td>UART受信中</td></tr><tr><td>青(NEO)</td><td>CORE0</td><td>気圧センサ通信中(32Hz)</td></tr></tbody></table><h4 id=エアデータ電装部>エアデータ電装部</h4><h5 id=ハードウェア-3>ハードウェア</h5><ul><li>校正は非常に難しいため，以下の方法は選択肢から外した．校正済みの既製品が入手できるなら問題ない．<ul><li>五孔ピトー管</li><li>風車</li></ul></li><li>測定精度の観点だと<a href=https://www.switch-science.com/products/8657>超音波式風向風速計</a>は性能が良いが，高価で空気抵抗が大きいことから除外した．</li><li><a href=https://www.sg-lab.info/sensors/hws-19-one/>熱式風向風速計</a>は応答速度が低く，屋内での風環境測定を想定した製品で飛行機向きではない．</li><li>AoAはピッチ測定で代用し，風見鶏を付ければ校正なしで計測可能なAoSは加工面での製作難易度の高さから見送った．風見鶏を作る場合は応答性に注意．</li></ul><p>以上の理由でピトー管のみで製作した．差圧センサはSensirionのSDPを使用．公式で<a href=https://github.com/Sensirion/arduino-i2c-sdp>Arduinoライブラリ</a>が用意されていて使いやすい．</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>差圧センサーはHoneywellのRSCかSensirionのSDPがとてもよい．これ使ってからピトー管係数が1から大きく外れたことがない．微差圧計測は温度補正の効くセンサーに限る</p>&mdash; へーりん (@pakfat50) <a href="https://twitter.com/pakfat50/status/1532033891565182978?ref_src=twsrc%5Etfw">June 1, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><table><thead><tr><th>製品</th><th>方式</th><th>振動</th><th>ドリフト</th><th>チューブでの圧損</th></tr></thead><tbody><tr><td>Honeywell RSC</td><td>ダイヤフラム</td><td>影響あり</td><td>あり</td><td>影響なし</td></tr><tr><td>Sensirion SDP</td><td>流量</td><td>影響なし</td><td>なし</td><td>影響あり</td></tr></tbody></table><ul><li><p>方式と設計方針の選択肢</p><ul><li>ピトー管からチューブを伸ばして翼の安定した部分にダイヤフラム式のセンサを配置する</li><li>ピトー管のそばに流量式のセンサを配置する</li></ul></li><li><p>今回は流量式のセンサを使用する</p><ul><li>ドリフトの調整を省略できる</li><li>チューブの圧損は設計で確定するが，フライト時の振動は想定しづらい</li></ul></li><li><p>SDPの中のSDP810-500PAを採用</p><ul><li>ノイズに弱いアナログではなくI2C通信</li><li>125Paで14～15m/sなので，念のため500Paのレンジ</li><li>簡単に手半田可能なパッケージ</li><li>SDP811はI2Cアドレスが違うだけ</li></ul></li><li><p><a href=https://cfrpjapan.official.ec/items/58802549>CFRPのパイプ</a>に全部いれる</p><ul><li>強度はいらないけど軽いパイプがほしい</li><li>センサは(削れば)内径30mmに入る</li><li>マイコン・気圧センサも30mmに入る</li><li>もともと内径30mmだったけどCFRPのラインナップの都合で外径30mmに変更して基板とセンサを削った</li></ul></li></ul><table><thead><tr><th>部品</th><th align=center>個数</th><th align=right>価格</th></tr></thead><tbody><tr><td><a href=https://akizukidenshi.com/catalog/g/gM-17044/>Seeeduino XIAO RP2040</a></td><td align=center>1</td><td align=right>830</td></tr><tr><td><a href=https://akizukidenshi.com/catalog/g/gK-05488/>マイクロSDカードスロットDIP化キット</a></td><td align=center>1</td><td align=right>300</td></tr><tr><td><a href=https://www.digikey.jp/ja/products/detail/sensirion-ag/SDP810-500PA/6605489>SDP810-500PA</a></td><td align=center>1</td><td align=right><del>5,261</del> (Eclat流用)</td></tr><tr><td><a href=https://www.amazon.co.jp/dp/B07CYV8N93/>ピトー管</a></td><td align=center>1</td><td align=right>1,397</td></tr><tr><td><a href=https://www.switch-science.com/products/6286>DPS310</a></td><td align=center>1</td><td align=right>1,408</td></tr><tr><td><a href=https://cfrpjapan.official.ec/items/58802549>CFRPパイプ</a></td><td align=center>1</td><td align=right>4,264</td></tr></tbody></table><h5 id=ソフトウェア-3>ソフトウェア</h5><details><summary>[廃止]XIAO SAMD21での設計</summary><p>SDカードに書き込み(数十ms)を行いつつ100HzレベルでUART通信を行うため，SDカード書き込み中にUART処理を割り込む必要がある．<code>print()</code>の処理に割り込みが使用される関係で，素朴なタイマ割り込みルーチン内で<code>print()</code>を使うと問題が発生する(そしてXIAOで変なことするとブートローダーが壊れる)．Arduino Dueと同様にタイマ割り込みの優先度を下げることで対応する．</p><ul><li>メインループで行う処理<ul><li>SDカードへの書き込み<ul><li>書き込みに時間がかかるのでメインループ</li></ul></li></ul></li><li>割り込みで行う処理(XIAOは割り込み一つ)<ul><li>メイン電装からのUART受信<ul><li>文字列を受信し，そのままmicro SDに書き込む．</li><li>文字列をバッファに入れるだけで，SDへの書き込み自体はメインループで行う．</li></ul></li><li>メイン電装へのUART送信<ul><li><a href=#uart%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88>UARTフォーマット</a>にのっとって，気圧・温度・気圧高度・超音波高度を送信する</li><li>センサーの測定レートはバラバラだがUART送信は100Hzで行う．それぞれのセンサーについて測定できたタイミングで値をグローバル変数に書き込み，ISR内で100Hzで送信する．</li></ul></li><li>気圧センサのデータ取得<ul><li>メインループで行うと測定レートが遅くなるので割り込み内で行う．</li><li>100Hzで最新の値を取れるわけではないので，最新値が取得できたときだけグローバル変数に書き込む．</li></ul></li><li>差圧センサのデータ取得<ul><li>メインループで行うと測定レートが遅くなるので割り込み内で行う．</li><li>100Hzでグローバル変数に書き込む．</li></ul></li></ul></li></ul><table><thead><tr><th>関数名</th><th>起動タイミング</th><th>概要</th></tr></thead><tbody><tr><td>loop()</td><td>メインループ</td><td>SDカードへの書き込み</td></tr><tr><td>ISR_100Hz()</td><td>割り込み100Hz</td><td>(気圧センサが取得できたタイミングで)気圧センサのデータ取得・差圧センサのデータ取得・メイン電装へのUART送受信</td></tr></tbody></table></details><ul><li>CORE0で行う処理(32Hz over)<ul><li>気圧センサのデータ取得<ul><li>32Hzで最新値が取得できる．</li><li>測定できたらグローバル変数に書き込む．</li></ul></li><li>差圧センサのデータ取得<ul><li>データレートが十分高いので，DPS310の測定タイミングに合わせて測定を行う．</li><li>測定できたらグローバル変数に書き込む．</li></ul></li><li>メイン電装へのUART送信<ul><li><a href=#UART%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88>UARTフォーマット</a>にのっとって，気圧・温度・気圧高度・差圧・対気速度を送信する．</li><li>DPS310の32Hzの測定タイミングに合わせて送信する．グローバル変数から測定データを取得する．</li></ul></li><li>メイン電装からのUART受信<ul><li>文字列を受信し，そのままmicro SDに書き込む．</li><li>SDカードへの書き込みも32Hzには収まることが確認できたのでCORE0のループで行う．</li></ul></li></ul></li></ul><table><thead><tr><th>関数名</th><th>起動タイミング</th><th>概要</th></tr></thead><tbody><tr><td>loop()</td><td>CORE0のループ</td><td>気圧センサのデータ取得・差圧センサのデータ取得・メイン電装へのUART送受信・SDカードへの書き込み</td></tr></tbody></table><table><thead><tr><th>LED</th><th>制御CORE</th><th>点灯タイミング</th></tr></thead><tbody><tr><td>白(独立3色合成)</td><td>CORE0</td><td>SD書き込み中(<code>sd.flash</code>のみ)</td></tr><tr><td>赤(NEO)</td><td>CORE0</td><td>UART受信中(<code>sd.add_str</code>含む)</td></tr><tr><td>青(NEO)</td><td>CORE0</td><td>気圧センサ通信中(32Hz)</td></tr></tbody></table><h4 id=カメラ><del>カメラ</del></h4><table><thead><tr><th>~~部品</th><th>個数</th><th>価格~~</th></tr></thead><tbody><tr><td><del><a href=https://www.amazon.co.jp/dp/B01EABUA1I>SP360 4K</a></del></td><td><del>1</del></td><td><del>20,565</del></td></tr><tr><td><del><a href=https://www.yodobashi.com/product/100000001002937762/>防水ケース</a></del></td><td><del>1</del></td><td><del>9,720</del></td></tr><tr><td><del><a href=https://jox.co.jp/products/joy700/>JOY700(楽天で中古入手)</a></del></td><td><del>1</del></td><td><del>3,800</del></td></tr></tbody></table><ul><li><del>メリット</del><ul><li><del>姿勢，翼のたわみ具合，垂直尾翼の角度などのデータが確実に取得できる</del></li></ul></li><li><del>デメリット</del><ul><li><del>ツルツルのカウルに突起ができる</del></li></ul></li></ul><h3 id=配置の詳細>配置の詳細</h3><h4 id=メイン電装部-1>メイン電装部</h4><p><img src=/images/blog/birdman-glider-avionics/main_locate.png alt loading=lazy></p><ul><li><p>緑のところのコクピフレームに固定する</p><ul><li>他だとダメな理由<ol><li>着水時にPに当たる可能性があって危ない(発泡に埋め込むのはメンテだるい)</li><li>(パイプの隙間に配置)Pの腕とかで邪魔そう</li><li>重心調整で桁を動かすから邪魔</li><li>足で蹴られそう</li><li>ハッチの邪魔</li><li>ハッチの邪魔</li></ol></li></ul></li><li><p>固定は桁ではなくフレーム側</p><ul><li>他の電装がフレームにつくから</li><li>サーボは胴体桁ではなくテール桁なので桁に電装があるメリットなし</li><li>詳細な固定方法は電装の実物ができてから検討した</li></ul></li><li><p>胴体桁の左右にバッテリー，メイン電装，GPSモジュールを分けて配置する</p></li><li><p>搭載スペース</p><ul><li>左右160mm×上下方向60mm×前後300mm が左右で2つある</li><li>電装本体はこれより小さい(バッテリーGPS除いて60×30×120)</li></ul></li><li><p>実際に取り付けた様子</p><ul><li>板ごと取り外しできるのでメンテナンスしやすいが，重量はもったいない<br><img src=/images/blog/birdman-glider-avionics/main_fix.jpg alt loading=lazy></li></ul></li></ul><h4 id=サーボのケーブル>サーボのケーブル</h4><ul><li>胴体桁部分は桁の外側を通す</li><li>桁の外側でコネクタを繋ぎ，テール桁に接続する<ul><li>コネクタは脱着のため外に出てると良い<br><img src=/images/blog/birdman-glider-avionics/servo_cable.jpg alt loading=lazy></li></ul></li><li>テール桁の側面に穴を開け，ケーブルを埋め込む<ul><li>サーボがテール桁に埋め込まれるからケーブルも埋め込む</li></ul></li></ul><h4 id=ジョイスティック電装部-1>ジョイスティック電装部</h4><ul><li>ジョイスティックに近いフレームに結束バンドで固定</li><li>取り付け後もUSBケーブルがさせるような向きでマイコンを搭載した<br><img src=/images/blog/birdman-glider-avionics/joystick_fix.jpg alt loading=lazy></li></ul><h4 id=スピーカー>スピーカー</h4><ul><li>フレームに結束バンドで固定</li></ul><h4 id=機体下電装>機体下電装</h4><ul><li>メイン電装部の画像の黄色の部分に配置する<ul><li>後方だと蹴られる</li><li>高度取得のため機体の一番下に取り付けたいので桁や翼には配置したくない</li></ul></li><li>フレームではなくカウルに基板を固定する<ul><li>カウルに超音波センサ用の穴を開けてを埋め込みたい</li><li>フレームにセンサを取り付けるとカウルの取付精度に制約が生じる</li><li>重量はケーブル含め50g程度なので問題ない</li></ul></li><li>カウルに中継ケーブルを這わせておき，カウルをフレームに取り付けたあと，青部分でフレームのケーブルと接続する<ul><li>カウルをフレームに取り付けてから基板を取り付けるのは，パイロットが乗る板やハッチと干渉するため困難</li><li>テグスもここまで這わせてフレームに縛り付ければロスト対策もOK<br><img src=/images/blog/birdman-glider-avionics/under_fix.jpg alt loading=lazy></li></ul></li></ul><h4 id=エアデータ電装部-1>エアデータ電装部</h4><ul><li>左BC間に固定する<ul><li>ABは理科大で先に接合しておくため，露出するちょうど良い接合部はBC間</li></ul></li><li>基板を全てCFRPの内径30mmのチューブ内にまとめ，チューブの底面からケーブルを出す</li><li>チューブを桁に固定する専用フランジを作り，チューブは専用フランジに予め固定しておく<ul><li>桁同士を接続するフランジに追加工をすると強度が心配なので，専用のフランジを使用する</li><li>専用フランジと桁は養生テープで固定する(何周かすれば強度は十分)<br><img src=/images/blog/birdman-glider-avionics/airdata_fix.jpg alt loading=lazy></li></ul></li></ul><h4 id=カメラ-1><del>カメラ</del></h4><ul><li><del>主翼桁の前の養生の発泡の上に埋め込む</del><ul><li><del>胴体桁軸上に配置したい</del></li><li><del>フライト直前にアクセスできる位置に</del><ul><li><del>読売からNOGOが出ればダミーロードを載せられるように</del></li><li><del>カメラはケーブル繋がないので埋め込んでOK</del></li></ul></li><li><del>テグスでロスト対策はする</del></li></ul></li></ul><h2 id=製作のポイント>製作のポイント</h2><h3 id=電装基礎知識>電装基礎知識</h3><ul><li><a href=https://771-8bit.com/blog/for-beginners/>これ</a></li><li>ついったー</li></ul><h3 id=ソフトウェアの管理>ソフトウェアの管理</h3><ul><li>GitHub<ul><li>organizationは<a href=https://github.com/TORICA-23th>TORICA-23th</a><ul><li>コンポーネントごとにリポジトリを作る(ブランチ説明したくないしconflictさせたくない)</li><li>どうせ引き継ぎはどこかで失敗するので23代だけのorganizationにした．</li><li>同じ理由でリポジトリはすべてPublic．</li><li>GitHubの使い方<ul><li><a href=https://docs.github.com/ja>公式ドキュメント</a></li><li><a href="https://www.youtube.com/watch?v=WHwuNP4kalU">動画</a></li><li><a href=https://www.conventionalcommits.org/ja/v1.0.0/>Conventional Commits</a></li></ul></li></ul></li><li>複数のマイコンで使用する自前ライブラリは全て<a href=https://github.com/TORICA-23th/TORICA_lib>TORICA_lib</a>で共有</li><li>丁寧にブランチ切ってプルリク飛ばしてレビューしてって体制が理想だけど，班員全員の作業を班長が見てるのでmainブランチに直push．</li></ul></li></ul><h3 id=基板設計>基板設計</h3><ul><li>基板設計はKiCadを使う．<ul><li><a href="https://docs.kicad.org/5.1/ja/getting_started_in_kicad/getting_started_in_kicad.pdf#page=10">KiCad ことはじめ</a><ul><li>全体像はこれの10ページが分かりやすい</li></ul></li><li><a href="https://www.youtube.com/watch?v=6mEAS3d31Ns">KiCad 6.0 動画解説</a><ul><li>基本的に動画解説の流れにそって進めればOK</li></ul></li></ul></li><li>ソフトウェアと同じGitHubで管理する．<ul><li>リポジトリは分ける．</li></ul></li><li>Tips<ul><li><a href=https://www.quadcept.com/ja/manual/common/post-213>参考：パッド寸法</a></li><li><a href=https://techmagic.co.jp/blog211221/>Arduinoシールド</a><ul><li>Arduino Dueは外形が同じなのでMegaのシールド(マイコンボードの拡張基板)のテンプレートが使える</li></ul></li><li><a href=https://wiki.seeedstudio.com/Seeeduino-XIAO/#resourses>XIAO KiCadライブラリ</a></li><li><a href=https://marunaka-blog.com/kicad-symbol-new-create/1567/>シンボル自作方法</a></li><li><a href=https://marunaka-blog.com/kicad-footprint-new-create/1622/>フットプリント自作方法</a></li><li><a href=https://niseng.biz/blog/kicad6-0-board-arduino-atmega328/#rtoc-2>基板外形</a></li><li><a href=https://tekuteku-embedded.xyz/2022/06/09/%E8%87%AA%E5%8B%95%E9%85%8D%E7%B7%9A%E3%83%84%E3%83%BC%E3%83%ABfreerouting%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F/>自動配線ツール</a><ul><li>KiCadのPCBエディタでパターンを引くのは機械任せにできる</li></ul></li><li><a href=https://salicylic-acid3.hatenablog.com/entry/jlcpcb-order>JLCPCB発注方法</a></li></ul></li><li>寸法図など<ul><li><a href=https://akizukidenshi.com/img/goods/1/P-00517.jpg>C基板サイズ</a></li><li><a href=https://raw.githubusercontent.com/Arduinolibrary/DFRobot_Ultrasonic_Sensor/master/URM37%20img.JPG>超音波</a></li><li><a href=https://m.media-amazon.com/images/I/41+F2EjQQIL.jpg>気圧</a></li><li><a href=https://akizukidenshi.com/img/goods/1/M-15178.JPG>XIAO</a></li><li><a href=https://akizukidenshi.com/img/goods/1/K-05488.png>micro SD</a></li></ul></li></ul><h3 id=基板実装>基板実装</h3><ul><li>はんだ付けに関しては↓を見ればOK<br><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/dQ7AUjb1tkA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></li><li>部品を両面に実装する場合などは部品を取り付ける順番に要注意</li><li>防塵・防水<ul><li>金属・CFRPのカケラが基板に落ちて短絡するなどを防ぐ必要がある</li><li>樹脂によるポッティングは不可逆なので避けたい</li><li>カプトンテープをペタペタ貼って保護する</li><li>防水のため<a href=https://www.goot.jp/products/detail/bs_c20b>防湿コーティング剤</a>を使うのもありかも</li></ul></li></ul><h2 id=テスト>テスト</h2><h4 id=共通事項-1>共通事項</h4><ul><li>フライトまでバッテリーが持つ<ul><li><input checked disabled type=checkbox> ロングラン試験</li></ul></li><li>着水時に発煙・発火しない<ul><li><input disabled type=checkbox> サーボモータ部分を短絡させ，発熱発火しないこと，短絡復帰後に動作することを確認する．</li></ul></li><li>フェールソフト<ul><li><input disabled type=checkbox> 機体下部電装部のコネクタを引き抜いたうえで短絡させ，ログと操舵が動作し続けることを確認する．</li><li><input disabled type=checkbox> エアデータ電装部のコネクタを引き抜いたうえで短絡させ，ログと操舵が動作し続けることを確認する．</li><li><input disabled type=checkbox> 操舵系のみの電源供給ができることを確認する．</li><li><input disabled type=checkbox> SDを引き抜いても操舵が動作し続けることを確認する．</li></ul></li><li>メンテナンス性<ul><li><input checked disabled type=checkbox> 機体を組んだ状態で電装の電源を起動できる</li><li><input disabled type=checkbox> 機体を組んだ状態で電装のプログラムを変更できる<ul><li>機体下電装部・エアデータ電装部もUSBケーブルを伸ばしておくべきだったかも</li></ul></li></ul></li><li>耐候性<ul><li><input disabled type=checkbox> 各コンポーネントを接続し，50℃以上30分以上の動作を確認する．リポバッテリーは防爆バックに，他は黒い紙で覆って直射日光に曝す．</li><li><input checked disabled type=checkbox> BBM，EMで水没試験を行う．<br><img src=/images/blog/birdman-glider-avionics/water.png alt loading=lazy>
短絡故障はしないことが確認できた．波形はかなり歪む．</li></ul></li><li>電気的制約<ul><li><input disabled type=checkbox> 機体に取り付けた状態で，波形を確認する．</li></ul></li></ul><h4 id=操舵-1>操舵</h4><ul><li>基本<ul><li><input checked disabled type=checkbox> 操縦桿を動かし，ラダーを動かせる．</li><li><input checked disabled type=checkbox> 手でトルクをかけ，ラダーが動作することを確認する．</li></ul></li><li>その他の要件<ul><li><input checked disabled type=checkbox> 可変抵抗を操作し，ニュートラルの位置を変更できる．</li><li><input disabled type=checkbox> 操舵系のみの電源供給，操舵系以外のみの電源供給の両方が選択可能である．</li></ul></li></ul><h4 id=テレメトリ-1>テレメトリ</h4><ul><li><input checked disabled type=checkbox> スマホでテレメトリを受信できることを確認する．</li><li><input checked disabled type=checkbox> 通信距離を確認する．</li></ul><h4 id=高度速度計-1>高度速度計</h4><ul><li><p><input checked disabled type=checkbox></p></li><li><p>ハッチを閉じたとき気圧高度の取得に影響がないことを確認する．</p><ul><li><input disabled type=checkbox> ハッチを閉じたとき，気圧高度の中央値にスパイクが表れないことを確認する．</li></ul></li></ul><h4 id=ロガー-1>ロガー</h4><ul><li><input checked disabled type=checkbox> 全てのデータをタイムスタンプつきで記録できることを確認する．</li><li>着水時にデータをロストしない<ul><li><input disabled type=checkbox> SDを抜いてデータがロストしないことを確認する．この試験はTBD回行う．</li></ul></li></ul><h2 id=完成したシステム>完成したシステム</h2><h3 id=概要>概要</h3><h3 id=コンポーネント詳細>コンポーネント詳細</h3><p>UARTのプルアップを忘れたので各基板にUARTのRXにプルアップ抵抗を違法建築した．</p><h4 id=メイン基板>メイン基板</h4><ul><li><a href=https://github.com/TORICA-23th/MainComputer>ソフトウェア</a></li><li><a href=https://github.com/TORICA-23th/PCB_Main>基板</a><br><img src=/images/blog/birdman-glider-avionics/PCB/main.svg alt loading=lazy></li></ul><h4 id=無線ハブ基板>無線ハブ基板</h4><ul><li><a href=https://github.com/TORICA-23th/PCB_Hub>基板</a><br><img src=/images/blog/birdman-glider-avionics/PCB/hub.svg alt loading=lazy></li></ul><h4 id=テレメトリ受信機>テレメトリ受信機</h4><ul><li><a href=https://github.com/TORICA-23th/Telemetry>ドキュメント</a></li></ul><h4 id=ジョイスティック電装部-2>ジョイスティック電装部</h4><ul><li><a href=https://github.com/TORICA-23th/Joystick>ソフトウェア</a></li><li><a href=https://github.com/TORICA-23th/PCB_Joystick>基板</a><br><img src=/images/blog/birdman-glider-avionics/PCB/joystick.svg alt loading=lazy></li></ul><h4 id=機体下部電装部-1>機体下部電装部</h4><ul><li><a href=https://github.com/TORICA-23th/Underside>ソフトウェア</a></li><li><a href=https://github.com/TORICA-23th/PCB_Underside>基板</a><br><img src=/images/blog/birdman-glider-avionics/PCB/underside.svg alt loading=lazy></li></ul><h4 id=エアデータ電装部-2>エアデータ電装部</h4><ul><li><a href=https://github.com/TORICA-23th/AirData>ソフトウェア</a></li><li><a href=https://github.com/TORICA-23th/PCB_AirData>基板</a><br><img src=/images/blog/birdman-glider-avionics/PCB/airdata.svg alt loading=lazy></li></ul><h2 id=運用>運用</h2><h3 id=琵琶湖の持ち物>琵琶湖の持ち物</h3><ul><li><p>コクピに取り付け済みの部品</p><ul><li><input checked disabled type=checkbox> <a href=#%E3%82%B3%E3%82%AF%E3%83%94%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99>組み立て手順</a>参照</li></ul></li><li><p>翼に取り付け済みの部品</p><ul><li><input checked disabled type=checkbox> エアデータ電装部用の翼内のケーブル</li></ul></li><li><p>取り付けしていない部品</p><ul><li><input checked disabled type=checkbox> 基板・ケーブル(青ダンボール)<ul><li><input checked disabled type=checkbox> サーボ胴体桁ケーブル</li><li><input checked disabled type=checkbox> 機体下部電装部(超音波)<ul><li><input checked disabled type=checkbox> フォーマット済みmicro SD取り付け済み</li></ul></li><li><input checked disabled type=checkbox> 機体下電装部カウル中継ケーブル</li><li><input checked disabled type=checkbox> 機体下電装部SD保護スポンジ</li><li><input checked disabled type=checkbox> テグス</li></ul></li></ul></li><li><p><input checked disabled type=checkbox> エアデータ電装部(ピトー管)</p><ul><li><input checked disabled type=checkbox> フォーマット済みmicro SD取り付け済み</li><li><input checked disabled type=checkbox> テグス取り付け済み</li><li><input checked disabled type=checkbox> ピトー管カバー</li></ul></li><li><p><input checked disabled type=checkbox> 防爆バッグ <a href=https://www.amazon.co.jp/gp/product/B00OT4MZPG/>LayLax GIGA TEC PSEリポ セーフティーバッグ</a></p><ul><li><input checked disabled type=checkbox> リポバッテリーFM 850mAh(12.53V)</li><li><input checked disabled type=checkbox> リポバッテリーFM予備 850mAh(12.56V)</li><li><input checked disabled type=checkbox> リポバッテリー予備 2200mAh(12.51V)</li><li><input checked disabled type=checkbox> リポバッテリー予備 2200mAh(12.00V)</li><li><input checked disabled type=checkbox> 回収用ミニ防爆バッグ</li></ul></li><li><p><input checked disabled type=checkbox> 交換部品(茶ダンボール大)</p><ul><li><input checked disabled type=checkbox> サーボモータ予備</li><li><input checked disabled type=checkbox> ジョイスティック電装部予備基板</li><li><input checked disabled type=checkbox> ジョイスティック予備</li><li><input checked disabled type=checkbox> エアデータ電装部予備基板</li><li><input checked disabled type=checkbox> 差圧センサ・ピトー管予備</li><li><input checked disabled type=checkbox> 機体下電装部予備基板</li><li><input checked disabled type=checkbox> 機体下電装部SD保護スポンジ予備</li><li><input checked disabled type=checkbox> メイン電装部予備基板</li><li><input checked disabled type=checkbox> Arduino Due予備</li><li><input checked disabled type=checkbox> バッテリータッパー蓋予備</li></ul></li><li><p><input checked disabled type=checkbox> 予備部品(茶ダンボール小)</p><ul><li><input checked disabled type=checkbox> 電圧電流計予備</li><li><input checked disabled type=checkbox> リセッタブルヒューズ予備</li><li><input checked disabled type=checkbox> ラズピコ(HILS予備)</li><li><input checked disabled type=checkbox> デバッグ用ケーブルもろもろ</li><li><input checked disabled type=checkbox> 死んだ基板(部品取り)</li><li><input checked disabled type=checkbox> トグルスイッチ</li></ul></li><li><p><input checked disabled type=checkbox> ソフトウェア書き換えセット(ポリ袋)</p><ul><li><input checked disabled type=checkbox> USB A-A延長ケーブル</li><li><input checked disabled type=checkbox> USB A-Cケーブル</li><li><input checked disabled type=checkbox> USB C-Cケーブル</li><li><input checked disabled type=checkbox> USB A-micro Bケーブル</li><li><input checked disabled type=checkbox> ラズピコ(HILS)</li><li><input checked disabled type=checkbox> デバッグ用スピーカー</li></ul></li><li><p><input checked disabled type=checkbox> 線材予備(ポリ袋)</p><ul><li><input checked disabled type=checkbox> SM5ピン</li><li><input checked disabled type=checkbox> SM4ピン</li><li><input checked disabled type=checkbox> サーボケーブル たくさん</li><li><input checked disabled type=checkbox> みじかいサーボ延長ケーブル</li><li><input checked disabled type=checkbox> シールド付スリムロボットケーブル4芯 3m × 2</li><li><input checked disabled type=checkbox> AWG22 耐熱ワイヤー 10本</li><li><input checked disabled type=checkbox> AWG24 耐熱ワイヤー 10本</li><li><input checked disabled type=checkbox> XHアッセンブリワイヤ各色10本</li><li><input checked disabled type=checkbox> 電源用VHケーブル</li><li><input checked disabled type=checkbox> エナメル線</li></ul></li><li><p><input checked disabled type=checkbox> その他(ポリ袋)</p><ul><li><input checked disabled type=checkbox> マスキングテープ</li><li><input checked disabled type=checkbox> カプトンテープ 6mm幅</li><li><input checked disabled type=checkbox> カプトンテープ 15mm幅</li><li><input checked disabled type=checkbox> <a href="https://www.sengoku.co.jp/mod/sgk_cart/detail.php?code=EEHD-5NLU#">結束バンド</a></li><li><input checked disabled type=checkbox> ビニールテープ</li></ul></li><li><p><input checked disabled type=checkbox> 工具セット(ヒートガンダンボール)</p><ul><li><input checked disabled type=checkbox> はんだごて FX-600</li><li><input checked disabled type=checkbox> はんだ</li><li><input checked disabled type=checkbox> ハンダ吸い取り器</li><li><input checked disabled type=checkbox> ハンダ吸い取り線</li><li><input checked disabled type=checkbox> フラックス</li><li><input checked disabled type=checkbox> ラジオペンチ</li><li><input checked disabled type=checkbox> ニッパー</li><li><input checked disabled type=checkbox> ワイヤーストリッパー</li><li><input checked disabled type=checkbox> ドライバー</li><li><input checked disabled type=checkbox> マステ</li></ul></li><li><p><input checked disabled type=checkbox> リポ充電セット</p><ul><li><input checked disabled type=checkbox> 充電器の箱<ul><li><input checked disabled type=checkbox> リポバッテリー充電器本体 <a href=https://www.amazon.co.jp/gp/product/B08TBQRD6V/>G-FORCE GMD660P DC Charger G0344</a></li><li><input checked disabled type=checkbox> リポ用ケーブル(XT60-T型ディーンズコネクタ)</li><li><input checked disabled type=checkbox> 12V用ケーブル(XT60-ワニ口)</li><li><input checked disabled type=checkbox> USB PD 12V変換基板</li></ul></li><li><input checked disabled type=checkbox> 12V2.0A ACアダプタ 変換DCジャック付き</li></ul></li><li><p><input checked disabled type=checkbox> 部物ポケットテスター</p></li><li><p><input checked disabled type=checkbox> テレメトリ受信機 C-Cケーブルつき</p></li><li><p><input checked disabled type=checkbox> AC100V延長コード</p></li><li><p><input checked disabled type=checkbox> メイン電装防水カバー</p></li><li><p>私物</p><ul><li><p><input checked disabled type=checkbox> パソコン</p><ul><li><input checked disabled type=checkbox> 全リポジトリclone済み・依存関係インストール済み</li></ul></li><li><p><input checked disabled type=checkbox> PC用バッテリー</p></li><li><p><input checked disabled type=checkbox> オシロスコープ</p><ul><li><input checked disabled type=checkbox> 本体(<a href=https://akizukidenshi.com/catalog/g/gM-16701/>HDS272S</a>)</li><li><input checked disabled type=checkbox> プローブ2本・テストリード2本</li><li><input checked disabled type=checkbox> テストピンケーブル2本・ジャンパー線2本</li></ul></li></ul></li><li><p><input checked disabled type=checkbox> ポケットに入れるもの</p><ul><li><input checked disabled type=checkbox> SDカードケース</li><li><input checked disabled type=checkbox> ポケットテスター</li><li><input checked disabled type=checkbox> マスキングテープ</li><li><input checked disabled type=checkbox> ミニ養生テープ</li><li><input checked disabled type=checkbox> ハサミ</li></ul></li></ul><h3 id=全組tf運用>全組・TF運用</h3><h4 id=64-全組>6/4 全組</h4><ul><li>エアデータ電装部の基板のハードウェア故障<ul><li>前日まで動作していたエアデータ電装部が動作しなくなった．後日解析すると気圧センサーとの通信に失敗して停止していることが分かったが，根本原因の特定はできなかった．</li></ul></li><li>エアデータ電装部の取付時の馬との干渉<ul><li>接合時は馬にB側の桁を乗せるので，C側に取り付けることにした．</li></ul></li></ul><h4 id=611-全組>6/11 全組</h4><ul><li>エアデータ電装部のトラブルシュートができておらず，重心に関してはエアデータ電装部は左右バランスにしか影響しないので接続しなかった．</li><li>スピーカーの信号線のノイズによる動作不良の可能性を潰すためスピーカーとサーボを同時に動作させ，トラブルは発生しなかった．</li><li>サーボはひとまず動いたが，レンジ調整が必要だった．サーボをテール桁にエポで固定した後に調整する．</li></ul><h4 id=618-tf>6/18 TF</h4><ul><li>まだサーボの固定をしていなかったので垂直尾翼なし．</li><li>全データの取得を確認し，発進時の加速度等のデータを得た．</li></ul><h4 id=702-全組>7/02 全組</h4><ul><li>垂直尾翼の動作，全データの取得を確認．<ul><li>このときは超音波センサ用の穴をカウルに開けていなかった．</li></ul></li></ul><h4 id=709-tf>7/09 TF</h4><ul><li>強風のため中止．</li></ul><h4 id=722-全組>7/22 全組</h4><ul><li>超音波センサの問題が発覚した．</li></ul><h3 id=組み立て>組み立て</h3><p><strong>各チェックボックスごとに写真を撮影すること！</strong></p><h4 id=テール桁事前準備>テール桁事前準備</h4><ul><li>サーボモータをテール桁に埋め込む．<ul><li><input checked disabled type=checkbox> テール桁サーボケーブルを中子に通し，マステで仮止めする．</li><li><input checked disabled type=checkbox> 中継コネクタを引きながら，中子をテール桁に押し込む．</li><li><input checked disabled type=checkbox> サーボモータにコネクタをさし，テール桁に埋め込む．
<img src=/images/blog/birdman-glider-avionics/assembly/tail.png alt loading=lazy></li><li><input checked disabled type=checkbox> サーボをエポキシで固定する．</li></ul></li></ul><h4 id=コクピ事前準備>コクピ事前準備</h4><ul><li>コクピフレームへの基板・ケーブル配置<br>以下のケーブルが取り付けられていることを確認する．<ul><li>スピーカー<ul><li><input checked disabled type=checkbox> スピーカー・スピーカーケーブル
<img src=/images/blog/birdman-glider-avionics/assembly/speaker.png alt loading=lazy></li></ul></li><li>操舵<ul><li><input checked disabled type=checkbox> ジョイスティック(基板とフレームに板を挟んで接着剤でつけたうえでテグス固定)</li><li><input checked disabled type=checkbox> ジョイスティックアナログケーブル(両端XHコネクタだがピン配置が異なる)</li><li><input checked disabled type=checkbox> ジョイスティック電装部(基板とフレームに板を挟んで結束バンド固定)</li><li><input checked disabled type=checkbox> ジョイスティックICSケーブル
<img src=/images/blog/birdman-glider-avionics/assembly/joystick.png alt loading=lazy></li></ul></li><li>エアデータ(コクピ内の配線は無し)</li><li>機体下<ul><li><input checked disabled type=checkbox> 機体下電装部フレーム中継ケーブル
<img src=/images/blog/birdman-glider-avionics/assembly/under_frame.png alt loading=lazy></li></ul></li></ul></li><li>メイン電装部の組み立て<ul><li><input checked disabled type=checkbox> 板の下から8個全てのネジの合いマークを見て緩みがないことを確認する．</li><li><input checked disabled type=checkbox> 無線ハブ基板とメイン電装部がケーブルで接続されていることを確認する．</li></ul></li><li>メイン電装部の取り付け<ul><li><input checked disabled type=checkbox> 吊り具を使って電装の板をコクピフレームに固定する．<strong>可動域の中で一番前方に</strong></li><li><input checked disabled type=checkbox> micro USBコネクタ2つに緩みがないことを確認する．</li></ul></li><li>コクピ内ケーブルをメイン電装部に接続する．<ul><li><input checked disabled type=checkbox> 機体下電装部フレーム中継ケーブル</li><li><input checked disabled type=checkbox> ジョイスティックICSケーブル</li><li><input checked disabled type=checkbox> スピーカーケーブル
<img src=/images/blog/birdman-glider-avionics/assembly/main.png alt loading=lazy></li></ul></li></ul><h4 id=a翼b翼の接合>A翼B翼の接合</h4><ul><li>翼の接合<ul><li><input checked disabled type=checkbox> (接合班)A翼とB翼を接合する．作業中，電装班はケーブルに負荷がかからないかチェックする．</li></ul></li><li>ケーブルの接続<ul><li><input checked disabled type=checkbox> AとBの中継コネクタを接続する．</li></ul></li><li>導通チェック<ul><li><input checked disabled type=checkbox> ジャンパー線で片方のコネクタの2端子を接続し，もう片方のコネクタの該当端子をテスターで導通しているかチェックする．</li></ul></li><li>フタサット付け<ul><li><input checked disabled type=checkbox> (翼班)フタサットを取り付ける．</li></ul></li></ul><h4 id=heading></h4><p><strong>&mdash;-↑ここまで理科大，↓ここから琵琶湖&mdash;-</strong></p><h4 id=電装の検品バッテリー準備>電装の検品・バッテリー準備</h4><ul><li>緩みの確認<ul><li><input disabled type=checkbox> 電装固定ネジ8箇所</li><li><input disabled type=checkbox> メインSD</li><li><input disabled type=checkbox> メイン電装コネクタ</li><li><input disabled type=checkbox> ジョイスティックコネクタ</li><li><input disabled type=checkbox> ジョイスティック電装部コネクタ</li></ul></li><li><input disabled type=checkbox> バッテリー搭載<ul><li><input disabled type=checkbox> バッテリーの電圧をテスターで測定し，12.5V以上であることを確認する．</li><li><input disabled type=checkbox> バッテリーのコネクタを接続し，タッパーに入れる．</li></ul></li><li><input disabled type=checkbox> <a href=#(%E3%81%84%E3%81%A4%E3%81%A7%E3%82%82)%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D>動作確認</a></li></ul><h4 id=t字桁へのフレーム取り付け>T字桁へのフレーム取り付け</h4><ul><li>エアデータ電装部ケーブル<ul><li><input disabled type=checkbox> Z翼のリブから出るエアデータ電装部のケーブルを翼の上に置く．
<img src=/images/blog/birdman-glider-avionics/assembly/pitot_Z.JPG alt loading=lazy></li><li><input disabled type=checkbox> (コクピ班)T字桁にフレームを吊り具で固定しする．</li><li><input disabled type=checkbox> エアデータ電装部のケーブルをメイン電装部に接続する．</li><li><input disabled type=checkbox> ケーブルの余った部分を養生テープでT字桁に固定する．
<img src=/images/blog/birdman-glider-avionics/assembly/air_frame.png alt loading=lazy></li></ul></li><li>サーボケーブル<ul><li><input disabled type=checkbox> サーボケーブルをメイン電装部に接続する．</li><li><input disabled type=checkbox> カウル1を取り付ける．</li><li><input disabled type=checkbox> カウル2の穴にサーボケーブルを通す．</li><li><input disabled type=checkbox> カウル2を取り付ける．</li><li><input disabled type=checkbox> サーボケーブルを胴体桁に養生テープで仮止めする．
<img src=/images/blog/birdman-glider-avionics/assembly/cowl.jpg alt loading=lazy></li></ul></li></ul><h4 id=機体下電装部の接続>機体下電装部の接続</h4><ul><li>カウルへの機体下電装部の取り付け<ul><li><input disabled type=checkbox> 機体下電装部をカウルに取り付ける．</li><li><input disabled type=checkbox> 基板のネジ穴にテグスを結びつけ，テグスをカウルの前方にマステで仮止めする．</li><li><input disabled type=checkbox> 機体下電装部カウル中継ケーブルを接続し，コネクタをカウルの前方にマステで仮止めする．</li></ul></li><li>カウルの取り付け<ul><li><input disabled type=checkbox> (コクピ班)カウルを取り付ける．</li></ul></li><li>接続<ul><li><input disabled type=checkbox> 機体下電装部カウル中継ケーブルと機体下電装部フレーム中継ケーブルを接続する．</li><li><input disabled type=checkbox> 機体下電装部のテグスをフレームに取り付ける．</li></ul></li></ul><h4 id=エアデータ電装部の接続>エアデータ電装部の接続</h4><ul><li>翼の接合<ul><li><input disabled type=checkbox> (接合班)A翼をコクピのZ翼に接合する．作業中，電装班はケーブルに負荷がかからないかチェックする．</li><li><input disabled type=checkbox> (接合班)B翼をC翼に接合する．作業中，電装班はケーブルに負荷がかからないかチェックする．</li></ul></li><li>ピトー管の取り付け<ul><li><input disabled type=checkbox> (接合班)エアデータ電装部をフランジに取り付ける．筒の中心がリブの印に重なるような角度で取り付ける．</li></ul></li><li>ケーブルの接続<ul><li><input disabled type=checkbox> AとZの中継コネクタを接続する．</li><li><input disabled type=checkbox> Bとピトー管の中継コネクタを接続する．</li></ul></li><li>動作確認<ul><li><input disabled type=checkbox> テレメトリ受信機を用意してから電源スイッチをONにし，エアデータ電装部と通信できていることを確認してから電源を切る．</li></ul></li><li>フタサット付け<ul><li><input disabled type=checkbox> (翼班)フタサット(翼の接合部の保管部品)を取り付ける．</li></ul></li></ul><h4 id=尾翼の接続>尾翼の接続</h4><ul><li>テール桁の接合<ul><li><input disabled type=checkbox> (接合班)テール桁を接合する．</li></ul></li><li>ケーブルの接続<ul><li><input disabled type=checkbox> テール桁の中継コネクタを接続する．</li></ul></li><li>動作確認<ul><li><input disabled type=checkbox> 電源スイッチをONにし，尾翼を操舵できることを確認して電源を切る．</li></ul></li></ul><h4 id=いつでも動作確認>(いつでも)動作確認</h4><ul><li><input disabled type=checkbox> 仮接続<ul><li><input disabled type=checkbox> 動作確認用エアデータケーブルを用いて，Z翼の中継コネクタに直接ピトー管のケーブルを接続する．</li><li><input disabled type=checkbox> ピトー管の穴に付いているマスキングテープを剥がす.</li><li><input disabled type=checkbox> 動作確認用4P中継ケーブルを使用して，機体下電装部カウル中継ケーブルと機体下電装部フレーム中継ケーブルを接続する．</li><li><input disabled type=checkbox> 予備のサーボモータを接続する．</li></ul></li><li><input disabled type=checkbox> 動作確認<ul><li><input disabled type=checkbox> テレメトリ受信機をスマホに接続し，シリアルモニタで通信を開始する．</li><li><input disabled type=checkbox> メイン電装部の電源スイッチをONにする．</li><li><input disabled type=checkbox> 起動直後のダウンリンクデータが取得できていることを確認する．</li><li><input disabled type=checkbox> 超音波センサを手で遮り，スピーカーが鳴ることを確認する．</li><li><input disabled type=checkbox> 超音波センサから地面までの距離を変化させ,超音波高度が変化することを確認する．</li><li><input disabled type=checkbox> ピトー管に息を吹き込み，対気速度が変化することを確認する．</li><li><input disabled type=checkbox> ジョイスティックを動かし，サーボモータが適切に動作することを確認する．</li></ul></li><li><input disabled type=checkbox> 取り外し<ul><li><input disabled type=checkbox> 電源スイッチをOFFにする．</li><li><input disabled type=checkbox> 動作確認用エアデータケーブル，エアデータ電装部を取り外す．</li><li><input disabled type=checkbox> ピトー管カバーを付ける.</li><li><input disabled type=checkbox> 機体下電装部カウル中継ケーブル，機体下電装部を取り外す．</li><li><input disabled type=checkbox> 予備のサーボモータを取り外す．</li></ul></li></ul><h3 id=トラブルシュートマニュアル>トラブルシュートマニュアル</h3><h4 id=メイン電装の書き込み>メイン電装の書き込み</h4><p>Arduino DueはProgramming PortとNative Portの2つのUSBポートが存在する．マイコンがハングアップしているとNative Portからは書き込みができないが，Programming PortはSerial(エアデータ電装部に接続)と共通のポートを使用しているため，書き込み時はSerialには接続しないでおく必要がある．</p><p>あらかじめProgramming PortとNative Portの両方にUSBケーブルを接続しておき，必要であれば琵琶湖でもUSBケーブルを延長してPCから書き込みを行う．通常時はNative Portから書き込みを行い，問題が起きたときはエアデータ電装部のスイッチを切ってProgramming Portから書き込みを行う．</p><h4 id=操舵系トラブル>操舵系トラブル</h4><p>以下のテストは全てメイン電装の電源を入れた状態で行う．</p><div class=mermaid>graph LR
A[起動時のダウンリンクでICSの値は正常か] -- yes --> B[コクピから出ているケーブルに予備のサーボを接続して動作するか]
B -- yes --> C[サーボの故障かテール桁内部での断線,ニュートラルロック]
B -- no --> D[コクピ内サーボケーブルの接触不良,断線.可能であれば後部カウルを取り外して確認したいが,基本ニュートラルロック.]
A -- no --> E[ジョイスティック電装部のマイコンの電源の赤LEDは点灯しているか]
E -- yes --> F[ジョイスティック電装部にUSBケーブルをつないでシリアルモニタを開き,値が読み取れるか]
F -- yes --> G[値は安定していて,ジョイスティック/ニュートラル調整つまみを操作して反映されるか]
G -- yes --> H[ジョイスティックICSケーブルの接触不良,断線.]
G -- no --> I[ジョイスティックアナログケーブルの接触不良,断線.]
F -- no --> J[ジョイスティック電装部のソフトウェア故障.ソフトウェアを焼き直して予備基板に交換.]
E -- no --> K[テスターでジョイスティックICSケーブルの電圧を読み,5V程度の正常な値になっているか]
K -- yes --> L[ジョイスティックを取り外し,電源LEDは点灯するか]
L -- yes --> M[ジョイスティックの短絡故障.アルミフレームへの接触がないことを確認し,予備に交換.]
L -- no --> N[ジョイスティック電装部の短絡故障.アルミフレームへの接触がないことを確認し,予備に交換.]
K -- no --> O[ジョイスティックICSケーブルの接触不良,断線.]</div><script>(function(){if(window.isMermaidLoaded)return;window.isMermaidLoaded=true;const script=document.createElement('script');script.src='https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js';script.onload=()=>{mermaid.initialize({startOnLoad:true});};document.body.appendChild(script);})();</script><h2 id=鳥コンの運用取得データ>鳥コンの運用・取得データ</h2><h3 id=当日のシーケンス>当日のシーケンス</h3><h4 id=729-フライト前日>7/29 フライト前日</h4><table><thead><tr><th>時間</th><th>作業</th></tr></thead><tbody><tr><td>7:17</td><td>トラックからテント物品積み下ろし</td></tr><tr><td>8:05</td><td>全員トラック駐車場到着</td></tr><tr><td>8:21</td><td>ブリーフィング</td></tr><tr><td>8:33</td><td>テント組立て班，機体積み下ろし班に分かれる</td></tr><tr><td>8:35</td><td>テント班，テントを持ってトラック駐車場出発</td></tr><tr><td>9:01</td><td>テント到着，組立て開始</td></tr><tr><td>9:06</td><td>機体組到着</td></tr><tr><td>9:28</td><td>機体仮設置場所用意</td></tr><tr><td>9:35</td><td>テントにトラック到着</td></tr><tr><td>9:47</td><td>トラックから機体積み下ろし完了</td></tr><tr><td>10:12</td><td>テント組立て完了</td></tr><tr><td>10:34</td><td>テント配置完了，テントへ機体搬入開始</td></tr><tr><td>10:51</td><td>機体搬入完了</td></tr><tr><td>10:54</td><td>機体保持，コクピアセンブリ，翼チェック，電装検品開始</td></tr><tr><td>11:05</td><td>左AB倒れる</td></tr><tr><td>11:10</td><td>讀賣インタビュー</td></tr><tr><td>11:29</td><td>電装検品完了</td></tr><tr><td>11:32</td><td>フレームのT字への取り付け完了</td></tr><tr><td>11:37</td><td>機体下電装部のカウルへの取り付け完了</td></tr><tr><td>11:40</td><td>昼休憩開始</td></tr><tr><td>12:00</td><td>昼休憩終了</td></tr><tr><td>12:02</td><td>機体後部カウル取り付け完了</td></tr><tr><td>12:37</td><td>コクピ養生完了，主翼接合開始</td></tr><tr><td>13:28</td><td>ピトー管取り付け完了</td></tr><tr><td>13:30</td><td>機体審査開始</td></tr><tr><td>13:46</td><td>機体審査完了，垂直動作確認開始</td></tr><tr><td>13:58</td><td>垂直動作確認完了</td></tr><tr><td>14:00</td><td>機体解体開始</td></tr><tr><td>14:38</td><td>機体解体完了</td></tr><tr><td>15:03</td><td>機体下電装ケーブルテグス接続完了</td></tr><tr><td>16:00</td><td>讀賣カメラ作業開始</td></tr><tr><td>16:59</td><td>夜間保持組ホテルへ移動開始</td></tr><tr><td>17:53</td><td>讀賣カメラ作業終了</td></tr><tr><td>18:42</td><td>電装班長撤収</td></tr></tbody></table><h4 id=730-フライト当日>7/30 フライト当日</h4><table><thead><tr><th>時間</th><th>作業</th></tr></thead><tbody><tr><td>5:24</td><td>夜間保持組で機体組み立て開始</td></tr><tr><td>5:55</td><td>T字配置完了(当日は湖岸に平行)</td></tr><tr><td>6:14</td><td>テール接合</td></tr><tr><td>6:19</td><td>水平取り付け</td></tr><tr><td>6:40</td><td>左AB接合</td></tr><tr><td>7:32</td><td>組み立て完了，機体移動開始</td></tr><tr><td>8:27</td><td>電装班長機体前到着，もろもろテスト</td></tr><tr><td>8:59</td><td>垂直サーボ付近銀シート取り付け完了</td></tr><tr><td>9:24</td><td>ピトー管銀シート取り付け完了</td></tr><tr><td>12:56</td><td>桟橋へ移動開始</td></tr><tr><td>13:25</td><td>桟橋垂直尾翼チェック完了</td></tr><tr><td>14:06</td><td>フライト</td></tr><tr><td>14:19</td><td>機体回収作業開始</td></tr><tr><td>14:41</td><td>フライトデータ確認</td></tr></tbody></table><h3 id=取得データ>取得データ</h3><p>メイン電装部・機体下電装部・エアデータ電装部について，基板が脱落することなく全て回収できた．micro SDカードのデータも全て回収できた．</p><p><img src=/images/blog/birdman-glider-avionics/gps.png alt loading=lazy><br><img src=/images/blog/birdman-glider-avionics/data.png alt loading=lazy></p><ul><li>対気速度はプラホ上でも手持ちの風速計に比べて0.5 ~ 0.8程度遅かった</li><li>ロールピッチはオフセットが±1程度あるかも(一応補正済み)</li></ul><p><img src=/images/blog/birdman-glider-avionics/alt.png alt loading=lazy></p><ul><li>高度全般<ul><li>5mから降下する時の超音波高度がメイン気圧と機体下気圧と一致しているので，この2つは信用できそう．気圧高度は着水後が0mになるように初期値を12mに設定してグラフにした．離陸滑走時の気圧高度のノイズはダイヤフラムの振動が原因と考えられる．</li><li>エアデータ気圧に関して，ピトー管で測定した動圧を引いた値と生の値の中間にメイン気圧と機体下気圧があるので信頼性が低い．ピトー管を取り付けた翼の穴から風が回り込んで動圧がかかり高度が下がること，翼がたわんで高度が上がることの両方が考えられ，その影響具合を評価できない．</li><li>GPS高度はもともと信頼性が低いが，傾向は問題なかった．</li></ul></li><li>気圧高度が時間経過とともに上昇した．<ul><li>フライト中は短いため分かりづらいが，フライト前のデータでは顕著だった．</li><li>フライト直前にコクピの銀シートを外したため，コクピ内部の温度が上昇，気圧が低下していく傾向にあったのが原因と思われる．</li><li>全組は屋内で，屋外のテストフライトではカウルをつけなかったため問題が発覚しなかった．</li><li>気圧高度だけでなく気圧と温度の生データを保存したので解析が可能だった．(生データは必ず記録すること)</li><li>対策は難しそう．<ul><li>早めに銀シートを外してコクピを暑い平衡状態にするとパイロットが大変．</li><li>気圧センサを外部に露出させると動圧がかかる．</li></ul></li></ul></li><li>超音波高度の問題<ul><li>最終全組で超音波センサの外れ値問題に気づく．<ul><li>単発の外れ値は問題ないようにソフトの対策は事前に行った．</li></ul></li><li>フライト当日に0m付近の値を連続して出力する問題に気づく．<ul><li>湖岸移動中の動作確認で発覚し，平らな板としてPCを砂浜に置くと正常に動作したため，砂浜との相性問題の可能性が考えられた．</li><li>連続した外れ値の対策は，アクセスが容易なメイン電装部ではなく，カウルを取り外してアクセスする機体下電装部で行う必要があった．</li><li>水面では動作する可能性が0ではなく，フライトを遅延させる可能性があり，パイロットには高度計の値が信頼できない可能性を伝えたうえでデバッグはしなかった．</li></ul></li><li>超音波の外れ値により発進判定が誤作動した．<ul><li>外れ値が連続したため誤作動した．</li><li>偽陰性よりは偽陽性の方がマシなので，誤作動を強く防ぐロジックは組まなかった．</li><li>そもそもソフトに頼らずパイロットによるスイッチ操作を実装するべきだった．</li></ul></li><li>外れ値の原因はセンサーの特性ではなくハードウェアの故障だった．<ul><li>事前にセンサーの特性を試験していれば，外れ値が故障だと判断できた．</li><li>事前の試験がなくても，予備基板で試験を行って問題が起きているFMと比較することはできたはず．</li></ul></li><li>姿勢が乱れたときに高度測定ができなかったが，これはしょうがない．</li></ul></li></ul><h3 id=運用面の反省>運用面の反省</h3><h5 id=悪かったこと>悪かったこと</h5><ul><li>機体を組み立てるマニュアルは作っておいたが，テントから移動を開始しプラホから飛ぶまでのマニュアルが無かった．<ul><li>SDカードケース・LiPoの防爆バッグを回収班に渡すのを忘れた．</li></ul></li><li>熱対策の具体的な方法を事前に考えていなかった．<ul><li>サーボモータ<ul><li>唯一サーマルシャットダウン機能がある部品で，重点的に保護した．</li><li>テール桁のサーボの前後の部分に氷をあて，タオルで巻いて養生テープで固定した．(移動5時間で3回交換)</li><li>サーボ本体は結露を防ぐため氷はあてず，銀シートを巻いて直射日光が当たらないようにした．</li></ul></li><li>コクピ<ul><li>銀シートをコクピ上に被せた</li></ul></li><li>エアデータ電装部<ul><li>銀シートを被せた．</li></ul></li></ul></li><li>GPSの測位状態をダウンリンクしていなかったため，電源を入れるコクピ保持の人に1PPSのLEDを見てもらう手間があった．</li><li>湖岸でインターネットが使えなかった．<ul><li>データシートはダウンロードできないし，このオンラインのページも見れない．</li><li>全リポジトリは最新にして，必要な資料はローカルに落とす．</li><li>docomo,auが輻輳，softbank,楽天はヌルヌルで人力のサーバーアップもOKだったらしい．</li><li>読売の通信網にソフトバンクがついてるので，ソフトバンクユーザーを把握しておくと良い．</li></ul></li><li>予備のケーブルを作っておかなかった．<ul><li>材料はあるから前日に気づいたら作れるし，当日に断線したら諦めて飛ばすし，まあいいかって気持ちだった．</li><li>(予備を作ると予備を作ってないところが壊れるジンクス)</li></ul></li><li>超音波センサーの保護カバーをつけておくべきだった．<ul><li>今年は必須ではなかったが，雨だったら必須．</li></ul></li></ul><h5 id=良かったこと>良かったこと</h5><ul><li>Twitterで他チームの電装情報を見てサーボの熱対策ができた．<ul><li>Meisterさんのサーマルシャットダウンのツイート見てなかったら危なかった．</li></ul></li><li>LINEの自分だけのグループでシーケンスを記録した．</li><li>ほぼマニュアルに沿って運用できた．</li><li>動作不良による"電装待ち"が無かった．<ul><li>直さなくても飛べるバグ(今回は超音波の問題)なら見逃す判断も大事．</li></ul></li><li>ポケットに入るハサミと養生テープが便利だった．</li><li>ポケットたくさんある空調服は神．</li></ul><h2 id=評価>評価</h2><h3 id=サクセスクライテリア成否>サクセスクライテリア成否</h3><h4 id=操舵-2>操舵</h4><table><thead><tr><th>サクセスレベル</th><th>内容</th><th>成否</th></tr></thead><tbody><tr><td>Minimum</td><td>プラホ上のラダー動作チェックでGo</td><td>✅</td></tr><tr><td>Full</td><td>飛行中に操舵し，動画などで確認する</td><td>✅</td></tr><tr><td>Advanced</td><td>操舵角のデータを回収する</td><td>✅</td></tr></tbody></table><h4 id=テレメトリ-2>テレメトリ</h4><table><thead><tr><th>サクセスレベル</th><th>内容</th><th>成否</th></tr></thead><tbody><tr><td>Minimum</td><td>組立て時やプラホ上での電装の動作確認に使用する</td><td>✅</td></tr><tr><td>Full</td><td>プラットフォーム上で姿勢を確認する</td><td>✅</td></tr><tr><td>Advanced</td><td>フライト中にテレメトリを受信する</td><td>✅</td></tr></tbody></table><h4 id=高度速度計-2>高度速度計</h4><table><thead><tr><th>サクセスレベル</th><th>内容</th><th>成否</th></tr></thead><tbody><tr><td>Minimum</td><td>飛行中に高度と速度を読み上げる</td><td>✅</td></tr><tr><td>Full</td><td>読み上げた高度と速度が異常な値でない</td><td>❌</td></tr><tr><td>Advanced</td><td>発進判定を正常に行う</td><td>❌</td></tr></tbody></table><h4 id=ロガー-2>ロガー</h4><table><thead><tr><th>サクセスレベル</th><th>内容</th><th>成否</th></tr></thead><tbody><tr><td>Minimum</td><td>飛行中の一つ以上のデータを回収する</td><td>✅</td></tr><tr><td>Full</td><td>全ての種類の着水までの全データを回収する</td><td>✅</td></tr><tr><td>Advanced</td><td>Fullを満たし，全てのデータが信頼できる値である</td><td>❌</td></tr></tbody></table><h3 id=評価点>評価点</h3><h4 id=マネジメント系>マネジメント系</h4><ul><li>設計の根拠が記録に残っているため，仕様変更のときに判断がしやすかった．</li><li>全組・TFで班長が不在のときがあったが，マニュアルに沿って運用できた．</li></ul><h4 id=ハードウェア系>ハードウェア系</h4><ul><li>バスはRS-485やCANにする必要はなく，スター型のUARTで必要十分だった．</li><li>インジケータLEDやテレメトリにより電装の状態が分かりデバッグがしやすかった．</li><li>機体回収時，メイン電装を外さずにSDカードだけ簡単に回収できる設計だった．</li></ul><h4 id=ソフトウェア系>ソフトウェア系</h4><ul><li>定期的にリファクタリングしてコードの可読性を保った．</li><li>直pushしかしてないとはいえ，GitHub Desktopでdiffを確認してからコミットできるので便利だった．</li><li>マイコンの種類がDueとXIAOで異なるが，同じSAMシリーズで割り込みの優先度設定が同じようにできた．<ul><li>結局割り込みは使わずXIAOもRP2040に変えた．</li><li>来年は全てRP2040統一が良さそう．</li></ul></li></ul><h3 id=反省点>反省点</h3><h4 id=マネジメント系-1>マネジメント系</h4><ul><li>テストを多く行うべきだった．<ul><li>全組やTFなどの各タイミングに必要な最低限の機能を揃えるという意識になってしまったため，テストが十分にできなかった．<ul><li>センサー等，コンポーネント単位で早めにロングラン試験を行う．</li><li>部品を壊す可能性があるものも含めテストをEMで徹底的に行う．</li><li>長い時間が取れる全組・TFの機会を無駄にしない．</li></ul></li><li>実機が一つしかないため，ソフトウェア開発で専有されてハードウェアのテストが十分行えなかった．<ul><li>EMとBBM，FMとEMなどの組み合わせで両方の作業を同時に行う．</li></ul></li><li>可能であれば<code>TORICA_lib</code>のテストコードを書く，</li></ul></li><li>新入生教育と電装製作の両立が難しかった．<ul><li>一応来年の<a href=#%E6%95%99%E8%82%B2%E3%83%BB%E5%BD%B9%E5%89%B2%E5%88%86%E6%8B%85>役割分担</a>を見据えて仕事は振ったつもり．</li></ul></li><li>超音波センサのトラブル対応に問題があった．<ul><li>超音波の不具合に関して，外れ値を出すハードをソフトでどうにかするという発想しかなかった．</li><li>あらゆるトラブルについて，それを抱えたま対処方法を考える人と根本原因を探る人を分けて対応するべき．</li><li>琵琶湖で緊急度の高いインシデントが起きたときも，インシデント管理と問題管理の人員を分ける．</li></ul></li></ul><h4 id=ハードウェア系-1>ハードウェア系</h4><ul><li>超音波高度センサが故障した．<ul><li>温度上昇による気圧高度変化を除き，サクセスクライテリア未達の原因は全てこれ．</li><li>ハードウェアの故障だと判断して交換することができなかった．正常性バイアスもあるかも．</li></ul></li><li>センサーの特性試験を行うべきだった．<ul><li>既製品より自分の組んだハード・ソフトの方が信用ならない経験ばかりだったので，既製品のテストの優先度が低く手が回らなかった．</li><li>事前に特性試験をしていれば外れ値を出すことが故障だと判断できたはず．</li><li>そもそも測定レンジが足りるか精度が問題ないかの試験もデータシートを鵜呑みにせず行うべき．</li></ul></li><li>重量がかさむ固定方法になってしまった．<ul><li>電装班としてはかなり便利だったので，設計変更時はメンテナンスや運用の視点も忘れずに．</li></ul></li><li>翼のケーブルのはんだ付けが職人技すぎる．<ul><li>翼を馬においた状態で，リブから出たケーブルに半田付けするのが慣れてないと相当難しい．</li><li>半田スリーブに頼る予定だったが，あまり良い製品ではなかった．</li><li>翼内のケーブルなど高難度の半田付けはもっと練習を重ねるべき．</li></ul></li><li>ラダーのコントローラをよく選定したい．<ul><li>アナログ入力を読むためジョイスティックを使用したが，実際はアナログではなくPWMのような操舵を行った．</li><li>今回のジョイスティックは小さく操作が繊細で，フルスイングで振るならスイッチの方が適しているはず．</li></ul></li><li>メイン電装をRaspberry Pi Picoにするべき．<ul><li>開発を始めた当時はラズピコがあまり普及しておらずArduino Dueの方が安定していると判断したが，今はもうOK．</li><li>DueではUARTのポート数に余裕がなかったが，RP2040ではPIOでUARTを増やせる．</li><li>Arduino Dueより小型化できる．</li><li>他のXIAO RP2040と同じチップなのでソフトウェアの移植が容易．</li><li>デュアルコアが便利．</li></ul></li><li>DCDC周辺の回路が雑で，出力側からの逆流に対して脆弱．<ul><li>メイン電装との接続を切ってからUSBケーブルを繋ぐよう運用でカバーしてたので対策が必要．</li></ul></li><li>サーボモータの詳細設定作業が終わらなかった．<ul><li>トラブルが起きてもサーボを交換できないためテール桁に埋め込んだ後は作業を行わなかった．</li><li>サーマルシャットダウンに関する設定もあるのでEEPROMの設定は変えておきたい．</li></ul></li><li>今年はトラブルは起きていないが，部品の表面処理と半田の材質(鉛フリーかどうか)を合わせた方が良さそう．</li><li>基板にデカップリング・コンデンサをつけ忘れた．気づいたけど修正するのを忘れて発注してしまった．</li><li>UARTのRX側にプルアップ抵抗をつけ忘れた．</li></ul><h4 id=ソフトウェア系-1>ソフトウェア系</h4><ul><li><p>SDアクセス中に割り込みできるようにし，スケジューリングの自由度をあげたい．</p></li><li><p>部品のロングラン試験ができるコードを早く書く．</p></li><li><p>記録したcsvからグラフを生成するpythonコードを書く．</p><ul><li>データの確認を簡単にしてテストをしやすくする．</li></ul></li><li><p>自力でライブラリを書かないことを目標にしたものの，TORICA_libがそれなりに難しい実装だった．</p><ul><li>難しい部分をライブラリに押し込むことはできたが，結局低レイヤーの難しさは排除できなかった．</li></ul></li><li><p>XIAOのブートローダーの仕様が致命的だった．</p><ul><li>FM製作後に気づいてしまった．BBM段階でソフトウェアを完成させることが非常に重要．</li></ul></li><li><p>GPSモジュールから出力される対地速度を保存するべきだった．</p><ul><li>今回は緯度経度から対地速度を計算した．</li></ul></li></ul><h2 id=来年の方針>来年の方針</h2><p>(無責任な老害が考えたことなので判断は現役に任せます)</p><p>似た部品を使うハイブリッドロケット電装の経験がありスムーズ(?)に開発できましたが，来年は以下のことを意識すると良いと思います．</p><ul><li>設計が流用しつつ，今年の<a href=#%E5%8F%8D%E7%9C%81%E7%82%B9>反省点</a>を参考に改善する<ul><li>流用できるとはいえ，設計の根拠まで理解して使用すること</li></ul></li><li>BBM2回，EM1回，FM1回を作れるスケジュールで動くこと<ul><li>経験値をつけるためには手を動かして失敗するしかない</li></ul></li><li>役割分担を明確にすること<ul><li>ハードからソフトまでやることが多く，幸い班員も多いので分担できる</li><li>各担当にそれぞれの責任を果たせている感覚を持ってもらうこと<ul><li>真に人海戦術ができる場合を除き，基本的に一つの仕事は一人でやる<br>（相互にレビューはするべき）</li><li>誰かの仕事を待っている人は，明確に休み期間にするor別の仕事をはっきり割り当てる</li></ul></li></ul></li></ul><h3 id=教育役割分担>教育・役割分担</h3><p>一年で全領域を一人でマスターするのは厳しいので役割分担をした方が良さそう．基本的には以下のような役割分担で進める．サーボモータ・超音波センサ・電源回路など，狭いスコープを徹底的に詰める人が他にいてもいいかも．</p><ul><li>マネジメント<ul><li>全体の進捗管理，設計のレビュー，テストケースの作成を行う<br>要求を満たすものを期日までに完成させるのがマネージャーの目標</li><li>マネージャーはソフトウェアのスキルを持っているとうまく回るはず<br>最後にソフトウェアが詳細な仕様を決定するので（諸説）</li></ul></li><li>ソフトウェア開発・回路設計<ul><li>ブレッドボードでの試作，KiCad上での回路図作成，ソフトウェア開発を行う</li><li>組み込みソフトなので回路設計とソフトウェアは分担しない<br>当然ここが一番キツい仕事</li></ul></li><li>ハードウェア設計<ul><li>設計済みの回路図からKiCadで基板設計を行う</li><li>他の班と調整し，基板の形状や搭載方法の設計も行う</li></ul></li><li>ハードウェア製作<ul><li>はんだ付けなど全てのハードウェアの組立てを行う</li><li>ただの単純作業ではなく，品質を担保するためには高度な技術が必要</li></ul></li><li>テスト<ul><li>製作側は手一杯になるので，別の人が念入りにテストを行う</li><li>センサーのテストを通してソフト回路全般の知識をつける</li></ul></li></ul><h3 id=スケジュール-1>スケジュール</h3><p>電装は製作物が一点物で単純作業が無く，教えながら作業するのがまず不可能．<br>4月以降は新入生教育に専念できるように3月にはロールアウトできるスケジュールを目指す．</p><div class=mermaid>gantt
dateFormat YYYY-MM-DD
axisFormat %m
todayMarker off
excludes weekends
%% (`excludes` accepts specific dates in YYYY-MM-DD format, days of the week ("sunday") or "weekends", but not the word "weekdays".)
section 全体
基本設計 :compo , 2023-08-01,2023-09-01
新部品 :compo , 2023-09-01,2023-10-01
統合BBM :bbm2 , 2023-09-01,2023-11-01
EM :em , 2023-11-01,2024-01-01
休み :exam , 2024-01-01,2024-02-01
FM :fm , 2024-02-01,2024-04-01
FM詳細設計最終レビュー :milestone , 2024-03-01,1d
新入生教育 :edu , 2024-04-01,2024-06-01
全組TF等運用 :op , 2024-06-01,2024-07-30
鳥コン！ :milestone , 2024-07-30,1d
section ソフト開発<br>回路設計
新部品BBM回路・ソフト :compo , 2023-09-01,2023-10-01
統合BBMの回路設計 :bbm , 2023-09-01,2023-11-01
BBMでソフト開発 :em2 , 2023-10-01,2023-12-01
EMの回路設計 :em , 2023-11-01,2023-11-14
EMでソフト開発 :em2 , 2023-12-21,2024-03-01
FMの回路設計 :fm , 2024-02-01,2024-02-14
FMでソフト開発 :fm2 , 2024-03-14,2024-04-14
section ハード設計
基板の搭載方法については適宜設計陣と調整 :hw , 2023-09-02,2023-09-01
Lチカ基板設計 :pcb , 2023-09-01,2023-10-01
マイコン練習用基板設計 :pcb2 , 2023-10-01,2023-11-01
EM基板設計 :em , 2023-11-14,2023-12-01
搭載位置・方法確定 :hw2 , 2023-12-01,2024-01-01
FM基板設計 :fm , 2024-02-14,2024-03-01
section ハード製作
ケーブルはんだ付け箇所試作 :cable , 2023-09-01,2023-10-01
Lチカ基板実装 :pcb , 2023-10-07,2023-10-14
センサー単体テスト用基板作成 : unit , 2023-10-14,2023-11-01
マイコン練習用基板実装 :pcb2 , 2023-11-07,2023-11-14
EMケーブル作製 :em , 2023-11-14,2023-12-01
EM基板実装 :em , 2023-12-14,2023-12-21
FMケーブル作製 :fm , 2024-02-14,2024-03-01
FM基板実装 :fm , 2024-03-07,2024-03-14
section テスト
センサーのみの回路ソフトの理解 : learn , 2023-09-01,2023-11-01
センサー単体テスト : unit , 2023-11-01,2023-12-01
BBM統合テスト : bbm , 2023-12-01,2024-01-01
EM統合テスト : em , 2024-02-01,2024-03-01
FM統合テスト : fm , 2024-04-14,2024-05-14</div><script>(function(){if(window.isMermaidLoaded)return;window.isMermaidLoaded=true;const script=document.createElement('script');script.src='https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js';script.onload=()=>{mermaid.initialize({startOnLoad:true});};document.body.appendChild(script);})();</script><h2 id=参考資料>参考資料</h2><p>電装系の資料は<a href=https://771-8bit.com/blog/for-beginners/#%E5%BF%85%E8%A6%81%E3%81%AA%E7%9F%A5%E8%AD%98%E3%82%B9%E3%82%AD%E3%83%AB>無限にある</a>ので，鳥コンの電装の資料のみ</p><ul><li><a href=https://hpaavio.blogspot.com/>Avionics for HPA 人力飛行機の電装系の製作日誌</a> Team&rsquo;F&rsquo;の電装の方のブログ</li><li><a href=https://shop.cqpub.co.jp/hanbai/books/MIF/MIF202302.html>Interface 2023年2月号～ 連載 舞いあがれ人力飛行機</a> ↑と同じ方の連載</li></ul><h2 id=さいごに>さいごに</h2><p><img src=/images/blog/birdman-glider-avionics/ob.jpg alt=ob loading=lazy><br>嬉しいよね</p></article><script defer src=/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js></script><script defer src=/js/helper/prev.min.js></script><script defer src=/js/helper/prop.min.js></script><script>'use strict';document.addEventListener('DOMContentLoaded',function(){var clipInit=false;var preChromaElem=document.querySelectorAll('pre.chroma');var langCodeElem=document.querySelectorAll('.language-code');var dollarCodeElem=document.querySelectorAll('div.language-\\$');var gtCodeElem=document.querySelectorAll('div.language-\\>');var makeClipboard=function(elem){var code=elem,text=elem.textContent;if(text.length>15){if(!clipInit){var text,clip=new ClipboardJS('.copy-to-clipboard',{text:function(trigger){var codeElem=prev(trigger).querySelectorAll('code');if(codeElem.length>1){text=prev(trigger).querySelector('code[class^="language-"]').textContent;}else{text=prev(trigger).querySelector('code').textContent;}
return text.replace(/^\$\s/gm,'');}});var inPre;clip.on('success',function(e){e.clearSelection();inPre=prop(e.trigger.parentNode,'tagName')=='PRE';e.trigger.setAttribute('aria-label','Copied to clipboard!');e.trigger.classList.add('tooltipped');e.trigger.classList.add('tooltipped-w');});clip.on('error',function(e){inPre=prop(e.trigger.parentNode,'tagName')=='PRE';e.trigger.setAttribute('aria-label',e.action.toString());e.trigger.classList.add('tooltipped');e.trigger.classList.add('tooltipped-w');});clipInit=true;}
var notAllowedClass=['language-mermaid','language-viz','language-wave','language-chart','language-msc','language-flowchart'];var isNotAllowedIncluded=false;var curClassName=code.getAttribute('class');for(var i=0;i<notAllowedClass.length;i++){if(curClassName&&curClassName.startsWith(notAllowedClass[i])){isNotAllowedIncluded=true;break;}}
if(!isNotAllowedIncluded){if(curClassName){var newClipboardElem=document.createElement('span');newClipboardElem.setAttribute('class','copy-to-clipboard');newClipboardElem.setAttribute('title','Copy to clipboard');elem.parentNode.parentNode.insertBefore(newClipboardElem,elem.parentNode.nextElementSibling);}}}}
var makeSymbolClipboard=function(elem){var clipboardSpan=document.createElement('span');clipboardSpan.setAttribute('class','copy-to-clipboard');clipboardSpan.setAttribute('title','Copy to clipboard');elem.parentNode.parentNode.insertBefore(clipboardSpan,elem.parentNode.nextElementSibling);}
preChromaElem?preChromaElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeClipboard(codeElem);});}):null;langCodeElem?langCodeElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeClipboard(codeElem);});}):null;dollarCodeElem?dollarCodeElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeSymbolClipboard(codeElem);});}):null;gtCodeElem?gtCodeElem.forEach(function(elem){elem.querySelectorAll('code').forEach(function(codeElem){makeSymbolClipboard(codeElem);});}):null;});</script><script>'use strict';function wrap(el,wrapper){el.parentNode.insertBefore(wrapper,el);wrapper.appendChild(el);}
(function(){var singleContentsElem=document.querySelector('.single__contents');singleContentsElem?singleContentsElem.querySelectorAll('pre > code').forEach(function(elem){var dataLang=elem.getAttribute('data-lang');var dataLangWrapper=document.createElement('div');var code=null;var codeTitle=null;if(dataLang&&dataLang.includes(':')){code=dataLang.split(':')[0];codeTitle=dataLang.split(':')[1];dataLangWrapper.className='language-'+code;dataLangWrapper.setAttribute('data-lang',codeTitle);elem.className='language-'+code;elem.setAttribute('data-lang',codeTitle);elem.setAttribute('id',codeTitle);}else if(!dataLang){dataLangWrapper.setAttribute('data-lang','Code');dataLangWrapper.className='language-code';}
if(!dataLang||codeTitle){wrap(elem.parentNode,dataLangWrapper);}}):null;})();var langCodeElem=document.querySelectorAll('.language-code');langCodeElem?langCodeElem.forEach(function(elem){var newElem=document.createElement('span');newElem.className='copy-to-clipboard';newElem.setAttribute('title','Copy to clipboard');elem.append(newElem);}):null;var dollarCodeElem=document.querySelectorAll('div.language-\\$');var gtCodeElem=document.querySelectorAll('div.language-\\>');dollarCodeElem?dollarCodeElem.forEach(function(elem){var lnts=elem.parentNode.parentNode?elem.parentNode.parentNode.querySelectorAll('.lnt'):null;lnts?lnts.forEach(function(lnt){lnt.innerHTML='$<br/>';}):null;}):null;gtCodeElem?gtCodeElem.forEach(function(elem){var lnts=elem.parentNode.parentNode?elem.parentNode.parentNode.querySelectorAll('.lnt'):null;lnts?lnts.forEach(function(lnt){lnt.innerHTML='><br/>';}):null;}):null;</script><div class=whoami__gutter></div><hr class="hr-slash whoami-hr"><section class=whoami><div class=whoami__image-wrapper><img data-src=/images/whoami/avatar.jpg src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDI0djI0SDBWMHoiLz48cGF0aCBmaWxsPSIjYWFhIiBkPSJNMTkgM0g1Yy0xLjEuMC0yIC45LTIgMnYxNGMwIDEuMS45IDIgMiAyaDE0YzEuMS4wIDItLjkgMi0yVjVjMC0xLjEtLjktMi0yLTJ6bS0xIDE2SDZjLS41NS4wLTEtLjQ1LTEtMVY2YzAtLjU1LjQ1LTEgMS0xaDEyYy41NS4wIDEgLjQ1IDEgMXYxMmMwIC41NS0uNDUgMS0xIDF6bS00LjQ0LTYuMTktMi4zNSAzLjAyLTEuNTYtMS44OGMtLjItLjI1LS41OC0uMjQtLjc4LjAxbC0xLjc0IDIuMjNjLS4yNi4zMy0uMDIuODEuMzkuODFoOC45OGMuNDEuMC42NS0uNDcuNC0uOGwtMi41NS0zLjM5Yy0uMTktLjI2LS41OS0uMjYtLjc5LjB6Ii8+PC9zdmc+ alt=8bitマイコン class="lazyload whoami__image"></div><div class=whoami__contents><div class=whoami__written-by>著者</div><div class=whoami__title>8bitマイコン</div><div class=whoami__desc>組み込み周りで遊ぶ宇宙好き</div><div class=whoami__social><a href=https://github.com/771-8bit title=github aria-label=github><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24"><g id="surface3680"><path fill="currentcolor" d="M10.898438 2.101562C6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 8.699219 21.398438 9 21.199219 9 20.800781V19.199219S8.601562 19.300781 8.101562 19.300781C6.699219 19.300781 6.101562 18.101562 6 17.398438 5.898438 17 5.699219 16.699219 5.398438 16.398438 5.101562 16.300781 5 16.300781 5 16.199219 5 16 5.300781 16 5.398438 16 6 16 6.5 16.699219 6.699219 17 7.199219 17.800781 7.800781 18 8.101562 18 8.5 18 8.800781 17.898438 9 17.800781 9.101562 17.101562 9.398438 16.398438 10 16 7.699219 15.5 6 14.199219 6 12 6 10.898438 6.5 9.800781 7.199219 9 7.101562 8.800781 7 8.300781 7 7.601562 7 7.199219 7 6.601562 7.300781 6 7.300781 6 8.699219 6 10.101562 7.300781 10.601562 7.101562 11.300781 7 12 7S13.398438 7.101562 14 7.300781C15.300781 6 16.800781 6 16.800781 6 17 6.601562 17 7.199219 17 7.601562 17 8.398438 16.898438 8.800781 16.800781 9 17.5 9.800781 18 10.800781 18 12 18 14.199219 16.300781 15.5 14 16 14.601562 16.5 15 17.398438 15 18.300781V20.898438C15 21.199219 15.300781 21.5 15.699219 21.398438 19.398438 19.898438 22 16.300781 22 12.101562 22 6.101562 16.898438 1.398438 10.898438 2.101562zm0 0"/></g></svg></a><a href=https://twitter.com/771_8bit title=twitter aria-label=twitter><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32"><g id="surface676"><path fill="currentcolor" d="M28 8.558594C27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 5.246094 7.875 5.003906 8.722656 5.003906 9.625 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469c0 .023437000000001262.0.042969000000001145.0.0625C4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 4.777344 23.609375 4.386719 23.585938 4 23.539062 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 26.503906 10.410156 27.339844 9.542969 28 8.558594zm0 0"/></g></svg></a></div></div></section><hr class="hr-slash whoami-hr"><section class=related></section><div class=grow></div><nav class=pagination-single><div class=grow></div></nav><div class="modal micromodal-slide" id=modal aria-hidden=true><div class=modal__overlay tabindex=-1 data-micromodal-close><div class=modal__container role=dialog aria-modal=true aria-labelledby=modal-title><div class=modal__content id=modal-content><div id=mySwipe class=swipe><div class=swipe-wrap></div></div></div><span class=modal__items><span class=modal__header><div class=modal__paging title="Page Info" aria-label="Current Page"></div><div class="modal__icon modal__toolbar modal__toolbar--close" title=Close aria-label="Close Button" data-micromodal-close><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentcolor" d="M21.734375 19.640625 19.636719 21.734375C19.253906 22.121094 18.628906 22.121094 18.242188 21.734375L13 16.496094 7.761719 21.734375C7.375 22.121094 6.746094 22.121094 6.363281 21.734375L4.265625 19.640625C3.878906 19.253906 3.878906 18.628906 4.265625 18.242188L9.503906 13 4.265625 7.761719C3.882813 7.371094 3.882813 6.742188 4.265625 6.363281L6.363281 4.265625C6.746094 3.878906 7.375 3.878906 7.761719 4.265625L13 9.507813 18.242188 4.265625C18.628906 3.878906 19.257813 3.878906 19.636719 4.265625L21.734375 6.359375C22.121094 6.746094 22.121094 7.375 21.738281 7.761719L16.496094 13 21.734375 18.242188C22.121094 18.628906 22.121094 19.253906 21.734375 19.640625z"/></svg></div><div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentcolor" d="M5 3C3.9069372 3 3 3.9069372 3 5V8A1.0001 1.0001.0 105 8V5H8A1.0001 1.0001.0 108 3H5zM16 3a1.0001 1.0001.0 100 2h3V8a1.0001 1.0001.0 102 0V5C21 3.9069372 20.093063 3 19 3H16zM3.984375 14.986328A1.0001 1.0001.0 003 16v3C3 20.093063 3.9069372 21 5 21H8a1.0001 1.0001.0 100-2H5V16A1.0001 1.0001.0 003.984375 14.986328zm16 0A1.0001 1.0001.0 0019 16v3H16a1.0001 1.0001.0 100 2h3C20.093063 21 21 20.093063 21 19V16A1.0001 1.0001.0 0019.984375 14.986328z"/></svg></div><div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentcolor" d="M16.96875 4.972656C15.867188 4.988281 14.984375 5.894531 15 7v8H7C6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 5.609375 18.632813 6.277344 19.011719 7 19H19V7C19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656zm16 0C31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 31 6.90625 31 6.953125 31 7V19H43C43.066406 19 43.132813 19 43.199219 18.992188 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 44.964844 15.828125 44.074219 14.988281 43 15H35V7C35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656zM7 31C6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 5.609375 34.632813 6.277344 35.011719 7 35h8v8C14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 18.632813 44.390625 19.011719 43.722656 19 43V31zm24 0V43C30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 34.632813 44.390625 35.011719 43.722656 35 43V35h8C43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 44.390625 31.367188 43.722656 30.988281 43 31z"/></svg></div></span><div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentcolor" d="M23.28125 11 10 10V6.851563C10 6.523438 9.839844 6.277344 9.519531 6.03125 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 2.003906 12.980469 2 12.988281 2 12.992188 2 13.15625 2.078125 13.402344 2.160156 13.484375 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 9.839844 19.722656 10 19.476563 10 19.148438V16l13.28125-1C23.679688 14.679688 24 13.875 24 12.992188 24 12.195313 23.761719 11.320313 23.28125 11z"/></svg></div><div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentcolor" d="M2.71875 11.023438l13.28125-1V6.875C16 6.546875 16.160156 6.300781 16.480469 6.054688 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 23.917969 12.601563 23.992188 12.835938 23.996094 13 23.996094 13.003906 24 13.011719 24 13.015625 24 13.179688 23.921875 13.425781 23.839844 13.507813 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 16.160156 19.746094 16 19.5 16 19.171875V16.023438L2.71875 15.023438C2.320313 14.703125 2 13.898438 2 13.015625 2 12.21875 2.238281 11.34375 2.71875 11.023438z"/></svg></div><div class=modal__caption><div class=modal__caption--text></div></div></span></div></div></div><script defer src=/js/swipe.min.b4b82839155519d9ca67746615a4c86ccbc1061c196fe6d8aa26e4fe22902718.js></script><script defer src=/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js></script><script defer src=/js/helper/fadeinout.min.js></script><script>document.addEventListener('DOMContentLoaded',function(){var docElem=document.documentElement;function openFullscreen(){if(docElem.requestFullscreen){docElem.requestFullscreen();}else if(docElem.mozRequestFullScreen){docElem.mozRequestFullScreen();}else if(docElem.webkitRequestFullscreen){docElem.webkitRequestFullscreen();}else if(docElem.msRequestFullscreen){docElem.msRequestFullscreen();}}
function closeFullscreen(){if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement){if(document.exitFullscreen){document.exitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitExitFullscreen){document.webkitExitFullscreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}}}
var modal=document.getElementById('modal');var galleryContainerElem=document.querySelector('.gallery__container');var swipeWrapElem=document.querySelector('.swipe-wrap');var mySwipeElem=document.getElementById('mySwipe');var arrowLeftElem=document.querySelector('.modal__arrow--left');var arrowRightElem=document.querySelector('.modal__arrow--right');var closeElem=document.querySelector('.modal__toolbar--close');var fullElem=document.querySelector('.modal__toolbar--full');var normalElem=document.querySelector('.modal__toolbar--normal');var captionElem=document.querySelector('.modal__caption');var pagingElem=document.querySelector('.modal__paging');var itemsElem=document.querySelector('.modal__items');var imgTotalNum=null;var myFadeTimeout=null;var mySwipe=null;var keydownFunction=function(e){if(e.key==='ArrowRight'){if(modal&&modal.classList.contains('is-open')){mySwipe.next();}}else if(e.key==='ArrowLeft'){if(modal&&modal.classList.contains('is-open')){mySwipe.prev();}}}
if(galleryContainerElem){imgTotalNum=galleryContainerElem.querySelectorAll('img').length;}else{galleryContainerElem=document.querySelector('.single__contents');imgTotalNum=galleryContainerElem.querySelectorAll('img').length;}
MicroModal.init({onClose:function(){if(mySwipe){mySwipe.kill();mySwipe=null;closeFullscreen();}
window.removeEventListener('keydown',keydownFunction);},disableScroll:true,disableFocus:true,awaitOpenAnimation:false,awaitCloseAnimation:false,debugMode:false,});var imageLoad=function(src){return new Promise(function(resolve,reject){var newImg=new Image;newImg.onload=function(){resolve(newImg);}
newImg.onerror=reject;newImg.src=src;});}
galleryContainerElem.querySelectorAll('img').forEach(function(elem,idx){elem.style.cursor='pointer';var clonedElem=elem.cloneNode(true);clonedElem.style.maxHeight='100%';clonedElem.style.maxWidth='100%';clonedElem.onclick=function(e){e.stopPropagation();}
var wrapper=document.createElement('div');wrapper.style.width='100%';wrapper.style.height='100vh';wrapper.setAttribute('data-micromodal-close','');wrapper.onclick=function(){if(mySwipe){mySwipe.kill();mySwipe=null;}}
wrapper.onmouseenter=function(){clearTimeout(myFadeTimeout);fadeIn(itemsElem,200);};wrapper.onmouseleave=function(){myFadeTimeout=setTimeout(function(){fadeOut(itemsElem,200);},2500);}
wrapper.ontouchstart=function(){fadeIn(itemsElem,200);}
wrapper.append(clonedElem);swipeWrapElem.append(wrapper);elem.addEventListener('click',async function(e){MicroModal.show('modal');if(mySwipe){mySwipe.kill();mySwipe=null;}
var imgSrc=e.target.getAttribute('data-src')||e.target.getAttribute('src');var img=await imageLoad(imgSrc);clonedElem.style.width=img.width+'px';clonedElem.style.height=img.height+'px';mySwipe=new Swipe(mySwipeElem,{startSlide:idx,draggable:true,autoRestart:false,continuous:false,disableScroll:true,stopPropagation:true,callback:async function(index,element){var imgElem=element.querySelector('img');var imgSrc=imgElem.getAttribute('data-src')||imgElem.getAttribute('src');var img=await imageLoad(imgSrc);imgElem.style.width=img.width+'px';imgElem.style.height=img.height+'px';if(captionElem&&imgElem){var caption=null;if(imgElem.getAttribute('data-caption')){caption=imgElem.getAttribute('data-caption');}else if(imgElem.getAttribute('title')){caption=imgElem.getAttribute('title');}else if(imgElem.getAttribute('alt')){caption=imgElem.getAttribute('alt');}else{caption=imgElem.getAttribute('src');}
captionElem.querySelector('.modal__caption--text').innerText=caption;pagingElem.innerText=(index+1)+' / '+imgTotalNum;clearTimeout(myFadeTimeout);fadeIn(itemsElem,200);}},});fadeIn(itemsElem);if(captionElem){var caption=null;if(e.target.getAttribute('data-caption')){caption=e.target.getAttribute('data-caption');}else if(e.target.getAttribute('title')){caption=e.target.getAttribute('title');}else if(e.target.getAttribute('alt')){caption=e.target.getAttribute('alt');}else{caption=e.target.getAttribute('src');}
captionElem.querySelector('.modal__caption--text').innerText=caption;pagingElem.innerText=(idx+1)+' / '+imgTotalNum;}
if(normalElem&&fullElem){normalElem.style.zIndex=-1;normalElem.style.opacity=0;fullElem.style.zIndex=25;fullElem.style.opacity=1;}});window.addEventListener('keydown',keydownFunction);});arrowLeftElem?arrowLeftElem.addEventListener('click',function(e){if(mySwipe){mySwipe.prev();}}):null;arrowRightElem?arrowRightElem.addEventListener('click',function(e){if(mySwipe){mySwipe.next();}}):null;closeElem?closeElem.addEventListener('click',function(){if(mySwipe){mySwipe.kill();mySwipe=null;}
closeFullscreen();MicroModal.close('modal');}):null;fullElem?fullElem.addEventListener('click',function(e){openFullscreen();if(normalElem){normalElem.style.zIndex=25;normalElem.style.opacity=1;fullElem.style.zIndex=-1;fullElem.style.opacity=0;}}):null;normalElem?normalElem.addEventListener('click',function(e){closeFullscreen();if(fullElem){fullElem.style.zIndex=25;fullElem.style.opacity=1;normalElem.style.zIndex=-1;normalElem.style.opacity=0;}}):null;});</script><div class=hide><div class=search><span class=icon><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49.0s.41-1.08.0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></span><input id=search aria-label="Site Search" class=input type=text placeholder=検索 autocomplete=off><div id=search-results class=dropdown><div id=search-menu class=dropdown-menu role=menu></div></div></div></div></div></main><aside class="single__side main-side"><section class="sidebar hide"><script>document.querySelector('.sidebar').classList.remove('hide')</script><div class=toc__flexbox data-position=fixed><h6 class=toc__title data-ani=true>目次</h6><label class=switch data-ani=true><input id=toggle-toc aria-label="Toggle TOC" type=checkbox checked>
<span class="slider round"></span></label></div><div class=toc data-dir=ltr data-folding=false data-ani=true><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#要求定義>要求定義</a></li><li><a href=#要件定義>要件定義</a><ul><li><a href=#共通事項>共通事項</a><ul><li></li></ul></li><li><a href=#操舵>操舵</a></li><li><a href=#テレメトリ>テレメトリ</a></li><li><a href=#高度速度計>高度速度計</a></li><li><a href=#ロガー>ロガー</a></li></ul></li><li><a href=#スケジュール>スケジュール</a></li><li><a href=#基本設計>基本設計</a><ul><li><a href=#全体像>全体像</a></li><li><a href=#物理的な配置>物理的な配置</a></li><li><a href=#質量概算>質量概算</a></li></ul></li><li><a href=#詳細設計製作>詳細設計・製作</a><ul><li><a href=#全体>全体</a><ul><li><a href=#uartフォーマット>UARTフォーマット</a></li><li><a href=#コネクタケーブル>コネクタ・ケーブル</a></li><li><a href=#ブートローダー小噺>ブートローダー小噺</a></li></ul></li><li><a href=#コンポーネントごと>コンポーネントごと</a><ul><li><a href=#電源部>電源部</a></li><li><a href=#メイン電装部>メイン電装部</a></li><li><a href=#ジョイスティック電装部>ジョイスティック電装部</a></li><li><a href=#機体下部電装部>機体下部電装部</a></li><li><a href=#エアデータ電装部>エアデータ電装部</a></li><li><a href=#カメラ>カメラ</a></li></ul></li><li><a href=#配置の詳細>配置の詳細</a><ul><li><a href=#メイン電装部-1>メイン電装部</a></li><li><a href=#サーボのケーブル>サーボのケーブル</a></li><li><a href=#ジョイスティック電装部-1>ジョイスティック電装部</a></li><li><a href=#スピーカー>スピーカー</a></li><li><a href=#機体下電装>機体下電装</a></li><li><a href=#エアデータ電装部-1>エアデータ電装部</a></li><li><a href=#カメラ-1>カメラ</a></li></ul></li></ul></li><li><a href=#製作のポイント>製作のポイント</a><ul><li><a href=#電装基礎知識>電装基礎知識</a></li><li><a href=#ソフトウェアの管理>ソフトウェアの管理</a></li><li><a href=#基板設計>基板設計</a></li><li><a href=#基板実装>基板実装</a></li></ul></li><li><a href=#テスト>テスト</a><ul><li><ul><li><a href=#共通事項-1>共通事項</a></li><li><a href=#操舵-1>操舵</a></li><li><a href=#テレメトリ-1>テレメトリ</a></li><li><a href=#高度速度計-1>高度速度計</a></li><li><a href=#ロガー-1>ロガー</a></li></ul></li></ul></li><li><a href=#完成したシステム>完成したシステム</a><ul><li><a href=#概要>概要</a></li><li><a href=#コンポーネント詳細>コンポーネント詳細</a><ul><li><a href=#メイン基板>メイン基板</a></li><li><a href=#無線ハブ基板>無線ハブ基板</a></li><li><a href=#テレメトリ受信機>テレメトリ受信機</a></li><li><a href=#ジョイスティック電装部-2>ジョイスティック電装部</a></li><li><a href=#機体下部電装部-1>機体下部電装部</a></li><li><a href=#エアデータ電装部-2>エアデータ電装部</a></li></ul></li></ul></li><li><a href=#運用>運用</a><ul><li><a href=#琵琶湖の持ち物>琵琶湖の持ち物</a></li><li><a href=#全組tf運用>全組・TF運用</a><ul><li><a href=#64-全組>6/4 全組</a></li><li><a href=#611-全組>6/11 全組</a></li><li><a href=#618-tf>6/18 TF</a></li><li><a href=#702-全組>7/02 全組</a></li><li><a href=#709-tf>7/09 TF</a></li><li><a href=#722-全組>7/22 全組</a></li></ul></li><li><a href=#組み立て>組み立て</a><ul><li><a href=#テール桁事前準備>テール桁事前準備</a></li><li><a href=#コクピ事前準備>コクピ事前準備</a></li><li><a href=#a翼b翼の接合>A翼B翼の接合</a></li><li><a href=#heading></a></li><li><a href=#電装の検品バッテリー準備>電装の検品・バッテリー準備</a></li><li><a href=#t字桁へのフレーム取り付け>T字桁へのフレーム取り付け</a></li><li><a href=#機体下電装部の接続>機体下電装部の接続</a></li><li><a href=#エアデータ電装部の接続>エアデータ電装部の接続</a></li><li><a href=#尾翼の接続>尾翼の接続</a></li><li><a href=#いつでも動作確認>(いつでも)動作確認</a></li></ul></li><li><a href=#トラブルシュートマニュアル>トラブルシュートマニュアル</a><ul><li><a href=#メイン電装の書き込み>メイン電装の書き込み</a></li><li><a href=#操舵系トラブル>操舵系トラブル</a></li></ul></li></ul></li><li><a href=#鳥コンの運用取得データ>鳥コンの運用・取得データ</a><ul><li><a href=#当日のシーケンス>当日のシーケンス</a><ul><li><a href=#729-フライト前日>7/29 フライト前日</a></li><li><a href=#730-フライト当日>7/30 フライト当日</a></li></ul></li><li><a href=#取得データ>取得データ</a></li><li><a href=#運用面の反省>運用面の反省</a><ul><li></li></ul></li></ul></li><li><a href=#評価>評価</a><ul><li><a href=#サクセスクライテリア成否>サクセスクライテリア成否</a><ul><li><a href=#操舵-2>操舵</a></li><li><a href=#テレメトリ-2>テレメトリ</a></li><li><a href=#高度速度計-2>高度速度計</a></li><li><a href=#ロガー-2>ロガー</a></li></ul></li><li><a href=#評価点>評価点</a><ul><li><a href=#マネジメント系>マネジメント系</a></li><li><a href=#ハードウェア系>ハードウェア系</a></li><li><a href=#ソフトウェア系>ソフトウェア系</a></li></ul></li><li><a href=#反省点>反省点</a><ul><li><a href=#マネジメント系-1>マネジメント系</a></li><li><a href=#ハードウェア系-1>ハードウェア系</a></li><li><a href=#ソフトウェア系-1>ソフトウェア系</a></li></ul></li></ul></li><li><a href=#来年の方針>来年の方針</a><ul><li><a href=#教育役割分担>教育・役割分担</a></li><li><a href=#スケジュール-1>スケジュール</a></li></ul></li><li><a href=#参考資料>参考資料</a></li><li><a href=#さいごに>さいごに</a></li></ul></nav></div></section></aside><script>var enableToc=JSON.parse("true");var toc=JSON.parse("null");var tocPosition=JSON.parse("\"inner\"");var singleMainElem=document.querySelector('.single__main');var singleSideElem=document.querySelector('.single__side');enquire.register("screen and (max-width: 769px)",{match:function(){if((enableToc||toc)&&tocPosition!=="outer"){if(singleMainElem&&singleSideElem){singleMainElem.classList.remove('main-main');singleMainElem.classList.add('main');singleSideElem.classList.remove('main-side');singleSideElem.classList.add('hide');}}else if(tocPosition==="outer"){if(singleMainElem&&!singleMainElem.classList.contains('main-main')){singleMainElem.classList.remove('main-main');singleMainElem.classList.add('main');}
if(singleSideElem&&!singleSideElem.classList.contains('hide')){singleSideElem.classList.add('hide');}}},unmatch:function(){if((enableToc||toc)&&tocPosition!=="outer"){singleMainElem.classList.remove('main');singleMainElem.classList.add('main-main');singleSideElem.classList.remove('hide');singleSideElem.classList.add('main-side');}else if(tocPosition==="outer"){if(singleMainElem&&!singleMainElem.classList.contains('main-main')){singleMainElem.classList.remove('main-main');singleMainElem.classList.add('main');}
if(singleSideElem&&!singleSideElem.classList.contains('hide')){singleSideElem.classList.add('hide');}}
var navCollapseBtn=document.querySelector('.navbar__burger');var navCollapse=document.getElementsByClassName('navbarm__collapse')[0];if(navCollapse){navCollapse.setAttribute('data-open',false);navCollapse.style.maxHeight=0;navCollapseBtn.classList.remove('is-active');}
document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');document.getElementsByClassName('mobile-search')[0].classList.add('hide');},setup:function(){},deferSetup:true,destroy:function(){},});</script><script defer src=/js/helper/getParents.min.js></script><script defer src=/js/helper/closest.min.js></script><script defer src=/js/helper/prev.min.js></script><script defer src=/js/helper/prop.min.js></script><script defer src=/js/helper/fadeinout.min.js></script><script defer src=/js/helper/throttle.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity="sha256-V8SV2MO1FUb63Bwht5Wx9x6PVHNa02gv8BgH/uH3ung=" crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity="sha256-F/Xda58SPdcUCr+xhSGz9MA2zQBPb0ASEYKohl8UCHc=" crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity="sha256-90d2pnfw0r4K8CZAWPko4rpFXQsZvJhTBGYNkipDprI=" crossorigin=anonymous></script><script>'use strict';window.onload=function(){var navbar=document.querySelector('.navbar');var singleContentsElem=document.querySelector('.single__contents');var enableBusuanzi=JSON.parse("false");var busuanziPagePV=JSON.parse("true");if(enableBusuanzi&&busuanziPagePV){var pagePvElem=document.querySelector('#busuanzi_value_page_pv');pagePvElem.textContent=pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");}
var enableToc=JSON.parse("true");var toc=JSON.parse("null");var hideToc=JSON.parse("false");var tocFlexbox=document.querySelector('.toc__flexbox');var tocFlexboxOuter=document.querySelector('.toc__flexbox--outer');var tocFolding=JSON.parse("false");if((enableToc||toc)&&document.querySelector('.toc')){var tableOfContentsElem=document.querySelector('.toc').querySelector('#TableOfContents');tableOfContentsElem.onmouseenter=function(){if(navbar.classList.contains('scrolling')){navbar.classList.remove('scrolling');}}
tableOfContentsElem.onmouseleave=function(){if(!navbar.classList.contains('scrolling')){navbar.classList.add('scrolling');}}
if(false===tocFolding){}else{tableOfContentsElem.querySelectorAll('ul')?tableOfContentsElem.querySelectorAll('ul').forEach(function(rootUl){rootUl.querySelectorAll('li').forEach(function(liElem){liElem.querySelectorAll('ul').forEach(function(ulElem){ulElem.style.display='none';});});}):null;}
if(tableOfContentsElem){if(tableOfContentsElem.querySelectorAll('a').length>0){tableOfContentsElem.querySelectorAll('a').forEach(function(elem){elem.addEventListener('click',function(){var id=elem.getAttribute('id');if(!navbar.classList.contains('scrolling')){navbar.classList.remove('navbar--show');navbar.classList.remove('navbar--hide');navbar.classList.add('navbar--hide');}
document.querySelector('.toc').querySelectorAll('a').forEach(function(elem){elem.classList.remove('active');});elem.classList.add('active');var curElem=tableOfContentsElem.querySelector('[href="#'+id+'"]');if(curElem&&curElem.nextElementSibling){curElem.nextElementSibling.style.display='block';}
if(curElem){getParents(curElem,'ul')?getParents(curElem,'ul').forEach(function(elem){elem.style.display='block';}):null;}});});}else{if(tocFlexbox){tocFlexbox.setAttribute('data-position','');if(!tocFlexbox.classList.contains('hide')){tocFlexbox.classList.add('hide');}}
if(tocFlexboxOuter){tocFlexboxOuter.setAttribute('data-position','');if(!tocFlexboxOuter.classList.contains('hide')){tocFlexboxOuter.classList.add('hide');}}}}
var toggleTocElem=document.getElementById("toggle-toc");var visibleTocElem=document.getElementById('visible-toc');var tocElem=document.querySelector('.toc');var mainElem=document.querySelector('main');var sideElem=document.querySelector('side');var tocFlexboxElem=document.querySelector('.toc__flexbox');toggleTocElem?toggleTocElem.addEventListener('change',function(e){if(e.target.checked){if(tocElem){fadeIn(tocElem,200);}
if(tocFlexboxElem){tocFlexboxElem.setAttribute('data-position','fixed');}
if(mainElem){mainElem.classList.remove('main-main');mainElem.classList.remove('main');mainElem.classList.add('main-main');}
if(sideElem){sideElem.classList.remove('main-side');}}else{if(tocElem){fadeOut(tocElem,200);}
if(tocFlexboxElem){tocFlexboxElem.setAttribute('data-position','absolute');}
if(mainElem){mainElem.classList.remove('main-main');mainElem.classList.remove('main');mainElem.classList.add('main');}
if(sideElem){sideElem.classList.remove('main-side');}}}):null;visibleTocElem?visibleTocElem.addEventListener('change',function(e){if(e.target.checked){if(tocElem){fadeIn(tocElem,200);}}else{if(tocElem){fadeOut(tocElem,200);}}}):null;}
var topOffset=120;var botOffset=70;var handleWindowResize=function(){if(tocElem){tocElem.style.maxHeight=(window.innerHeight-topOffset-botOffset)+'px';}}
var throttledWindowResize=throttle(handleWindowResize,300);throttledWindowResize()
window.addEventListener('resize',throttledWindowResize);var text,clip=new ClipboardJS('.anchor');var headers=singleContentsElem.querySelectorAll("h1, h2, h3, h4");var languagedir=JSON.parse("\"ltr\"");headers?headers.forEach(function(elem){var size=parseInt(elem.tagName.substr(1),10)*2;var url=encodeURI(document.location.origin+document.location.pathname);var link=url+"#"+elem.getAttribute('id');var newElemOuter=document.createElement('span');newElemOuter.classList.add('anchor');newElemOuter.classList.add('hide');newElemOuter.setAttribute('data-clipboard-text',decodeURI(link));newElemOuter.style.position='relative';var newElemInner=document.createElement('span');newElemInner.style.position='absolute';newElemInner.style.top='50%';newElemInner.style.left='0.75rem';newElemInner.style.transform='translateY(-50%)';newElemInner.innerHTML=`
<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${32-size}px" height="${32-size}px"><path d="M 5.5625 0 C 4.136719 0 2.707031 0.542969 1.625 1.625 C -0.539063 3.789063 -0.539063 7.335938 1.625 9.5 L 5.28125 13.15625 C 5.667969 13.554688 6.304688 13.558594 6.703125 13.171875 C 7.101563 12.785156 7.105469 12.148438 6.71875 11.75 L 3.03125 8.0625 C 1.632813 6.664063 1.632813 4.429688 3.03125 3.03125 C 4.429688 1.632813 6.664063 1.632813 8.0625 3.03125 L 12.96875 7.9375 C 14.367188 9.335938 14.367188 11.570313 12.96875 12.96875 C 12.804688 13.132813 12.621094 13.25 12.4375 13.375 C 11.980469 13.6875 11.859375 14.308594 12.171875 14.765625 C 12.484375 15.222656 13.105469 15.34375 13.5625 15.03125 C 13.847656 14.835938 14.125 14.625 14.375 14.375 C 16.539063 12.210938 16.539063 8.664063 14.375 6.5 L 9.5 1.625 C 8.417969 0.542969 6.988281 0 5.5625 0 Z M 10.78125 8.875 C 10.738281 8.882813 10.695313 8.894531 10.65625 8.90625 C 10.507813 8.9375 10.371094 9 10.25 9.09375 C 10.039063 9.253906 9.820313 9.429688 9.625 9.625 C 7.460938 11.789063 7.460938 15.335938 9.625 17.5 L 14.5 22.375 C 16.664063 24.539063 20.210938 24.539063 22.375 22.375 C 24.539063 20.210938 24.539063 16.664063 22.375 14.5 L 18.71875 10.875 C 18.476563 10.578125 18.089844 10.441406 17.714844 10.527344 C 17.34375 10.613281 17.050781 10.90625 16.964844 11.277344 C 16.878906 11.652344 17.015625 12.039063 17.3125 12.28125 L 20.96875 15.9375 C 22.367188 17.335938 22.367188 19.570313 20.96875 20.96875 C 19.570313 22.367188 17.335938 22.367188 15.9375 20.96875 L 11.03125 16.0625 C 9.632813 14.664063 9.632813 12.429688 11.03125 11.03125 C 11.152344 10.90625 11.300781 10.820313 11.4375 10.71875 C 11.839844 10.472656 12.015625 9.976563 11.855469 9.53125 C 11.699219 9.085938 11.25 8.8125 10.78125 8.875 Z"/></svg>`;if(languagedir==="rtl"){newElemInner.style.left='-2rem';}else{newElemInner.style.right='-2rem';}
newElemOuter.append(newElemInner);elem.append(newElemOuter);elem.addEventListener('mouseenter',function(){this.querySelector('.anchor').classList.remove('hide');});elem.addEventListener('mouseleave',function(){this.querySelector('.anchor').classList.add('hide');});}):null;document.querySelectorAll('.anchor').forEach(function(elem){elem.addEventListener('mouseleave',function(){elem.setAttribute('aria-label',null);elem.classList.remove('tooltipped');elem.classList.remove('tooltipped-s');elem.classList.remove('tooltipped-w');});});clip.on('success',function(e){e.clearSelection();e.trigger.setAttribute('aria-label','Link copied to clipboard!');e.trigger.classList.add('tooltipped');e.trigger.classList.add('tooltipped-s');});var lib=JSON.parse("\"katex\"");if(lib&&lib.includes('mermaid')){var themeVariant=localStorage.getItem('theme')||JSON.parse("\"light\"");if(themeVariant==="dark"||themeVariant==="hacker"){mermaid.initialize({theme:'dark'});}else{mermaid.initialize({theme:'default'});}
var mermaids=[];[].push.apply(mermaids,document.getElementsByClassName('language-mermaid'));mermaids.forEach(function(elem){var elemParentNode=elem.parentNode;if(elemParentNode!==document.body){elemParentNode.parentNode.insertBefore(elem,elemParentNode);elemParentNode.parentNode.removeChild(elemParentNode);}
var newElemWrapper=document.createElement('div');newElemWrapper.classList.add('mermaid');newElemWrapper.style.padding='34px 4px 6px';newElemWrapper.innerHTML=elem.innerHTML;elem.replaceWith(newElemWrapper);});}
if(lib&&lib.includes('katex')){var mathElements=document.getElementsByClassName('math');var options={delimiters:[{left:"$$",right:"$$",display:true},{left:"\\[",right:"\\]",display:true},{left:"$",right:"$",display:false},{left:"\\(",right:"\\)",display:false}],};renderMathInElement(document.querySelector('.single__contents'),options);}
if(lib&&lib.includes('flowchartjs')){var options=JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");var jsonContent=null;var flowchartPrefix="language-flowchart";var index=0;Array.prototype.forEach.call(document.querySelectorAll("[class^="+flowchartPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('div');node0.id='flowchart'+index;x.parentNode.insertBefore(node0,x);var diagram=flowchart.parse(jsonContent);diagram.drawSVG("flowchart"+index,options);index+=1;});}
document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'});if(lib&&lib.includes('msc')){var options=JSON.parse("{\"theme\":\"hand\"}");var jsonContent=null;var index=0;var chartPrefix="language-msc";Array.prototype.forEach.call(document.querySelectorAll("[class^="+chartPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('div');node0.id='msc'+index;x.parentNode.insertBefore(node0,x);var diagram=Diagram.parse(jsonContent);diagram.drawSVG("msc"+index,options);index+=1;});}
if(lib&&lib.includes('chart')){var borderColor="#666";var bgColor="#ddd";var borderWidth=2;Chart.defaults.global.elements.rectangle.borderWidth=borderWidth;Chart.defaults.global.elements.rectangle.borderColor=borderColor;Chart.defaults.global.elements.rectangle.backgroundColor=bgColor;Chart.defaults.global.elements.line.borderWidth=borderWidth;Chart.defaults.global.elements.line.borderColor=borderColor;Chart.defaults.global.elements.line.backgroundColor=bgColor;Chart.defaults.global.elements.point.borderWidth=borderWidth;Chart.defaults.global.elements.point.borderColor=borderColor;Chart.defaults.global.elements.point.backgroundColor=bgColor;var chartPrefix="language-chart";var index=0;var jsonContent=null;Array.prototype.forEach.call(document.querySelectorAll("[class^="+chartPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('canvas');var source=null;node0.height=200;node0.style.height=200;node0.id='myChart'+index;source=JSON.parse(jsonContent);x.parentNode.insertBefore(node0,x);var ctx=document.getElementById('myChart'+index).getContext('2d');var myChart=new Chart(ctx,source);index+=1;});}
if(lib&&lib.includes('wavedrom')){var wavePrefix="language-wave";var index=0;var jsonContent=null;Array.prototype.forEach.call(document.querySelectorAll("[class^="+wavePrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
jsonContent=x.innerText;var node0=document.createElement('div');var source=null;node0.id='WaveDrom_Display_'+index;source=JSON.parse(jsonContent);x.parentNode.insertBefore(node0,x);WaveDrom.RenderWaveForm(index,source,"WaveDrom_Display_");index+=1;});}
if(lib&&lib.includes('viz')){var vizPrefix="language-viz-";Array.prototype.forEach.call(document.querySelectorAll("[class^="+vizPrefix+"]"),function(x){x.style.display='none'
x.parentNode.style.backgroundColor="transparent"
var engine;x.getAttribute("class").split(" ").forEach(function(cls){if(cls.startsWith(vizPrefix)){engine=cls.substr(vizPrefix.length);}});var viz=new Viz();viz.renderSVGElement(x.innerText,{engine:engine}).then(function(element){element.style.width="100%";x.parentNode.insertBefore(element,x);})});}}</script><footer class=footer><div class=footer__social><div class=social><a href=https://github.com/771-8bit title=github aria-label=github><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24"><g id="surface3680"><path fill="currentcolor" d="M10.898438 2.101562C6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 8.699219 21.398438 9 21.199219 9 20.800781V19.199219S8.601562 19.300781 8.101562 19.300781C6.699219 19.300781 6.101562 18.101562 6 17.398438 5.898438 17 5.699219 16.699219 5.398438 16.398438 5.101562 16.300781 5 16.300781 5 16.199219 5 16 5.300781 16 5.398438 16 6 16 6.5 16.699219 6.699219 17 7.199219 17.800781 7.800781 18 8.101562 18 8.5 18 8.800781 17.898438 9 17.800781 9.101562 17.101562 9.398438 16.398438 10 16 7.699219 15.5 6 14.199219 6 12 6 10.898438 6.5 9.800781 7.199219 9 7.101562 8.800781 7 8.300781 7 7.601562 7 7.199219 7 6.601562 7.300781 6 7.300781 6 8.699219 6 10.101562 7.300781 10.601562 7.101562 11.300781 7 12 7S13.398438 7.101562 14 7.300781C15.300781 6 16.800781 6 16.800781 6 17 6.601562 17 7.199219 17 7.601562 17 8.398438 16.898438 8.800781 16.800781 9 17.5 9.800781 18 10.800781 18 12 18 14.199219 16.300781 15.5 14 16 14.601562 16.5 15 17.398438 15 18.300781V20.898438C15 21.199219 15.300781 21.5 15.699219 21.398438 19.398438 19.898438 22 16.300781 22 12.101562 22 6.101562 16.898438 1.398438 10.898438 2.101562zm0 0"/></g></svg></a><a href=https://twitter.com/771_8bit title=twitter aria-label=twitter><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><g id="surface676"><path fill="currentcolor" d="M28 8.558594C27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 5.246094 7.875 5.003906 8.722656 5.003906 9.625 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469c0 .023437000000001262.0.042969000000001145.0.0625C4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 4.777344 23.609375 4.386719 23.585938 4 23.539062 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 26.503906 10.410156 27.339844 9.542969 28 8.558594zm0 0"/></g></svg></a></div></div><div id=gtt><div class=gtt><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentcolor" d="M8.12 14.71 12 10.83l3.88 3.88c.39.39 1.02.39 1.41.0s.39-1.02.0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41.0L6.7 13.3c-.39.39-.39 1.02.0 1.41.39.38 1.03.39 1.42.0z"/></svg></div></div><hr><div class="basicflex flexwrap"></div><div class=footer__poweredby></div></footer></div><div class="wrapper__right hide" data-pad=true dir=ltr><script>document.querySelector('.wrapper__right').classList.remove('hide')</script></div></div></body></html>